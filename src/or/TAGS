
addressmap.c,1853
#define ADDRESSMAP_PRIVATE16,523
  char *new_address;new_address55,2008
  time_t expires;56,2029
  addressmap_entry_source_bitfield_t source:source57,2047
  unsigned src_wildcard:src_wildcard58,2094
  unsigned dst_wildcard:dst_wildcard59,2121
  short num_resolve_failures;60,2148
} addressmap_entry_t;61,2178
  char *ipv4_address;ipv4_address65,2297
  char *ipv6_address;ipv6_address66,2319
  char *hostname_address;hostname_address67,2341
} virtaddress_entry_t;68,2367
static strmap_t *addressmap=addressmap71,2462
static strmap_t *virtaddress_reversemap=virtaddress_reversemap83,2902
addressmap_init(87,2984
addressmap_ent_free(95,3166
addressmap_virtaddress_ent_free(108,3402
addressmap_virtaddress_remove(124,3738
addressmap_ent_remove(149,4656
clear_trackexithost_mappings(158,4895
addressmap_clear_excluded_trackexithosts(181,5576
addressmap_address_should_automap(233,7278
addressmap_clear_invalid_automaps(255,7976
addressmap_clear_configured(288,8940
addressmap_clear_transient(295,9102
addressmap_clean(304,9312
addressmap_free_all(312,9478
addressmap_match_superdomains(333,10281
addressmap_rewrite(367,11412
addressmap_rewrite_reverse(487,15429
addressmap_have_mapping(528,16681
addressmap_register(561,18018
client_dns_incr_failures(622,20240
client_dns_clear_failures(644,21048
client_dns_set_addressmap_impl(662,21672
client_dns_set_addressmap(708,23231
client_dns_set_reverse_addressmap(747,24453
static virtual_addr_conf_t virtaddr_conf_ipv4;773,25383
static virtual_addr_conf_t virtaddr_conf_ipv6;774,25430
parse_virtual_addr_network(782,25845
address_is_in_virtual_range(840,27439
get_random_virtual_addr(859,27994
addressmap_get_virtual_address(905,29480
addressmap_register_virtual_address(976,32011
address_is_invalid_destination(1058,34577
addressmap_get_mappings(1095,35558

bridges.c,1585
struct bridge_info_t 31,900
  tor_addr_port_t addrport_configured;33,990
  tor_addr_t addr;35,1061
  uint16_t port;37,1114
  unsigned marked_for_removal 40,1280
  char identity[identity43,1417
  char *transport_name;transport_name46,1521
  download_status_t fetch_status;49,1618
  smartlist_t *socks_args;socks_args53,1767
static smartlist_t *bridge_list bridge_list64,2216
mark_bridge_list(69,2396
sweep_bridge_list(80,2714
clear_bridge_list(94,3074
bridge_free(104,3310
bridge_list_get(120,3672
bridge_get_rsa_id_digest(132,3911
bridge_get_addr_port(146,4226
get_configured_bridge_by_orports_digest(157,4590
get_configured_bridge_by_addr_port_digest(185,5587
get_configured_bridge_by_exact_addr_port_digest(211,6466
addr_is_a_configured_bridge(236,7363
extend_info_is_a_configured_bridge(249,7903
get_configured_bridge_by_routerinfo(258,8241
routerinfo_is_a_configured_bridge(271,8698
node_is_a_configured_bridge(278,8896
learned_router_identity(294,9482
bridge_has_digest(337,11118
bridge_resolve_conflicts(351,11579
MOCK_IMPL(400,13746
bridge_add_from_config(418,14214
find_bridge_by_digest(473,16359
find_transport_name_by_bridge_addrport(489,16780
get_transport_by_bridge_addrport(512,17499
get_socks_args_by_bridge_addrport(542,18497
launch_direct_bridge_descriptor_fetch(552,18918
retry_bridge_descriptor_fetch_directly(607,21007
fetch_bridge_descriptors(620,21422
rewrite_node_address_for_bridge(705,25038
learned_bridge_descriptor(794,28648
MOCK_IMPL(844,30781
MOCK_IMPL(867,31289
MOCK_IMPL(887,31809
bridges_free_all(906,32263

channel.c,6009
#define TOR_CHANNEL_INTERNAL_44,1730
#define CHANNEL_PRIVATE_47,1833
static smartlist_t *all_channels all_channels74,2434
static smartlist_t *active_channels active_channels77,2536
static smartlist_t *finished_channels finished_channels80,2637
static smartlist_t *all_listeners all_listeners83,2723
static smartlist_t *active_listeners active_listeners86,2824
static smartlist_t *finished_listeners finished_listeners89,2928
static HT_HEAD(93,3079
channel_id_eq(101,3274
HT_PROTOTYPE(105,3387
typedef struct channel_idmap_entry_s 180,5486
  HT_ENTRY(181,5525
} channel_idmap_entry_t;184,5652
channel_idmap_hash(187,5701
channel_idmap_eq(193,5834
HT_PROTOTYPE(199,5992
channel_listener_state_is_valid(274,8300
channel_state_can_transition(302,8966
channel_listener_state_can_transition(349,10308
channel_state_to_string(382,11179
channel_listener_state_to_string(418,11920
channel_register(455,12756
channel_unregister(513,14642
channel_listener_register(553,15693
channel_listener_unregister(595,17014
channel_add_to_digest_map(632,18035
channel_remove_from_digest_map(670,19266
channel_find_by_global_id(751,21813
channel_remote_identity_matches(768,22279
channel_find_by_remote_identity(798,23266
channel_next_with_rsa_identity(833,24343
channel_check_for_duplicates(850,24842
#define MIN_RELAY_CONNECTIONS_TO_WARN 890,26055
channel_init(926,27646
channel_init_listener(965,28663
channel_free(982,29068
channel_listener_free(1037,30471
channel_force_free(1070,31354
channel_listener_force_free(1128,32945
channel_listener_get_listener_fn(1166,34050
channel_listener_set_listener_fn(1184,34387
channel_get_cell_handler(1208,35112
channel_get_var_cell_handler(1226,35462
channel_set_cell_handlers(1245,35875
channel_mark_for_close(1301,37643
channel_listener_mark_for_close(1341,38811
channel_close_from_lower_layer(1382,40158
channel_listener_close_from_lower_layer(1411,40988
channel_close_for_error(1441,42055
channel_listener_close_for_error(1470,42864
channel_closed(1500,43859
channel_listener_closed(1533,44748
channel_clear_identity_digest(1559,45591
channel_set_identity_digest(1588,46382
channel_clear_remote_end(1648,48138
channel_set_remote_end(1679,48962
cell_queue_entry_dup(1738,50610
cell_queue_entry_free(1757,50985
cell_queue_entry_is_padding(1813,52591
cell_queue_entry_new_fixed(1842,53212
cell_queue_entry_new_var(1860,53508
channel_get_cell_queue_entry_size(1878,53805
channel_write_cell_queue_entry(1911,54575
channel_write_cell_generic_(2006,57618
channel_write_cell(2040,58662
channel_write_packed_cell(2057,59084
channel_write_var_cell(2075,59650
channel_change_state_(2092,60115
channel_change_state(2223,64892
channel_change_state_open(2233,65119
channel_listener_change_state(2257,65793
#define MAX_CELLS_TO_GET_FROM_CIRCUITS_FOR_UNLIMITED 2343,69182
MOCK_IMPL(2345,69240
channel_flush_some_cells_from_outgoing_queue(2432,72045
channel_flush_cells(2594,77466
MOCK_IMPL(2606,77698
channel_notify_flushed(2630,78223
channel_listener_process_incoming(2648,78663
channel_do_open_actions(2701,80513
channel_listener_queue_incoming(2771,83182
channel_process_cells(2826,84869
channel_queue_cell(2898,87304
channel_queue_var_cell(2964,89522
packed_cell_is_destroy(3027,91767
channel_assert_counter_consistency(3050,92322
is_destroy_cell(3060,92622
channel_send_destroy(3092,93480
channel_dumpstats(3133,94828
channel_listener_dumpstats(3178,96437
channel_set_cmux_policy_everywhere(3207,97327
channel_run_cleanup(3226,97746
channel_listener_run_cleanup(3253,98456
channel_free_list(3277,99119
channel_listener_free_list(3309,100081
channel_free_all(3343,101322
channel_connect(3417,103411
channel_is_better(3436,104058
channel_get_for_extend(3497,106481
channel_describe_transport(3607,109768
channel_listener_describe_transport(3623,110108
chan_cell_queue_len(3635,110354
MOCK_IMPL(3650,110599
channel_listener_dump_statistics(3869,118926
channel_dump_transport_statistics(3936,121355
channel_listener_dump_transport_statistics(3950,121643
channel_get_actual_remote_descr(3969,122232
channel_get_actual_remote_address(3985,122659
channel_get_canonical_remote_descr(4002,123259
channel_get_addr_if_possible(4019,123706
channel_has_queued_writes(4038,124178
channel_is_bad_for_new_circs(4063,124642
channel_mark_bad_for_new_circs(4077,124856
channel_is_client(4093,125162
channel_mark_client(4107,125336
channel_clear_client(4121,125511
channel_is_canonical(4136,125797
channel_is_canonical_is_reliable(4152,126098
channel_is_incoming(4168,126432
channel_mark_incoming(4183,126665
channel_is_local(4201,127114
channel_mark_local(4217,127431
channel_mark_remote(4234,127796
channel_is_outgoing(4250,128101
channel_mark_outgoing(4265,128325
channel_get_global_queue_estimate(4281,128584
channel_num_cells_writeable(4295,128943
channel_timestamp_created(4328,129654
channel_listener_timestamp_created(4345,129972
channel_timestamp_active(4366,130632
channel_listener_timestamp_active(4384,130993
channel_listener_timestamp_accepted(4402,131359
channel_timestamp_client(4420,131694
channel_timestamp_drained(4437,132032
channel_timestamp_recv(4456,132386
channel_timestamp_xmit(4476,132860
channel_when_created(4499,133429
channel_listener_when_created(4511,133593
channel_when_last_active(4523,133776
channel_listener_when_last_active(4535,133947
channel_listener_when_last_accepted(4547,134144
channel_when_last_client(4559,134315
channel_when_last_drained(4571,134459
channel_when_last_recv(4583,134602
channel_when_last_xmit(4595,134739
channel_listener_count_accepted(4607,134880
channel_count_recved(4619,135046
channel_count_xmitted(4631,135193
channel_matches_extend_info(4646,135451
channel_matches_target_addr_for_extend(4663,135911
channel_num_circuits(4681,136336
MOCK_IMPL(4695,136606
channel_rsa_id_group_set_badness(4734,137657
channel_update_bad_for_new_circs(4783,139408
channel_update_xmit_queue_size(4812,140310

channelpadding.c,2334
#define TOR_CHANNEL_INTERNAL_9,358
static uint64_t total_timers_pending;31,988
static int consensus_nf_ito_low;35,1154
static int consensus_nf_ito_high;37,1257
static int consensus_nf_ito_low_reduced;39,1369
static int consensus_nf_ito_high_reduced;41,1488
static int consensus_nf_conntimeout_relays;43,1575
static int consensus_nf_conntimeout_clients;45,1672
static int consensus_nf_pad_before_usage;47,1789
static int consensus_nf_pad_relays;49,1880
static int consensus_nf_pad_tor2web;51,1958
static int consensus_nf_pad_single_onion;53,2035
#define TOR_MSEC_PER_SEC 55,2078
#define TOR_USEC_PER_MSEC 56,2108
#define TOR_HOUSEKEEPING_CALLBACK_MSEC 61,2233
#define TOR_HOUSEKEEPING_CALLBACK_SLACK_MSEC 66,2473
#define CHANNEL_IS_CLIENT(73,2752
channelpadding_new_consensus_params(84,3213
#define DFLT_NETFLOW_INACTIVE_KEEPALIVE_LOW 86,3272
#define DFLT_NETFLOW_INACTIVE_KEEPALIVE_HIGH 87,3321
#define DFLT_NETFLOW_INACTIVE_KEEPALIVE_MIN 88,3371
#define DFLT_NETFLOW_INACTIVE_KEEPALIVE_MAX 89,3417
#define DFLT_NETFLOW_REDUCED_KEEPALIVE_LOW 99,3850
#define DFLT_NETFLOW_REDUCED_KEEPALIVE_HIGH 100,3898
#define DFLT_NETFLOW_REDUCED_KEEPALIVE_MIN 101,3948
#define DFLT_NETFLOW_REDUCED_KEEPALIVE_MAX 102,3993
#define CONNTIMEOUT_RELAYS_DFLT 115,4481
#define CONNTIMEOUT_RELAYS_MIN 116,4531
#define CONNTIMEOUT_RELAYS_MAX 117,4565
#define CIRCTIMEOUT_CLIENTS_DFLT 124,4811
#define CIRCTIMEOUT_CLIENTS_MIN 125,4866
#define CIRCTIMEOUT_CLIENTS_MAX 126,4901
channelpadding_get_netflow_inactive_timeout_ms(169,6595
channelpadding_update_padding_for_channel(241,9681
channelpadding_send_disable_command(296,11668
channelpadding_send_enable_command(327,12491
channelpadding_send_padding_cell_for_callback(362,13558
channelpadding_send_padding_callback(419,15352
channelpadding_schedule_padding(450,16488
#define CHANNELPADDING_TIME_LATER 498,18158
#define CHANNELPADDING_TIME_DISABLED 499,18195
channelpadding_compute_time_until_pad_for_netflow(501,18250
#define NETFLOW_MISSED_WINDOW 556,20847
channelpadding_get_channel_idle_timeout(585,21905
#define CONNTIMEOUT_CLIENTS_BASE 593,22235
channelpadding_get_circuits_available_timeout(632,23710
channelpadding_disable_padding_on_channel(666,24777
channelpadding_reduce_padding_on_channel(680,25136
channelpadding_decide_to_pad_channel(709,26233

channeltls.c,2835
#define TOR_CHANNEL_INTERNAL_38,1550
#define CHANNELTLS_PRIVATE40,1581
uint64_t stats_n_padding_cells_processed 65,2171
uint64_t stats_n_versions_cells_processed 67,2277
uint64_t stats_n_netinfo_cells_processed 69,2383
uint64_t stats_n_vpadding_cells_processed 71,2489
uint64_t stats_n_certs_cells_processed 73,2593
uint64_t stats_n_auth_challenge_cells_processed 75,2703
uint64_t stats_n_authenticate_cells_processed 77,2820
uint64_t stats_n_authorize_cells_processed 79,2932
static channel_listener_t *channel_tls_listener channel_tls_listener82,3012
channel_tls_common_init(137,5603
channel_tls_connect(179,7148
channel_tls_get_listener(243,8983
channel_tls_start_listener(256,9228
channel_tls_free_all(288,10092
channel_tls_handle_incoming(321,10986
channel_tls_to_base(364,11984
channel_tls_from_base(377,12199
channel_tls_close_method(397,12592
channel_tls_describe_transport_method(421,13190
channel_tls_free_method(460,14174
channel_tls_get_overhead_estimate_method(477,14471
channel_tls_get_remote_addr_method(516,15575
channel_tls_get_transport_name_method(541,16236
channel_tls_get_remote_descr_method(566,16924
#define MAX_DESCR_LEN 568,16990
channel_tls_has_queued_writes_method(627,18647
channel_tls_is_canonical_method(656,19429
channel_tls_matches_extend_info_method(694,20431
channel_tls_matches_target_method(725,21371
channel_tls_num_bytes_queued_method(760,22531
channel_tls_num_cells_writeable_method(779,23007
channel_tls_write_cell_method(809,23761
channel_tls_write_packed_cell_method(838,24476
channel_tls_write_var_cell_method(874,25523
channel_tls_listener_close_method(906,26327
channel_tls_listener_describe_transport_method(947,27540
channel_tls_handle_state_change_on_orconn(966,28030
channel_tls_time_process_cell(1023,29778
channel_tls_handle_cell(1064,31028
#define PROCESS_CELL(1070,31159
#define PROCESS_CELL(1076,31488
channel_tls_handle_var_cell(1182,35143
channel_tls_update_marks(1356,41638
command_allowed_before_handshake(1390,42516
enter_v3_handshake_with_cell(1412,43056
channel_tls_process_versions_cell(1453,44430
channel_tls_process_padding_negotiate_cell(1633,50751
channel_tls_process_netinfo_cell(1670,51847
#define NETINFO_NOTICE_SKEW 1827,57939
typedef enum cert_encoding_t 1873,59841
  CERT_ENCODING_UNKNOWN,1874,59872
  CERT_ENCODING_X509,1875,59930
  CERT_ENCODING_ED25519,1877,60085
  CERT_ENCODING_RSA_CROSSCERT,1879,60210
} cert_encoding_t;1880,60288
certs_cell_typenum_to_cert_type(1888,60496
channel_tls_process_certs_cell(1922,61559
#define MAX_CERT_TYPE_WANTED 1924,61631
#define ERR(1943,62192
#undef ERR2167,70501
channel_tls_process_auth_challenge_cell(2182,71056
#define ERR(2191,71274
#undef ERR2270,74167
channel_tls_process_authenticate_cell(2284,74631
#define ERR(2296,74883
#undef ERR2485,82097

circpathbias.c,1958
entry_guard_inc_circ_attempt_count(52,1951
pathbias_get_min_circs(75,2550
#define DFLT_PATH_BIAS_MIN_CIRC 77,2604
pathbias_get_notice_rate(88,2978
#define DFLT_PATH_BIAS_NOTICE_PCT 90,3034
pathbias_get_warn_rate(100,3371
#define DFLT_PATH_BIAS_WARN_PCT 102,3425
pathbias_get_extreme_rate(116,3892
#define DFLT_PATH_BIAS_EXTREME_PCT 118,3949
pathbias_get_dropguards(132,4385
#define DFLT_PATH_BIAS_DROP_GUARDS 134,4440
pathbias_get_scale_threshold(149,4916
#define DFLT_PATH_BIAS_SCALE_THRESHOLD 151,4976
pathbias_get_scale_ratio(168,5518
pathbias_get_min_use(192,6370
#define DFLT_PATH_BIAS_MIN_USE 194,6422
pathbias_get_notice_use_rate(205,6793
#define DFLT_PATH_BIAS_NOTICE_USE_PCT 207,6853
pathbias_get_extreme_use_rate(221,7309
#define DFLT_PATH_BIAS_EXTREME_USE_PCT 223,7370
pathbias_get_scale_use_threshold(239,7915
#define DFLT_PATH_BIAS_SCALE_USE_THRESHOLD 241,7979
pathbias_state_to_string(254,8373
pathbias_is_new_circ_attempt(285,9365
#define N2N_TAGGING_IS_POSSIBLE287,9420
pathbias_should_count(312,10344
#define PATHBIAS_COUNT_INTERVAL 314,10392
pathbias_count_build_attempt(411,14455
#define CIRC_ATTEMPT_NOTICE_INTERVAL 413,14510
pathbias_count_build_success(497,17385
#define SUCCESS_NOTICE_INTERVAL 499,17440
pathbias_count_use_attempt(587,20545
pathbias_mark_use_success(643,22452
pathbias_mark_use_rollback(682,23752
pathbias_count_use_success(697,24192
pathbias_send_usable_probe(758,26267
pathbias_check_probe_response(861,29709
pathbias_check_close(929,32099
pathbias_count_successful_close(1021,35384
pathbias_count_collapse(1061,36738
pathbias_count_use_failed(1097,37757
pathbias_count_timeout(1134,38886
pathbias_count_circs_in_states(1168,39721
pathbias_get_close_success_count(1211,41043
pathbias_get_use_success_count(1229,41568
pathbias_measure_use_rate(1248,42122
pathbias_measure_close_rate(1353,47166
pathbias_scale_close_rates(1473,52974
pathbias_scale_use_rates(1533,55305

circuitbuild.c,2606
#define CIRCUITBUILD_PRIVATE28,1178
#define CIRCUITBUILD_PRIVATE34,1292
channel_connect_for_circuit(89,3267
get_unique_circ_id_by_chan(108,3833
#define MAX_CIRCID_ATTEMPTS 116,4265
circuit_list_path_impl(246,9530
circuit_list_path(320,12007
circuit_list_path_for_controller(329,12262
circuit_log_path(339,12538
circuit_rep_hist_note_result(353,13008
circuit_cpath_supports_ntor(387,14014
onion_populate_cpath(411,14610
origin_circuit_init(474,16643
circuit_establish_circuit(500,17576
origin_circuit_get_guard_state(529,18379
circuit_handle_first_hop(539,18740
circuit_n_chan_done(627,22113
circuit_deliver_create_cell(712,25441
inform_testing_reachability(775,27429
should_use_create_fast_for_circuit(808,28590
circuit_timeout_want_to_count_circ(834,29504
circuit_pick_create_handshake(849,30120
circuit_pick_extend_handshake(875,31202
circuit_purpose_may_omit_guard(901,32155
circuit_send_next_onion_skin(930,33095
circuit_send_first_onion_skin(959,34019
circuit_build_no_more_hops(1023,36310
circuit_send_intermediate_onion_skin(1134,40723
circuit_note_clock_jumped(1197,43071
circuit_extend(1227,44391
circuit_init_cpath_crypto(1393,50306
circuit_finish_handshake(1472,52868
circuit_truncated(1530,54740
onionskin_answer(1576,56011
route_len_for_purpose(1679,60022
new_route_len(1730,61563
circuit_get_unhandled_ports(1757,62333
MOCK_IMPL(1770,62743
node_handles_some_port(1797,63547
ap_stream_wants_exit_attention(1821,64252
choose_good_exit_server_general(1849,65261
pick_tor2web_rendezvous_node(2059,73590
pick_rendezvous_node(2111,75537
choose_good_exit_server(2159,77212
warn_if_last_router_excluded(2195,78443
onion_pick_cpath_exit(2277,81430
circuit_append_new_exit(2321,82993
circuit_extend_to_new_exit(2342,83590
MOCK_IMPL(2366,84359
onion_append_to_cpath(2398,85349
cpath_get_n_hops(2415,85784
choose_good_middle_server(2442,86457
choose_good_entry_server(2487,88012
onion_next_hop_in_cpath(2535,89677
onion_extend_cpath(2553,90112
onion_append_hop(2611,92092
extend_info_new(2631,92628
extend_info_from_node(2664,94058
extend_info_free(2732,96619
extend_info_dup(2743,96845
build_state_get_exit_node(2761,97352
build_state_get_exit_rsa_id(2772,97664
build_state_get_exit_nickname(2784,98033
extend_info_addr_is_allowed(2793,98260
extend_info_supports_tap(2810,98649
extend_info_supports_ntor(2819,98831
circuit_purpose_can_use_tap_impl(2832,99354
circuit_can_use_tap(2842,99739
circuit_has_usable_onion_key(2853,100076
extend_info_has_preferred_onion_key(2865,100429
circuit_upgrade_circuits_from_guard_wait(2875,100747

circuitlist.c,3460
#define CIRCUITLIST_PRIVATE53,2525
static smartlist_t *global_circuitlist global_circuitlist90,3361
static smartlist_t *global_origin_circuit_list global_origin_circuit_list94,3521
static smartlist_t *circuits_pending_chans circuits_pending_chans97,3639
static smartlist_t *circuits_pending_other_guards circuits_pending_other_guards101,3776
static smartlist_t *circuits_pending_close circuits_pending_close105,3971
typedef struct chan_circid_circuit_map_t 116,4451
  HT_ENTRY(117,4494
} chan_circid_circuit_map_t;123,4696
chan_circid_entries_eq_(129,4895
chan_circid_entry_hash_(138,5187
static HT_HEAD(152,5723
channel_mark_circid_unusable(289,10238
channel_mark_circid_usable(322,11317
channel_note_destroy_pending(345,12049
MOCK_IMPL(364,12673
circuit_set_p_circid_chan(387,13398
circuit_set_n_circid_chan(413,14186
circuit_set_state(436,14839
circuit_get_all_pending_on_channel(467,15895
circuit_count_pending_on_channel(498,16827
circuit_remove_from_origin_circuit_list(519,17378
circuit_add_to_origin_circuit_list(540,18196
circuit_close_all_marked(552,18617
MOCK_IMPL(583,19537
circuit_get_global_origin_circuit_list(593,19781
circuit_state_to_string(602,20025
circuit_purpose_to_controller_string(622,20703
circuit_purpose_to_controller_hs_state_string(672,22263
circuit_purpose_to_string(728,23922
circuit_initial_package_window(789,26204
init_circuit_base(803,26672
#define IDLE_TIMEOUT_WHILE_LEARNING 823,27367
origin_circuit_new(829,27564
or_circuit_new(893,30128
circuit_clear_testing_cell_stats(914,30617
circuit_free(927,30981
circuit_clear_cpath(1056,35064
circuit_free_all(1080,35542
circuit_free_cpath_node(1132,37000
cpath_ref_decref(1151,37551
circuit_dump_conn_details(1165,37890
circuit_dump_by_conn(1186,38710
circuit_get_by_global_id(1227,39937
circuit_get_by_circid_channel_impl(1251,40695
circuit_get_by_circid_channel(1319,42982
circuit_get_by_circid_channel_even_if_marked(1334,43438
circuit_id_in_use_on_channel(1348,43944
circuit_id_when_marked_unusable_on_channel(1361,44277
circuit_get_by_edge_conn(1380,44748
circuit_unlink_all_from_channel(1397,45218
circuit_get_ready_rend_circ_by_rend_data(1489,47950
circuit_get_next_service_intro_circ(1518,49104
circuit_get_next_service_rp_circ(1553,50356
circuit_get_next_by_pk_and_purpose(1587,51529
circuit_can_be_cannibalized_for_v3_rp(1624,52615
circuit_find_to_cannibalize(1665,54049
circuit_find_circuits_to_upgrade_from_guard_wait(1751,57411
circuit_get_cpath_len(1779,58423
circuit_get_cpath_hop(1796,58914
circuit_mark_all_unused_circs(1812,59365
circuit_mark_all_dirty_circs_as_unusable(1831,59956
MOCK_IMPL(1860,61203
circuit_about_to_free_atexit(1939,63915
circuit_about_to_free(1964,64644
marked_circuit_free_cells(2097,70188
single_conn_free_bytes(2115,70674
marked_circuit_streams_free_bytes(2141,71447
marked_circuit_free_stream_bytes(2157,71936
n_cells_in_circ_queues(2168,72279
circuit_max_queued_cell_age(2187,72866
conn_get_buffer_age(2212,73630
circuit_get_streams_max_data_age(2232,74227
circuit_max_queued_data_age(2253,74911
circuit_max_queued_item_age(2268,75433
circuits_compare_by_oldest_queued_item_(2281,75794
static uint32_t now_ms_for_buf_cmp;2296,76090
conns_compare_by_buffer_age_(2301,76227
#define FRACTION_OF_DATA_TO_RETAIN_ON_OOM 2316,76578
circuits_handle_oom(2322,76833
assert_cpath_layer_ok(2431,80531
assert_cpath_ok(2462,81448
assert_circuit_ok(2485,82072

circuitmux.c,2540
typedef struct chanid_circid_muxinfo_map chanid_circid_muxinfo_map_t;86,2767
typedef struct chanid_circid_muxinfo_t chanid_circid_muxinfo_t;92,2947
typedef struct circuit_muxinfo_s circuit_muxinfo_t;99,3122
struct circuitmux_s 105,3214
  unsigned int n_circuits,107,3284
  unsigned int n_circuits, n_active_circuits;107,3284
  unsigned int n_cells;110,3384
  chanid_circid_muxinfo_map_t *chanid_circid_map;chanid_circid_map115,3486
  struct circuit_t *active_circuits_head,active_circuits_head122,3768
  struct circuit_t *active_circuits_head, *active_circuits_tail;active_circuits_tail122,3768
  cell_queue_t destroy_cell_queue;125,3872
  unsigned int last_cell_was_destroy 134,4271
  int64_t destroy_ctr;138,4467
  const circuitmux_policy_t *policy;policy145,4680
  circuitmux_policy_data_t *policy_data;policy_data148,4747
struct circuit_muxinfo_s 156,4951
  unsigned int cell_count;158,5032
  cell_direction_t direction;160,5085
  circuitmux_policy_circ_data_t *policy_data;policy_data162,5144
  unsigned int mark:mark164,5231
struct chanid_circid_muxinfo_t 172,5350
  HT_ENTRY(173,5383
#define circuitmux_assert_okay_paranoid(184,5552
#define circuitmux_assert_okay_paranoid(187,5637
circuitmux_next_active_circ_p(313,9874
circuitmux_prev_active_circ_p(326,10203
chanid_circid_entries_eq(345,10714
chanid_circid_entry_hash(356,10992
HT_PROTOTYPE(367,11375
circuitmux_detach_all_circuits(402,12261
circuitmux_mark_destroyed_circids_usable(526,16581
circuitmux_free(549,17177
circuitmux_clear_policy(613,19122
MOCK_IMPL(627,19381
circuitmux_set_policy(641,19668
circuitmux_attached_circuit_direction(762,23561
circuitmux_find_map_entry(785,24119
circuitmux_is_circuit_attached(840,25746
circuitmux_is_circuit_active(855,26049
circuitmux_num_cells_for_circuit(879,26590
MOCK_IMPL(902,27107
circuitmux_num_active_circuits(915,27333
circuitmux_num_circuits(927,27525
MOCK_IMPL(942,27768
MOCK_IMPL(1091,32881
circuitmux_make_circuit_active(1184,36153
circuitmux_make_circuit_inactive(1280,39545
circuitmux_clear_num_cells(1393,43312
circuitmux_set_num_cells(1404,43551
circuitmux_get_first_active_circuit(1474,45803
circuitmux_notify_xmit_cells(1521,47297
circuitmux_notify_xmit_destroy(1590,49472
circuitmux_assert_okay(1614,50018
circuitmux_assert_okay_pass_one(1648,51246
circuitmux_assert_okay_pass_two(1748,54538
circuitmux_assert_okay_pass_three(1853,57840
circuitmux_append_destroy_cell(1882,58571
circuitmux_count_queued_destroy_cells(1919,59933
MOCK_IMPL(1963,61444

circuitmux_ewma.c,1806
#define TOR_CIRCUITMUX_EWMA_C_31,1239
#define EWMA_TICK_LEN 45,1489
#define EWMA_DEFAULT_HALFLIFE 49,1656
#define EPSILON 55,1823
#define LOG_ONEHALF 57,1884
typedef struct cell_ewma_s cell_ewma_t;61,1953
typedef struct ewma_policy_data_s ewma_policy_data_t;62,1993
typedef struct ewma_policy_circ_data_s ewma_policy_circ_data_t;63,2047
struct cell_ewma_s 72,2401
  unsigned int last_adjusted_tick;78,2672
  double cell_count;80,2744
  unsigned int is_for_p_chan 83,2845
  int heap_index;86,2964
struct ewma_policy_data_s 89,2986
  circuitmux_policy_data_t base_;90,3014
  smartlist_t *active_circuit_pqueue;active_circuit_pqueue98,3320
  unsigned int active_circuit_pqueue_last_recalibrated;105,3552
struct ewma_policy_circ_data_s 108,3612
  circuitmux_policy_circ_data_t base_;109,3645
  cell_ewma_t cell_ewma;116,3902
  circuit_t *circ;circ124,4205
#define EWMA_POL_DATA_MAGIC 127,4228
#define EWMA_POL_CIRC_DATA_MAGIC 128,4268
TO_EWMA_POL_DATA(144,4669
TO_EWMA_POL_CIRC_DATA(159,5021
static double ewma_scale_factor 225,7939
static int ewma_enabled 227,8004
circuitmux_policy_t ewma_policy 231,8083
ewma_alloc_cmux_data(252,8893
ewma_free_cmux_data(271,9317
ewma_alloc_circ_data(292,9813
ewma_free_circ_data(333,10952
ewma_notify_circ_active(358,11487
ewma_notify_circ_inactive(383,12131
ewma_notify_xmit_cells(409,12883
ewma_pick_active_circuit(464,14551
ewma_cmp_cmux(491,15221
compare_cell_ewma_counts(539,16584
cell_ewma_to_circuit(553,16914
cell_ewma_tick_from_timeval(604,19098
cell_ewma_enabled(617,19474
cell_ewma_get_tick(624,19593
cell_ewma_set_scale_factor(631,19747
get_scale_factor(673,21246
scale_single_cell_ewma(684,21589
scale_active_circuits(694,21935
add_cell_ewma(721,22808
remove_cell_ewma(740,23361
pop_first_cell_ewma(756,23911

circuitstats.c,2703
#define CIRCUITSTATS_PRIVATE26,1108
#undef log40,1388
#define CBT_BIN_TO_MS(47,1601
static circuit_build_times_t circ_times;55,1994
static int unit_tests 60,2193
#define unit_tests 62,2226
get_circuit_build_times(68,2432
get_circuit_build_times_mutable(75,2578
get_circuit_build_close_time_ms(83,2748
get_circuit_build_timeout_ms(91,2930
circuit_build_times_disabled(108,3482
circuit_build_times_disabled_(115,3674
circuit_build_times_max_timeouts(174,6009
circuit_build_times_default_num_xm_modes(203,7011
circuit_build_times_min_circs_to_observe(227,7713
circuit_build_times_enough_to_compute(247,8396
circuit_build_times_quantile_cutoff(259,8750
circuit_build_times_close_quantile(284,9522
circuit_build_times_test_frequency(316,10524
circuit_build_times_min_timeout(340,11265
circuit_build_times_initial_timeout(362,11951
circuit_build_times_recent_circuit_count(393,12979
circuit_build_times_new_consensus_params(418,13709
circuit_build_times_get_initial_timeout(501,16810
circuit_build_times_reset(532,17685
circuit_build_times_init(547,18126
circuit_build_times_free_timeouts(573,18952
circuit_build_times_rewind_history(589,19258
circuit_build_times_add_time(621,20071
circuit_build_times_max(650,20945
circuit_build_times_min(665,21368
circuit_build_times_create_histogram(691,22194
circuit_build_times_get_xm(723,23211
circuit_build_times_update_state(781,24847
circuit_build_times_shuffle_and_store_array(827,26120
circuit_build_times_filter_timeouts(870,27707
circuit_build_times_parse_state(907,28789
circuit_build_times_update_alpha(1043,33213
circuit_build_times_calculate_timeout(1127,35935
circuit_build_times_cdf(1160,36707
circuit_build_times_generate_sample(1178,37136
circuit_build_times_initial_alpha(1211,38055
circuit_build_times_needs_circuits(1232,38744
circuit_build_times_needs_circuits_now(1243,39005
#define CIRCUIT_TIMEOUT_BEFORE_RECHECK_IP 1253,39333
circuit_build_times_network_is_live(1266,39742
circuit_build_times_network_circ_success(1296,40835
circuit_build_times_network_timeout(1317,41621
circuit_build_times_network_close(1341,42520
circuit_build_times_network_check_live(1391,44477
circuit_build_times_network_check_changed(1411,45068
#define MAX_TIMEOUT 1441,46085
#undef MAX_TIMEOUT1457,46782
circuit_build_times_timeout_rate(1474,47224
circuit_build_times_close_rate(1493,47631
circuit_build_times_count_close(1515,48113
circuit_build_times_count_timeout(1547,49145
circuit_build_times_set_timeout_worker(1569,49789
circuit_build_times_set_timeout(1616,51390
circuitbuild_running_unit_tests(1681,53989
circuit_build_times_update_last_circ(1688,54092
cbt_control_event_buildtimeout_set(1694,54211

circuituse.c,2575
circuit_matches_with_rend_stream(65,2198
circuit_is_acceptable(95,3306
circuit_is_better(225,7918
circuit_get_best(315,11120
count_pending_general_client_circuits(368,12862
circuit_conforms_to_options(393,13538
circuit_expire_building(419,14342
#define SET_CUTOFF(454,15689
circuit_expire_waiting_for_better_guard(832,32874
static time_t last_expired_clientside_circuits 847,33418
circuit_log_ancient_one_hop_circuits(857,33784
#define MAX_ANCIENT_ONEHOP_CIRCUITS_TO_LOG 859,33832
circuit_remove_handled_ports(996,39149
circuit_stream_is_being_handled(1021,39913
#define MAX_UNUSED_OPEN_CIRCUITS 1066,41523
circuit_is_available_for_use(1074,41822
needs_exit_circuits(1106,42916
#define SUFFICIENT_UPTIME_INTERNAL_HS_SERVERS 1114,43253
needs_hs_server_circuits(1119,43428
#define SUFFICIENT_INTERNAL_HS_CLIENTS 1148,44355
#define SUFFICIENT_UPTIME_INTERNAL_HS_CLIENTS 1152,44489
needs_hs_client_circuits(1157,44664
#define CBT_MIN_REMAINING_PREEMPTIVE_CIRCUITS 1174,45448
#define CBT_MAX_UNUSED_OPEN_CIRCUITS 1179,45672
needs_circuits_for_build(1186,46014
circuit_predict_and_launch_new(1203,46549
#define TESTING_CIRCUIT_INTERVAL 1288,49310
circuit_build_needed_circs(1296,49656
circuit_expire_old_circs_as_needed(1319,50422
circuit_detach_stream(1350,51404
circuit_expire_old_circuits_clientside(1431,53919
#define IDLE_ONE_HOP_CIRC_TIMEOUT 1514,57840
circuit_expire_old_circuits_serverside(1521,58037
#define NUM_PARALLEL_TESTING_CIRCS 1547,59089
static int have_performed_bandwidth_test 1551,59213
reset_bandwidth_test(1556,59393
circuit_enough_testing_circs(1566,59642
circuit_testing_opened(1590,60373
circuit_testing_failed(1608,61136
circuit_has_opened(1630,61846
circuit_try_clearing_isolation_state(1680,63798
circuit_try_attaching_streams(1702,64581
circuit_build_failed(1719,65105
static int n_circuit_failures 1831,69884
static int did_circs_fail_last_period 1834,70021
#define MAX_CIRCUIT_FAILURES 1838,70154
circuit_launch(1843,70299
have_enough_path_info(1854,70671
circuit_launch_by_extend_info(1870,71408
circuit_increment_failure_count(1986,75930
circuit_reset_failure_count(1997,76233
circuit_get_open_circ_or_launch(2013,76719
cpath_is_on_circuit(2370,91975
optimistic_data_enabled(2383,92337
link_apconn_to_circ(2402,92999
hostname_in_track_host_exits(2462,95478
consider_recording_trackhost(2484,96145
connection_ap_handshake_attach_chosen_circuit(2522,97706
connection_ap_handshake_attach_circuit(2574,99651
circuit_change_purpose(2819,109638
mark_circuit_unusable_for_new_conns(2855,110764

command.c,659
uint64_t stats_n_create_cells_processed 58,2151
uint64_t stats_n_created_cells_processed 60,2255
uint64_t stats_n_relay_cells_processed 62,2358
uint64_t stats_n_destroy_cells_processed 64,2461
cell_command_to_string(79,3121
command_time_process_cell(109,4243
command_process_cell(139,5099
#define PROCESS_CELL(171,6254
#define PROCESS_CELL(177,6574
command_process_var_cell(217,7712
command_process_create_cell(234,8298
command_process_created_cell(393,14345
command_process_relay_cell(463,16922
command_process_destroy_cell(563,20685
command_handle_incoming_channel(605,22083
command_setup_channel(618,22337
command_setup_listener(632,22638

config.c,7346
#define CONFIG_PRIVATE61,2691
#   define __INCLUDE_LEVEL__ 116,3959
static const char unix_socket_prefix[unix_socket_prefix122,4195
static const char unix_q_socket_prefix[unix_q_socket_prefix125,4339
static config_abbrev_t option_abbrevs_[option_abbrevs_129,4546
#define VAR(183,6674
#define V(187,6955
#define OBSOLETE(191,7166
#define OBSOLETE(193,7248
#define VPORT(203,7647
static config_var_t option_vars_[option_vars_212,8070
static const config_var_t testing_tor_network_defaults[testing_tor_network_defaults637,29405
#undef VAR690,32288
#undef V691,32299
#undef OBSOLETE692,32308
static const config_deprecation_t option_deprecation_notes_[option_deprecation_notes_694,32325
#define OR_OPTIONS_MAGIC 758,35681
STATIC config_format_t options_format 761,35761
static or_options_t *global_options global_options777,36091
static or_options_t *global_default_options global_default_options780,36262
static char *torrc_fname torrc_fname782,36360
static char *torrc_defaults_fname;torrc_defaults_fname784,36451
static config_line_t *global_cmdline_options global_cmdline_options786,36536
static config_line_t *global_cmdline_only_options global_cmdline_only_options788,36646
static int have_parsed_cmdline 790,36753
static char *global_dirfrontpagecontents global_dirfrontpagecontents792,36850
static smartlist_t *configured_ports configured_ports794,36951
static int in_option_validation 797,37105
MOCK_IMPL(800,37222
MOCK_IMPL(807,37367
MOCK_IMPL(816,37577
set_options(827,37883
static char *the_tor_version the_tor_version889,39958
static char *the_short_tor_version the_short_tor_version892,40137
get_version(896,40233
get_short_version(911,40615
or_options_free(927,40947
config_free_all(952,41708
safe_str_client(987,42669
safe_str(1004,43120
escaped_safe_str_client(1017,43473
escaped_safe_str(1029,43819
static int protocol_warning_severity_level 1044,44209
get_protocol_warning_severity_level(1049,44369
static const char *default_authorities[default_authorities1056,44504
static const char *default_fallbacks[default_fallbacks1095,46319
add_default_trusted_dir_authorities(1105,46714
MOCK_IMPL(1118,47112
validate_dir_servers(1135,47594
consider_adding_dir_servers(1186,49648
static int have_low_ports 1251,52291
options_act_reversible(1260,52612
options_need_geoip_info(1554,62885
get_effective_bwrate(1580,63948
get_effective_bwburst(1594,64459
options_transition_affects_guards(1608,64895
options_act(1641,66225
#define RELAY_BRIDGE_STATS_DELAY 2002,79441
  TAKES_NO_ARGUMENT 2190,86641
  ARGUMENT_NECESSARY 2191,86666
  ARGUMENT_OPTIONAL 2192,86692
} takes_argument_t;2193,86716
  const char *name;name2196,86759
  takes_argument_t takes_argument;2197,86779
} CMDLINE_ONLY_OPTIONS[CMDLINE_ONLY_OPTIONS2198,86814
config_parse_commandline(2231,88357
option_is_recognized(2323,90839
option_get_canonical_name(2332,91086
option_get_assignment(2341,91318
options_trial_assign(2356,91892
print_usage(2401,93025
list_torrc_options(2414,93387
list_deprecated_options(2428,93730
static uint32_t last_resolved_addr 2437,93939
get_last_resolved_addr(2441,94052
reset_last_resolved_addr(2448,94176
using_default_dir_authorities(2456,94378
resolve_my_address(2510,96560
MOCK_IMPL(2707,103412
options_new(2734,104390
options_init(2742,104561
options_dump(2752,104862
validate_ports_csv(2781,105641
ensure_bandwidth_cap(2805,106141
compute_publishserverdescriptor(2828,107037
#define MIN_REND_POST_PERIOD 2865,108489
#define MIN_REND_POST_PERIOD_TESTING 2866,108526
#define MAX_CIRCS_AVAILABLE_TIME 2871,108739
#define MAX_DIR_PERIOD 2874,108835
#define MIN_MAX_CIRCUIT_DIRTINESS 2878,109028
#define MAX_MAX_CIRCUIT_DIRTINESS 2882,109152
#define MIN_CIRCUIT_STREAM_TIMEOUT 2886,109354
#define RECOMMENDED_MIN_CIRCUIT_BUILD_TIMEOUT 2893,109645
options_validate_cb(2896,109708
#define REJECT(2906,110022
#define COMPLAIN(2909,110140
#define COMPLAIN(2912,110223
warn_if_option_path_is_relative(2925,110713
warn_about_relative_paths(2944,111297
options_validate_scheduler(2981,113071
options_validate_single_onion(3034,115088
options_validate(3108,118458
#define CHECK_DEFAULT(4189,162092
#undef CHECK_DEFAULT4221,163829
#undef REJECT4397,171039
#undef COMPLAIN4398,171053
compute_real_max_mem_in_queues(4404,171263
#define ONE_GIGABYTE 4409,171369
#define ONE_MEGABYTE 4410,171413
#define MAX_DEFAULT_MAXMEM 4412,171480
#define MAX_DEFAULT_MAXMEM 4414,171530
#define DIRCACHE_MIN_MEM_MB 4463,173300
#define DIRCACHE_MIN_MEM_BYTES 4464,173332
#define STRINGIFY(4465,173398
have_enough_mem_for_dircache(4471,173663
#undef STRINGIFY4506,175087
opt_streq(4511,175207
options_transition_allowed(4518,175379
#define SB_NOCHANGE_STR(4620,178692
#undef SB_NOCHANGE_STR4634,179356
options_transition_affects_workers(4657,180036
options_transition_affects_descriptor(4682,181166
get_windows_conf_root(4727,183450
#define APPDATA_PATH 4744,183831
#define APPDATA_PATH 4746,183878
get_default_conf_file(4785,185079
normalize_nickname_list(4814,186031
find_torrc_filename(4898,188469
load_torrc_from_stdin(4967,190396
load_torrc_from_disk(4982,190791
options_init_from_torrc(5033,192403
options_init_from_string(5234,199023
get_torrc_fname(5398,204457
config_register_addressmaps(5412,204770
addressmap_register_auto(5458,206169
options_init_logs(5502,207251
validate_transport_socks_arguments(5641,211691
bridge_line_free(5675,212585
parse_bridge_line(5701,213394
parse_transport_line(5819,217125
get_bindaddr_from_transport_listen_line(6022,223265
get_options_from_transport_options_line(6075,224765
get_transport_bindaddr_from_config(6128,226401
get_options_for_server_transport(6148,227021
parse_dir_authority_line(6171,227837
parse_dir_fallback_line(6321,233214
port_cfg_new(6427,236533
port_cfg_free(6442,236998
warn_nonlocal_client_ports(6450,237180
warn_nonlocal_ext_orports(6478,238463
warn_nonlocal_controller_ports(6501,239433
port_cfg_line_extract_addrport(6549,241601
warn_client_dns_cache(6595,242892
check_bridge_distribution_setting(6629,243927
parse_port_config(6688,245892
count_real_listeners(7144,262457
parse_ports(7169,263258
port_binds_ipv4(7343,269477
port_binds_ipv6(7352,269715
check_server_ports(7363,270130
MOCK_IMPL(7449,273064
get_first_listener_addrport_string(7467,273682
get_first_advertised_port_by_type_af(7521,275331
get_first_advertised_addr_by_type_af(7543,276077
port_exists_by_type_addr_port(7568,276990
port_exists_by_type_addr32h_port(7611,278633
normalize_data_directory(7623,279089
validate_data_directory(7665,280368
#define GENERATED_FILE_PREFIX 7679,280785
#define GENERATED_FILE_COMMENT 7683,281026
write_configuration_file(7691,281418
options_save_current(7766,283253
get_num_cpus(7779,283764
init_libevent(7793,284003
MOCK_IMPL(7828,285215
check_or_create_data_subdir(7868,286370
write_to_data_subdir(7887,287024
remove_file_if_very_old(7904,287554
#define VERY_OLD_FILE_AGE 7906,287611
get_list_of_ports_to_forward(7927,288330
getinfo_helper_config(7965,289566
verify_and_store_outbound_address(8086,294148
parse_outbound_address_lines(8112,294913
parse_outbound_addresses(8141,296011
config_load_geoip_file_(8175,297067
config_maybe_load_geoip_files_(8199,297888
init_cookie_authentication(8229,299029

confparse.c,1041
config_new(37,1350
config_expand_abbrev(55,1953
config_find_deprecation(85,3146
config_find_option_mutable(103,3607
config_find_option(134,4633
config_count_options(141,4836
config_assign_value(159,5208
config_mark_lists_fragile(364,10804
warn_deprecated_option(384,11265
config_assign_line(403,11961
config_reset_line(480,14596
config_value_needs_escape(497,15027
config_get_assigned_option(525,15775
config_assign(725,22194
config_clear(776,23779
config_reset(843,25785
config_free(866,26488
config_is_same(889,27019
config_dup(908,27521
config_init(937,28345
config_dump(956,28877
struct unit_table_t 1030,31213
  const char *unit;unit1031,31235
  uint64_t multiplier;1032,31284
static struct unit_table_t memory_units[memory_units1037,31451
static struct unit_table_t time_units[time_units1084,32781
static struct unit_table_t time_msec_units[time_msec_units1103,33288
config_parse_units(1128,34060
config_parse_memunit(1178,35133
config_parse_msec_interval(1189,35515
config_parse_interval(1206,36007

connection.c,5286
#define CONNECTION_PRIVATE57,2514
#define TOR_CHANNEL_INTERNAL_66,2748
#define CONNECTION_PRIVATE67,2778
static tor_addr_t *last_interface_ipv4 last_interface_ipv4150,5757
static tor_addr_t *last_interface_ipv6 last_interface_ipv6152,5837
static smartlist_t *outgoing_addrs outgoing_addrs155,6000
#define CASE_ANY_LISTENER_TYPE 157,6044
conn_type_to_string(174,6576
conn_state_to_string(206,7793
dir_connection_new(291,11269
or_connection_new(306,11711
entry_connection_new(327,12298
edge_connection_new(348,13196
control_connection_new(359,13575
listener_connection_new(371,13961
connection_new(383,14440
connection_init(424,15566
connection_link_connections(472,16871
conn_listener_type_supports_af_unix(486,17227
connection_free_(504,17734
MOCK_IMPL(679,23577
connection_about_to_close_connection(725,25204
#define CONN_IS_CLOSED(748,25823
connection_close_immediate(756,26091
connection_mark_for_close_(786,26949
MOCK_IMPL(819,28345
connection_expire_held_open(863,29827
create_unix_sockaddr(910,31446
create_unix_sockaddr(933,32192
warn_too_many_conns(950,32779
#define WARN_TOO_MANY_CONNS_INTERVAL 952,32807
#define UNIX_SOCKET_PURPOSE_CONTROL_SOCKET 967,33347
#define UNIX_SOCKET_PURPOSE_SOCKS_SOCKET 968,33392
is_valid_unix_socket_purpose(973,33522
unix_socket_purpose_to_string(989,33827
check_location_for_unix_socket(1008,34280
make_socket_reuseable(1065,35966
make_win32_socket_exclusive(1089,36670
static int listen_limit 1111,37348
tor_listen(1115,37469
connection_listener_new(1138,38074
check_sockaddr(1448,48328
check_sockaddr_family_match(1491,49767
connection_handle_listener_read(1509,50382
connection_init_accepted_conn(1670,55986
MOCK_IMPL(1731,58265
connection_connect_log_client_use_ip_version(1837,61686
conn_get_outbound_address(1911,64791
connection_connect(1968,66683
connection_connect_unix(2022,68714
connection_proxy_state_to_string(2056,69787
get_proxy_type(2082,70542
#define SOCKS4_STANDARD_BUFFER_SIZE 2101,71024
connection_proxy_connect(2114,71498
connection_read_https_proxy_response(2269,76527
connection_send_socks5_connect(2330,78336
connection_fetch_from_buf_socks_client(2362,79164
connection_read_proxy_handshake(2379,79749
retry_listener_ports(2548,85518
retry_all_listeners(2677,89802
connection_mark_all_noncontrol_listeners(2730,91917
connection_mark_all_noncontrol_connections(2744,92346
connection_is_rate_limited(2785,93663
static int write_buckets_empty_last_second 2802,94287
#define CLIENT_IDLE_TIME_FOR_PRIORITY 2806,94457
connection_counts_as_relayed_traffic(2813,94713
connection_bucket_round_robin(2830,95397
connection_bucket_read_limit(2860,96412
connection_bucket_write_limit(2889,97389
global_write_bucket_low(2940,99394
record_num_bytes_transferred_impl(2974,100751
msec_since_midnight(3005,101784
bucket_millis_empty(3018,102377
connection_buckets_note_empty_ts(3038,103195
static uint32_t global_relayed_read_emptied 3048,103608
connection_buckets_decrement(3056,103928
connection_consider_empty_read_buckets(3116,106471
connection_consider_empty_write_buckets(3143,107390
connection_bucket_init(3169,108290
connection_bucket_refill_helper(3189,109068
connection_bucket_refill(3215,110061
connection_bucket_should_increase(3367,117203
connection_handle_read_impl(3388,117763
connection_handle_read(3501,121928
connection_buf_read_from_socket(3521,122503
connection_buf_get_bytes(3711,129517
connection_buf_get_line(3718,129716
connection_fetch_from_buf_http(3727,129979
connection_wants_to_flush(3739,130493
connection_outbuf_too_full(3749,130779
connection_handle_write_impl(3773,131645
connection_handle_write(4023,140768
connection_flush(4043,141387
MOCK_IMPL(4056,141842
#define CONN_GET_ALL_TEMPLATE(4116,144052
connection_list_by_type_state(4132,144800
connection_list_by_type_purpose(4142,145251
#define CONN_GET_TEMPLATE(4150,145540
MOCK_IMPL(4164,146195
connection_get_by_global_id(4180,146678
connection_get_by_type(4188,146875
connection_get_by_type_state(4197,147091
connection_get_by_type_state_rendquery(4207,147420
#define DIR_CONN_LIST_TEMPLATE(4234,148488
connection_dir_list_by_purpose_and_resource(4259,149937
connection_dir_list_by_purpose_resource_and_state(4277,150743
#undef DIR_CONN_LIST_TEMPLATE4289,151258
connection_get_another_active_or_conn(4296,151507
any_other_active_or_conns(4308,151899
#undef CONN_GET_TEMPLATE4320,152186
connection_is_listener(4324,152282
connection_state_is_open(4343,152899
connection_state_is_connecting(4363,153472
alloc_http_authenticator(4386,154054
client_check_address_changed(4407,154935
set_constrained_socket_buffers(4480,157664
connection_process_inbuf(4503,158500
connection_flushed_some(4529,159344
connection_finished_flushing(4554,160150
connection_finished_connecting(4592,161281
connection_reached_eof(4620,162141
oos_victim_comparator_for_orconns(4642,162811
oos_victim_comparator(4658,163265
MOCK_IMPL(4690,164162
MOCK_IMPL(4783,167145
connection_check_oos(4808,167885
connection_dump_buffer_mem_stats(4892,170899
assert_connection_ok(4941,172529
get_proxy_addrport(5093,177560
log_failed_proxy_connection(5145,179179
proxy_type_to_string(5163,179772
connection_free_all(5183,180326
clock_skew_warning(5219,181418

connection_edge.c,3310
#define CONNECTION_EDGE_PRIVATE56,2646
#define TRANS_NETFILTER104,3672
#define TRANS_NETFILTER_IPV4105,3696
#define TRANS_NETFILTER115,3911
#define TRANS_NETFILTER_IPV6116,3935
#define TRANS_PF123,4132
#define TRANS_TPROXY127,4179
#define SOCKS4_GRANTED 130,4208
#define SOCKS4_REJECT 131,4243
MOCK_IMPL(143,4823
connection_edge_reached_eof(196,6898
connection_edge_process_inbuf(230,8190
connection_edge_destroy(299,10660
relay_send_end_cell_from_edge(329,11925
warn_if_hs_unreachable(351,12762
#define WARN_FAILED_HS_CONNECTION 359,13051
connection_edge_end(381,13877
connection_edge_end_errno(449,16201
connection_edge_flushed_some(463,16592
connection_edge_finished_flushing(485,17137
#define MAX_CONNECTED_CELL_PAYLOAD_LEN 514,18015
connected_cell_format_payload(523,18448
connection_edge_finished_connecting(557,19511
static smartlist_t *pending_entry_connections pending_entry_connections606,21531
static int untried_pending_connections 608,21586
connection_edge_about_to_close(612,21702
connection_ap_about_to_close(626,22190
connection_exit_about_to_close(677,24118
compute_retry_timeout(698,24810
connection_ap_expire_beginning(718,25539
connection_ap_rescan_and_attach_pending(839,30674
#define UNMARK(870,31661
#define UNMARK(875,31865
connection_ap_attach_pending(886,32270
connection_ap_mark_as_pending_circuit_(960,34749
connection_ap_mark_as_non_pending_circuit(1007,36515
connection_ap_warn_and_unmark_if_pending_circ(1017,36754
connection_ap_fail_onehop(1034,37479
circuit_discard_optional_exit_enclaves(1075,39129
connection_ap_detach_retriable(1126,41279
consider_plaintext_ports(1159,42572
#define TRACKHOSTEXITS_RETRIES 1186,43692
MOCK_IMPL(1194,43977
connection_ap_handshake_rewrite(1214,44696
connection_ap_handle_onion(1411,53472
connection_ap_handshake_rewrite_and_attach(1617,61966
#define WARN_INTRVL_LOOP 1894,74190
#define WARN_INTRVL_PRIV 1906,74750
static int pf_socket 2055,81092
get_pf_socket(2057,81123
destination_from_socket(2087,81841
destination_from_pf(2157,84061
connection_ap_get_original_destination(2246,86886
connection_ap_handshake_process_socks(2286,88147
connection_ap_process_transparent(2348,90218
connection_ap_process_natd(2388,91551
connection_ap_process_http_connect(2460,94041
get_unique_stream_id_by_circ(2559,96938
connection_ap_supports_optimistic_data(2583,97640
connection_ap_get_begincell_flags(2600,98304
MOCK_IMPL(2662,100325
connection_ap_handshake_send_resolve(2782,105152
connection_ap_make_link(2872,108483
tell_controller_about_resolved_result(2939,110889
connection_ap_handshake_socks_resolved_addr(2969,112066
MOCK_IMPL(3001,113734
connection_ap_handshake_socks_reply(3120,118425
begin_cell_parse(3225,122607
handle_hs_exit_conn(3285,124499
connection_exit_begin_conn(3381,128090
connection_exit_begin_resolve(3570,135082
my_exit_policy_rejects(3618,136878
connection_exit_connect(3640,137612
connection_exit_connect_dir(3752,141756
connection_edge_is_rendezvous_stream(3812,143725
connection_ap_can_use_exit(3830,144248
parse_extended_hostname(3910,147301
memeq_opt(3958,148784
connection_edge_compatible_with_circuit(3976,149172
connection_edge_update_circuit_isolation(4046,151923
circuit_clear_isolation(4124,155147
connection_edge_free_all(4159,156264

connection_or.c,3669
#define TOR_CHANNEL_INTERNAL_30,1127
static digestmap_t *orconn_ext_or_id_map orconn_ext_or_id_map88,2955
connection_or_clear_identity(93,3102
connection_or_clear_identity_map(101,3272
connection_or_set_identity_digest(122,3930
connection_or_remove_from_ext_or_id_map(179,5835
connection_or_get_by_ext_or_id(197,6338
connection_or_clear_ext_or_id_map(206,6552
connection_or_set_ext_or_identifier(215,6797
static strmap_t *broken_connection_counts;broken_connection_counts246,7805
static int disable_broken_connection_counts 249,7927
note_broken_connection(253,8049
clear_broken_connection_map(273,8538
connection_or_get_state_description(287,9036
connection_or_note_state_when_broken(305,9647
typedef struct broken_state_count_t 316,10020
  intptr_t count;317,10058
  const char *state;state318,10076
} broken_state_count_t;319,10097
broken_state_count_compare(323,10204
#define MAX_REASONS_TO_REPORT 336,10531
connection_or_report_broken_states(341,10697
connection_or_change_state(379,11853
MOCK_IMPL(397,12356
cell_pack(417,12906
cell_unpack(438,13518
var_cell_pack_header(454,13965
var_cell_new(474,14506
var_cell_copy(489,14786
var_cell_free(508,15232
connection_or_reached_eof(515,15368
connection_or_process_inbuf(531,15740
#define MAX_OR_INBUF_WHEN_NONOPEN 536,15953
connection_or_flushed_some(591,17838
connection_or_num_cells_writeable(612,18454
connection_or_finished_flushing(642,19276
connection_or_finished_connecting(664,19821
connection_or_about_to_close(700,20860
connection_or_digest_is_known_relay(751,22994
connection_or_update_token_buckets_helper(771,23858
connection_or_update_token_buckets(811,25642
connection_or_set_canonical(825,26084
connection_or_init_conn_from_address(852,27135
connection_or_check_canonicity(879,28233
connection_or_is_bad_for_new_circs(946,30738
connection_or_mark_bad_for_new_circs(956,30952
#define TIME_BEFORE_OR_CONN_IS_TOO_OLD 966,31235
connection_or_group_set_badness_(986,32118
connection_or_connect_failed(1111,37758
connection_or_notify_error(1126,38314
MOCK_IMPL(1165,39664
connection_or_close_normally(1295,44616
MOCK_IMPL(1315,45189
MOCK_IMPL(1340,45988
connection_or_block_renegotiation(1382,47244
connection_or_tls_renegotiated_cb(1394,47594
connection_tls_continue_handshake(1415,48204
connection_or_nonopen_was_started_here(1469,50170
connection_or_check_valid_tls_handshake(1506,51807
connection_or_client_learned_peer_id(1603,55354
connection_or_client_used(1751,61541
connection_tls_finish_handshake(1774,62252
connection_or_launch_v3_or_handshake(1820,64033
connection_init_or_handshake_state(1836,64546
or_handshake_state_free(1857,65232
or_handshake_state_record_cell(1879,65905
or_handshake_state_record_var_cell(1920,67379
connection_or_set_state_open(1952,68341
connection_or_write_cell_to_buf(1969,68872
MOCK_IMPL(2004,70064
connection_fetch_var_cell_from_buf(2027,70929
connection_or_process_cells_from_inbuf(2041,71326
static const uint16_t or_protocol_versions[or_protocol_versions2101,73654
static const int n_or_protocol_versions 2103,73778
is_or_protocol_version_known(2109,73999
connection_or_send_versions(2128,74534
MOCK_IMPL(2157,75478
add_certs_cell_cert_helper(2224,77461
add_x509_cert(2244,78240
add_ed25519_cert(2262,78809
int certs_cell_ed25519_disabled_for_testing 2274,79105
#define certs_cell_ed25519_disabled_for_testing 2276,79160
connection_or_send_certs_cell(2282,79318
authchallenge_type_is_supported(2374,82187
authchallenge_type_is_better(2389,82568
connection_or_send_auth_challenge_cell(2406,83216
connection_or_compute_authenticate_cell_body(2468,85419
MOCK_IMPL(2697,92401

conscache.c,1579
#define CCE_MAGIC 10,178
#define MUST_UNMAP_TO_UNLINK17,416
struct consensus_cache_entry_t 25,661
  uint32_t magic;26,694
  HANDLE_ENTRY(27,745
  int32_t refcnt;28,809
  unsigned can_remove 29,852
  unsigned release_aggressively 31,1003
  char *fname;fname34,1100
  config_line_t *labels;labels37,1203
  consensus_cache_t *in_cache;in_cache39,1293
  time_t unused_since;43,1453
  tor_mmap_t *map;map45,1538
  size_t bodylen;47,1604
  const uint8_t *body;body49,1670
struct consensus_cache_t 55,1769
  storage_dir_t *dir;dir57,1851
  smartlist_t *entries;entries59,1924
  unsigned max_entries;64,2120
consensus_cache_open(78,2623
#define VERY_LARGE_STORAGEDIR_LIMIT 91,3172
consensus_cache_may_overallocate(118,4016
consensus_cache_register_with_sandbox(133,4283
consensus_cache_clear(157,5232
consensus_cache_free(173,5617
consensus_cache_add(199,6381
consensus_cache_find_first(233,7364
consensus_cache_find_all(255,7984
consensus_cache_filter_list(283,8802
consensus_cache_entry_get_value(307,9524
consensus_cache_entry_get_labels(324,9958
consensus_cache_entry_incref(333,10114
consensus_cache_entry_decref(348,10475
consensus_cache_entry_mark_for_removal(391,11498
consensus_cache_entry_mark_for_aggressive_release(401,11730
consensus_cache_entry_get_body(415,12162
consensus_cache_unmap_lazy(443,12817
consensus_cache_get_n_filenames_available(467,13498
consensus_cache_delete_pending(487,14067
consensus_cache_rescan(526,15206
consensus_cache_entry_map(564,16373
consensus_cache_entry_unmap(582,16826
HANDLE_IMPL(595,17071

consdiff.c,1477
#define CONSDIFF_PRIVATE39,1917
static const char* ns_diff_version 46,2028
static const char* hash_token 47,2098
lines_eq(53,2265
line_str_eq(60,2468
line_starts_with_str(71,2756
cdline_linecpy(81,3078
smartlist_add_linecpy(94,3470
MOCK_IMPL(103,3806
MOCK_IMPL(116,4291
MOCK_IMPL(127,4733
smartlist_slice(140,5182
lcs_lengths(165,5960
trim_slices(213,7252
smartlist_slice_string_pos(245,8129
set_changed(264,8778
optimal_column_to_split(293,9729
calc_changes(327,10880
#define NOT_VALID_BASE64 365,12121
#define X 366,12150
#define SP 367,12177
#define PAD 368,12205
static const uint8_t base64_compare_table[base64_compare_table369,12234
get_id_hash(395,13437
is_valid_router_entry(435,14441
next_router(449,14920
base64cmp(472,15447
typedef struct router_id_iterator_t 528,17011
  cdline_t last_hash;529,17049
  cdline_t hash;530,17071
} router_id_iterator_t;531,17088
#define ROUTER_ID_ITERATOR_INIT 536,17164
find_next_router_line(547,17636
#define START_OF_SIGNATURES_SECTION 568,18400
preprocess_consensus(579,18899
gen_ed_diff(623,20473
#define MAX_LINE_COUNT 729,24431
get_linenum(833,27427
apply_ed_diff(857,28040
consdiff_gen_diff(1024,33093
consdiff_get_digests(1104,35839
consdiff_apply_diff(1190,38736
#define CONSENSUS_LINE_MAX_LEN 1271,41532
consensus_split_lines(1286,42101
consensus_join_lines(1313,42818
consensus_diff_generate(1334,43444
consensus_diff_apply(1374,44546
looks_like_a_consensus_diff(1407,45345

consdiffmgr.c,3923
#define CONSDIFFMGR_PRIVATE14,379
#define LABEL_DOCTYPE 32,740
#define LABEL_VALID_AFTER 35,885
#define LABEL_FRESH_UNTIL 38,1042
#define LABEL_VALID_UNTIL 41,1199
#define LABEL_SIGNATORIES 44,1339
#define LABEL_SHA3_DIGEST 46,1459
#define LABEL_SHA3_DIGEST_UNCOMPRESSED 48,1565
#define LABEL_SHA3_DIGEST_AS_SIGNED 50,1688
#define LABEL_FLAVOR 52,1802
#define LABEL_FROM_SHA3_DIGEST 54,1910
#define LABEL_TARGET_SHA3_DIGEST 56,2026
#define LABEL_FROM_VALID_AFTER 58,2143
#define LABEL_COMPRESSION_TYPE 60,2234
#define DOCTYPE_CONSENSUS 63,2290
#define DOCTYPE_CONSENSUS_DIFF 64,2328
static consensus_cache_t *cons_diff_cache cons_diff_cache70,2512
static int cdm_cache_dirty 75,2675
static int cdm_cache_loaded 79,2787
typedef enum cdm_diff_status_t 84,2887
  CDM_DIFF_PRESENT=85,2920
  CDM_DIFF_IN_PROGRESS=86,2942
  CDM_DIFF_ERROR=87,2968
} cdm_diff_status_t;88,2988
static const compress_method_t compress_diffs_with[compress_diffs_with91,3067
n_diff_compression_methods(104,3325
static const compress_method_t compress_consensus_with[compress_consensus_with110,3470
n_consensus_compression_methods(122,3719
#define RETAIN_CONSENSUS_COMPRESSED_WITH_METHOD 131,4026
                  latest_consensus[latest_consensus136,4212
typedef struct cdm_diff_t 141,4469
  HT_ENTRY(142,4497
} cdm_diff_t;161,5307
static HT_HEAD(164,5393
cdm_diff_hash(189,6246
cdm_diff_eq(199,6598
HT_PROTOTYPE(206,6831
cdm_diff_new(223,7336
cdm_diff_ht_check_and_note_pending(246,8140
cdm_diff_ht_set_status(279,9341
cdm_diff_ht_purge(319,10810
cdm_cache_init(354,11881
cdm_cache_get(377,12477
cdm_labels_prepend_sha3(391,12800
cdm_entry_get_sha3_value(411,13569
cdm_cache_lookup_consensus(435,14207
get_max_age_to_cache(464,15349
consdiffmgr_add_consensus(498,16514
compare_by_valid_after_(532,17560
sort_and_find_most_recent(547,18087
consensus_compression_method_pos(560,18408
consdiffmgr_find_consensus(577,18845
consdiffmgr_find_diff_from(608,19868
consdiffmgr_cleanup(670,22002
consdiffmgr_configure(792,27006
consdiffmgr_register_with_sandbox(805,27288
consdiffmgr_validate(816,27625
consdiffmgr_rescan_flavor_(868,29155
consdiffmgr_consensus_load(986,33900
consdiffmgr_diffs_load(1027,35548
consdiffmgr_rescan(1069,36897
compare_by_staleness_(1098,37644
consdiffmgr_ensure_space_for_files(1125,38592
consdiffmgr_set_cache_flags(1180,40246
consdiffmgr_free_all(1197,40861
typedef struct compressed_result_t 1221,41479
  config_line_t *labels;labels1222,41516
  uint8_t *body;body1226,41599
  size_t bodylen;1230,41660
} compressed_result_t;1231,41678
compress_multiple(1244,42142
store_multiple(1283,43486
typedef struct consensus_diff_worker_job_t 1324,44767
  consensus_cache_entry_t *diff_from;diff_from1330,45057
  consensus_cache_entry_t *diff_to;diff_to1336,45338
  compressed_result_t out[out1339,45410
} consensus_diff_worker_job_t;1340,45472
uncompress_or_copy(1350,45887
consensus_diff_worker_threadfn(1375,46599
consensus_diff_worker_job_free(1509,51661
consensus_diff_worker_replyfn(1529,52188
consensus_diff_queue_diff_work(1607,54755
typedef struct consensus_compress_worker_job_t 1644,55806
  char *consensus;consensus1645,55855
  size_t consensus_len;1646,55874
  consensus_flavor_t flavor;1647,55898
  config_line_t *labels_in;labels_in1648,55927
  compressed_result_t out[out1649,55955
} consensus_compress_worker_job_t;1650,56021
consensus_compress_worker_job_free(1656,56118
consensus_compress_worker_threadfn(1674,56613
consensus_compress_worker_replyfn(1715,58072
static int background_compression 1746,58920
consensus_queue_compression_work(1753,59070
consdiffmgr_enable_background_compression(1813,61192
consensus_cache_entry_get_voter_id_digests(1823,61529
consensus_cache_entry_get_fresh_until(1839,62056
consensus_cache_entry_get_valid_until(1855,62548
consensus_cache_entry_get_valid_after(1872,63041

control.c,9237
#define CONTROL_PRIVATE35,1531
#define STATE_IS_OPEN(91,2780
typedef uint64_t event_mask_t;99,3141
static event_mask_t global_event_mask 103,3263
static int disable_log_messages 106,3387
#define EVENT_IS_INTERESTING(110,3515
#define AUTHENTICATION_COOKIE_LEN 115,3677
static int authentication_cookie_is_set 119,3806
static uint8_t *authentication_cookie authentication_cookie123,4063
#define SAFECOOKIE_SERVER_TO_CONTROLLER_CONSTANT 125,4110
#define SAFECOOKIE_CONTROLLER_TO_SERVER_CONSTANT 127,4222
#define SAFECOOKIE_SERVER_NONCE_LEN 129,4334
static smartlist_t *detached_onion_services detached_onion_services134,4515
#define BOOTSTRAP_MSG_LEN 137,4644
static char last_sent_bootstrap_message[last_sent_bootstrap_message141,4820
static void connection_printf_to_buf(143,4881
log_severity_to_event(238,9767
clear_circ_bw_fields(252,10148
control_update_global_event_mask(267,10576
control_adjust_event_log_severity(311,11915
control_event_is_interesting(348,13106
connection_write_str_to_buf(357,13295
write_escaped_data(371,13862
read_escaped_data(427,15426
get_escaped_string_length(468,16527
extract_escaped_string(504,17282
decode_escaped_string(524,18145
connection_printf_to_buf(555,18833
control_ports_write_to_file(577,19293
send_control_done(621,20664
typedef struct queued_event_s 628,20849
  uint16_t event;629,20881
  char *msg;msg630,20899
} queued_event_t;631,20912
static tor_threadlocal_t block_event_queue_flag;635,21024
static smartlist_t *queued_control_events queued_control_events639,21180
static int flush_queued_event_pending 642,21288
static tor_mutex_t *queued_control_events_lock queued_control_events_lock645,21373
static struct event *flush_queued_events_event flush_queued_events_event649,21522
control_initialize_event_queue(652,21583
get_block_event_queue(675,22221
MOCK_IMPL(696,23004
queued_event_free(745,24359
queued_events_flush_all(759,24726
flush_queued_events_cb(818,26629
MOCK_IMPL(831,27022
send_control_event_impl(844,27519
send_control_event(863,28043
get_circ(874,28324
get_stream(886,28627
control_setconf_helper(905,29134
handle_control_setconf(1009,32242
handle_control_resetconf(1018,32565
handle_control_getconf(1026,32832
handle_control_loadconf(1095,35140
struct control_event_t 1140,36243
  uint16_t event_code;1141,36268
  const char *event_name;event_name1142,36291
static const struct control_event_t control_event_table[control_event_table1146,36454
handle_control_setevents(1185,37876
decode_hashed_passwords(1241,39586
handle_control_authenticate(1281,40695
handle_control_saveconf(1474,46993
struct signal_t 1490,47435
  int sig;1491,47453
  const char *signal_name;signal_name1492,47464
static const struct signal_t signal_table[signal_table1495,47495
handle_control_signal(1516,48083
handle_control_takeownership(1558,49053
address_is_invalid_mapaddress_target(1577,49549
handle_control_mapaddress(1588,49881
getinfo_helper_misc(1677,53364
munge_extrainfo_into_routerinfo(1795,57585
getinfo_helper_listeners(1839,58899
getinfo_helper_dir(1894,60652
digest_list_to_string(2128,69850
download_status_to_string(2152,70538
getinfo_helper_downloads_networkstatus(2252,73315
getinfo_helper_downloads_cert(2281,74537
getinfo_helper_downloads_desc(2381,78634
getinfo_helper_downloads_bridge(2427,80319
getinfo_helper_downloads(2470,81843
circuit_describe_status_for_controller(2532,83744
getinfo_helper_events(2623,86635
getinfo_helper_onions(2869,96524
getinfo_helper_liveness(2899,97345
getinfo_helper_sr(2919,97847
typedef int (*getinfo_helper_t)getinfo_helper_t2944,98784
typedef struct getinfo_item_t 2949,99027
  const char *varname;varname2950,99059
  getinfo_helper_t fn;2951,99129
  const char *desc;desc2953,99264
  int is_prefix;2954,99321
} getinfo_item_t;2955,99397
#define ITEM(2957,99416
#define PREFIX(2958,99484
#define DOC(2959,99554
static const getinfo_item_t getinfo_items[getinfo_items2963,99704
list_getinfo_options(3142,109197
handle_getinfo_helper(3170,109982
handle_control_getinfo(3195,110762
circuit_purpose_from_string(3270,113352
getargs_helper(3289,114065
find_element_starting_with(3313,114952
is_keyval_pair(3327,115320
handle_control_extendcircuit(3337,115630
handle_control_setcircuitpurpose(3487,120850
handle_control_attachstream(3532,122185
handle_control_postdescriptor(3627,125622
handle_control_redirectstream(3701,127906
handle_control_closestream(3749,129394
handle_control_closecircuit(3787,130533
handle_control_resolve(3828,131638
handle_control_protocolinfo(3870,133039
handle_control_authchallenge(3943,135438
handle_control_usefeature(4063,139606
handle_control_dropguards(4097,140565
handle_control_hsfetch(4129,141534
handle_control_hspost(4232,145108
handle_control_add_onion(4333,148660
add_onion_helper_keyarg(4631,159867
add_onion_helper_clientauth(4730,162906
handle_control_del_onion(4783,164485
connection_control_finished_flushing(4851,166574
connection_control_reached_eof(4859,166741
lost_owning_controller(4871,167107
connection_control_closed(4881,167376
is_valid_initial_command(4905,168021
#define MAX_COMMAND_LINE_LENGTH 4923,168669
peek_connection_has_control0_command(4930,168887
peek_connection_has_http_command(4936,169013
static const char CONTROLPORT_IS_NOT_AN_HTTP_PROXY_MSG[CONTROLPORT_IS_NOT_AN_HTTP_PROXY_MSG4941,169120
connection_control_process_inbuf(4971,170264
control_event_circuit_status(5212,179682
control_event_circuit_status_minor(5268,181555
control_event_circuit_purpose_changed(5341,183961
control_event_circuit_cannibalized(5355,184480
write_stream_target_to_buf(5370,185150
control_event_stream_status(5391,185924
orconn_target_get_name(5516,190349
control_event_or_conn_status(5538,191125
control_event_stream_bandwidth(5586,192714
control_event_stream_bandwidth_used(5620,193859
control_event_circ_bandwidth_used(5656,195039
control_event_conn_bandwidth(5689,196119
control_event_conn_bandwidth_used(5724,197191
sum_up_cell_stats_by_command(5739,197719
append_cell_stats_by_command(5770,199260
format_cell_stats(5795,200274
control_event_circuit_cell_stats(5842,202733
control_event_tb_empty(5870,203769
#define N_BW_EVENTS_TO_CACHE 5887,204388
static int next_measurement_idx 5889,204470
static int n_measurements 5891,204553
static struct cached_bw_event_s 5892,204584
  uint32_t n_read;5893,204618
  uint32_t n_written;5894,204637
} cached_bw_events[cached_bw_events5895,204659
control_event_bandwidth_used(5900,204814
get_bw_samples(5920,205428
disable_control_logging(5952,206378
enable_control_logging(5960,206564
control_event_logmsg(5968,206726
control_event_descriptors_changed(6024,208281
control_event_address_mapped(6056,209229
static int network_is_live 6087,210324
get_cached_network_liveness(6090,210368
set_cached_network_liveness(6096,210445
control_event_network_liveness_update(6105,210695
control_event_networkstatus_changed_helper(6135,211751
control_event_networkstatus_changed(6171,212855
control_event_newconsensus(6179,213153
control_event_buildtimeout_set(6189,213481
control_event_signal(6227,214439
control_event_networkstatus_changed_single(6267,215397
control_event_my_descriptor_changed(6285,215804
control_event_status(6296,216191
#define CONTROL_EVENT_STATUS_BODY(6342,217286
control_event_general_status(6357,218115
control_event_general_error(6366,218377
control_event_client_status(6377,218751
control_event_client_error(6386,219010
control_event_server_status(6397,219382
control_event_server_error(6406,219641
control_event_guard(6418,220039
control_event_conf_changed(6445,220897
get_controller_cookie_file_name(6476,221821
init_control_cookie_authentication(6490,222253
static char *owning_controller_process_spec owning_controller_process_spec6512,222976
static tor_process_monitor_t *owning_controller_process_monitor owning_controller_process_monitor6516,223164
owning_controller_procmon_cb(6521,223333
monitor_owning_controller_process(6531,223539
bootstrap_status_to_string(6582,225335
static int bootstrap_percent 6679,228995
static int notice_bootstrap_percent 6685,229305
static int bootstrap_problems 6691,229586
#define BOOTSTRAP_PROBLEM_THRESHOLD 6695,229722
#define BOOTSTRAP_PCT_INCREMENT 6701,229939
control_event_bootstrap(6713,230349
control_event_bootstrap_problem(6779,232792
MOCK_IMPL(6856,235311
control_event_clients_seen(6885,236250
control_event_transport_launched(6898,236682
rend_auth_type_to_string(6909,237095
MOCK_IMPL(6937,237739
rend_hsaddress_str_or_unknown(6948,238079
control_event_hs_descriptor_requested(6975,238788
get_desc_id_from_query(7003,239953
control_event_hs_descriptor_created(7047,241360
control_event_hs_descriptor_upload(7072,242181
control_event_hs_descriptor_receive_end(7099,243092
control_event_hs_descriptor_upload_end(7153,245058
control_event_hs_descriptor_received(7185,246007
control_event_hs_descriptor_uploaded(7203,246662
control_event_hs_descriptor_failed(7222,247295
control_event_hs_descriptor_content(7241,248102
control_event_hs_descriptor_upload_failed(7278,249390
control_free_all(7293,249911
control_testing_set_global_event_mask(7316,250660

cpuworker.c,2133
typedef struct worker_state_s 37,1011
  int generation;38,1043
  server_onion_keys_t *onion_keys;onion_keys39,1061
} worker_state_t;40,1096
worker_state_new(43,1129
worker_state_free(52,1313
static replyqueue_t *replyqueue replyqueue59,1433
static threadpool_t *threadpool threadpool60,1473
static struct event *reply_event reply_event61,1513
static tor_weak_rng_t request_sample_rng 63,1555
static int total_pending_tasks 65,1618
static int max_pending_tasks 66,1654
replyqueue_process_cb(69,1703
cpu_init(81,1973
#define CPUWORKER_REQUEST_MAGIC 115,3231
#define CPUWORKER_REPLY_MAGIC 116,3274
typedef struct cpuworker_request_t 119,3354
  uint32_t magic;121,3447
  unsigned timed 124,3509
  struct timeval started_at;126,3605
  create_cell_t create_cell;129,3688
} cpuworker_request_t;132,3772
typedef struct cpuworker_reply_t 135,3832
  uint32_t magic;137,3921
  uint8_t success;140,3987
  unsigned int timed 143,4044
  uint16_t handshake_type;145,4134
  struct timeval started_at;147,4217
  uint32_t n_usec;151,4467
  created_cell_t created_cell;158,4587
  uint8_t keys[keys160,4660
  uint8_t rend_auth_material[rend_auth_material162,4759
} cpuworker_reply_t;163,4801
typedef struct cpuworker_job_u 165,4823
  or_circuit_t *circ;circ166,4856
    cpuworker_request_t request;168,4888
    cpuworker_reply_t reply;169,4921
  } u;170,4950
} cpuworker_job_t;171,4957
update_state_threadfn(174,5002
cpuworkers_rotate_keyinfo(190,5466
static uint64_t onionskins_n_processed[onionskins_n_processed209,6073
static uint64_t onionskins_usec_internal[onionskins_usec_internal213,6333
static uint64_t onionskins_usec_roundtrip[onionskins_usec_roundtrip218,6613
#define MAX_BELIEVABLE_ONIONSKIN_DELAY 222,6778
should_time_request(227,6965
estimated_usec_for_onionskins(245,7679
get_overhead_for_onionskins(266,8653
cpuworker_log_onionskin_overhead(293,9474
cpuworker_onion_handshake_replyfn(313,10081
cpuworker_onion_handshake_threadfn(402,13176
queue_pending_tasks(476,15475
MOCK_IMPL(493,15828
assign_onionskin_to_cpuworker(514,16546
cpuworker_cancel_circ_handshake(582,18456

dircollate.c,542
#define DIRCOLLATE_PRIVATE24,914
typedef struct ddmap_entry_s 33,1247
  HT_ENTRY(34,1278
} ddmap_entry_t;42,1709
ddmap_entry_free(46,1777
ddmap_entry_new(54,1939
ddmap_entry_hash(63,2202
ddmap_entry_eq(71,2412
ddmap_entry_set_digests(79,2675
HT_PROTOTYPE(87,2916
dircollator_new(144,5099
dircollator_free(161,5469
dircollator_add_vote(189,6238
dircollator_collate(206,6838
dircollator_collate_by_rsa(230,7540
dircollator_collate_by_ed25519(265,8589
dircollator_n_routers(331,10643
dircollator_get_votes_for_router(346,11212

directory.c,8044
#define DIRECTORY_PRIVATE6,206
#define ALLOW_DIRECTORY_TIME_SKEW 130,5243
#define X_ADDRESS_HEADER 132,5286
#define X_OR_DIFF_FROM_CONSENSUS_HEADER 133,5333
#define FULL_DIR_CACHE_LIFETIME 137,5508
#define RUNNINGROUTERS_CACHE_LIFETIME 138,5548
#define DIRPORTFRONTPAGE_CACHE_LIFETIME 139,5594
#define NETWORKSTATUS_CACHE_LIFETIME 140,5642
#define ROUTERDESC_CACHE_LIFETIME 141,5686
#define ROUTERDESC_BY_DIGEST_CACHE_LIFETIME 142,5728
#define ROBOTS_CACHE_LIFETIME 143,5783
#define MICRODESC_CACHE_LIFETIME 144,5824
purpose_needs_anonymity(155,6203
authdir_type_to_string(205,7915
dir_conn_purpose_to_string(224,8429
dir_fetch_type(264,9800
router_supports_extrainfo(306,11036
directories_have_accepted_server_descriptor(329,11667
directory_post_to_dirservers(360,12849
should_use_directory_guards(440,16198
directory_pick_generic_dirserver(461,17020
dir_consensus_request_set_additional_headers(495,18099
MOCK_IMPL(574,21321
directory_get_from_all_authorities(712,27362
dirind_is_anon(737,28360
directory_choose_address_routerstatus(750,28853
directory_conn_is_self_reachability_test(835,32263
connection_dir_request_failed(854,32884
connection_dir_retry_bridges(899,34979
connection_dir_download_routerdesc_failed(917,35499
connection_dir_bridge_routerdesc_failed(936,36240
connection_dir_download_cert_failed(960,37024
directory_must_use_begindir(1007,38730
struct directory_request_t 1014,38938
  tor_addr_port_t or_addr_port;1020,39109
  tor_addr_port_t dir_addr_port;1021,39141
  char digest[digest1022,39174
  const routerstatus_t *routerstatus;routerstatus1024,39202
  uint8_t dir_purpose;1029,39420
  uint8_t router_purpose;1032,39548
  dir_indirection_t indirection;1035,39665
  const char *resource;resource1037,39762
  const char *payload;payload1039,39835
  size_t payload_len;1041,39910
  time_t if_modified_since;1043,40002
  const rend_data_t *rend_query;rend_query1045,40079
  config_line_t *additional_headers;additional_headers1047,40160
  const hs_ident_dir_conn_t *hs_ident;hs_ident1049,40251
  circuit_guard_state_t *guard_state;guard_state1053,40492
directory_command_should_use_begindir(1068,41041
directory_request_new(1123,42777
directory_request_free(1145,43549
directory_request_set_or_addr_port(1158,43916
directory_request_set_dir_addr_port(1169,44307
directory_request_set_directory_id_digest(1179,44580
directory_request_set_router_purpose(1191,45006
directory_request_set_indirection(1207,45687
directory_request_set_resource(1220,46124
directory_request_set_payload(1231,46482
directory_request_set_if_modified_since(1245,46903
directory_request_add_header(1259,47376
directory_request_set_rend_query(1271,47782
directory_request_upload_set_hs_ident(1286,48298
directory_request_fetch_set_hs_ident(1300,48763
directory_request_set_guard_state(1312,49217
directory_request_dir_contact_info_specified(1322,49528
directory_request_set_routerstatus(1337,50028
directory_request_set_dir_from_routerstatus(1348,50380
MOCK_IMPL(1409,52786
connection_dir_is_encrypted(1616,60514
compare_strs_(1631,60937
#define CONDITIONAL_CONSENSUS_FPR_LEN 1637,61046
directory_get_consensus_url(1651,61528
copy_ipv6_address(1697,63034
directory_send_command(1714,63522
parse_http_url(1966,71710
parse_http_command(1989,72358
http_get_header(2043,73990
http_set_address_origin(2066,74562
parse_http_response(2105,75754
body_is_plausible(2180,78352
load_downloaded_routers(2211,79304
dir_client_decompress_response_body(2266,82062
connection_dir_client_reached_eof(2392,86237
handle_response_fetch_consensus(2589,93088
handle_response_fetch_certificate(2692,96964
handle_response_fetch_status_vote(2752,99207
handle_response_fetch_detached_signatures(2788,100410
handle_response_fetch_desc(2821,101624
handle_response_fetch_microdesc(2920,105978
handle_response_upload_dir(2978,108202
handle_response_upload_vote(3046,110802
handle_response_upload_signatures(3082,111986
handle_response_fetch_hsdesc_v3(3119,113177
handle_response_fetch_renddesc_v2(3173,115108
#define SEND_HS_DESC_FAILED_EVENT(3182,115465
#define SEND_HS_DESC_FAILED_CONTENT(3186,115734
handle_response_upload_renddesc_v2(3269,119186
#define SEND_HS_DESC_UPLOAD_FAILED_EVENT(3276,119471
handle_response_upload_hsdesc(3320,121141
connection_dir_reached_eof(3363,122666
#define MAX_DIRECTORY_OBJECT_SIZE 3385,123463
#define MAX_VOTE_DL_SIZE 3387,123511
connection_dir_process_inbuf(3393,123723
refetch_hsdesc_if_needed(3436,125123
connection_dir_about_to_close(3462,126124
write_short_http_response(3479,126645
write_http_response_header_impl(3514,127859
write_http_response_headers(3582,130132
write_http_response_header(3601,130848
static compress_method_t srv_meth_pref_precompressed[srv_meth_pref_precompressed3610,131217
static compress_method_t srv_meth_pref_streaming_compression[srv_meth_pref_streaming_compression3620,131468
static compress_method_t client_meth_allowed_anonymous_compression[client_meth_allowed_anonymous_compression3629,131741
parse_accept_encoding_header(3639,132088
static compress_method_t client_meth_pref[client_meth_pref3662,132876
accept_encoding_header(3673,133114
client_likes_consensus(3707,134238
choose_compression_level(3746,135516
typedef struct get_handler_args_t 3762,135968
  unsigned compression_supported;3765,136097
  time_t if_modified_since;3768,136220
  const char *url;url3770,136306
  const char *headers;headers3772,136369
} get_handler_args_t;3773,136392
typedef struct url_table_ent_s 3785,136806
  const char *string;string3786,136839
  int is_prefix;3787,136861
  int (*handler)handler3788,136878
} url_table_ent_t;3789,136952
static const url_table_ent_t url_table[url_table3811,138131
MOCK_IMPL(3833,139209
handle_get_frontpage(3924,141763
warn_consensus_is_too_old(3951,142725
#define TOO_OLD_WARNING_INTERVAL 3954,142860
parse_one_diff_hash(3980,143807
parse_or_diff_from_header(3999,144441
#define FALLBACK_COMPRESS_METHOD 4027,145565
find_best_diff(4037,146022
find_best_consensus(4076,147629
find_best_compression_method(4111,148710
digest_list_contains_best_consensus(4137,149413
allowed_anonymous_connection_compression_method(4162,150095
warn_disallowed_anonymous_compression_method(4184,150671
  char *flavor;flavor4196,151139
  consensus_flavor_t flav;4198,151192
  const char *want_fps;want_fps4202,151383
  smartlist_t *diff_from_digests;diff_from_digests4205,151513
  int diff_only;4208,151640
} parsed_consensus_request_t;4209,151657
parsed_consensus_request_clear(4214,151806
parse_consensus_request(4233,152413
handle_get_current_consensus(4308,154734
handle_get_status_vote(4469,160593
handle_get_microdesc(4602,165531
handle_get_descriptor(4656,167412
handle_get_keys(4751,171226
handle_get_hs_descriptor_v2(4855,175326
handle_get_hs_descriptor_v3(4893,176631
handle_get_networkstatus_bridges(4930,177793
handle_get_robots(4970,179035
parse_hs_version_from_post(4992,179795
handle_post_hs_descriptor(5028,180751
MOCK_IMPL(5071,181886
directory_handle_command(5200,186532
connection_dir_finished_flushing(5248,188044
connection_dir_close_consensus_fetches(5300,190052
connection_dir_finished_connecting(5320,190866
find_dl_schedule(5340,191620
find_dl_min_and_max_delay(5401,194034
next_random_exponential_delay(5433,195293
download_status_schedule_get_delay(5482,196859
download_status_log_helper(5560,199933
download_status_increment_failure(5593,201621
download_status_increment_attempt(5654,204046
download_status_get_initial_delay_from_now(5692,205344
download_status_reset(5712,206189
download_status_get_n_failures(5729,206747
download_status_get_n_attempts(5738,207045
download_status_get_next_attempt_at(5745,207216
dir_routerdesc_download_failed(5762,207797
dir_microdesc_download_failed(5805,209525
compare_pairs_(5837,210542
dir_split_resource_into_fingerprint_pairs(5852,211074
dir_split_resource_into_fingerprints(5911,213408
dir_split_resource_into_spoolable(5993,216158

dirserv.c,5828
#define DIRSERV_PRIVATE6,206
#define ROUTER_ALLOW_SKEW 62,2108
#define DIR_REGEN_SLACK_TIME 64,2215
#define MAX_UNTRUSTED_NETWORKSTATUSES 67,2353
static int routers_with_measured_bw 74,2661
#define FP_INVALID 106,4302
#define FP_REJECT 107,4350
#define FP_BADEXIT 109,4486
typedef uint32_t router_status_t;113,4666
typedef struct authdir_config_t 121,5015
  strmap_t *fp_by_name;fp_by_name122,5049
  digestmap_t *status_by_digest;status_by_digest123,5118
} authdir_config_t;124,5195
static authdir_config_t *fingerprint_list fingerprint_list127,5262
authdir_config_new(131,5398
add_fingerprint_to_dir(144,5771
dirserv_add_own_fingerprint(177,6655
dirserv_load_fingerprint_file(196,7367
#undef DISABLE_DISABLING_ED25519266,9759
dirserv_router_get_status(275,10140
dirserv_would_reject_router(351,12995
dirserv_get_status_impl(370,13629
dirserv_free_fingerprint_list(453,16319
dirserv_router_has_valid_address(470,16720
authdir_wants_to_reject_router(495,17541
dirserv_set_node_flags_from_authoritative_status(548,19499
WRA_MORE_SEVERE(557,19814
dirserv_add_multiple_descriptors(565,20058
dirserv_add_descriptor(657,23014
dirserv_add_extrainfo(786,28093
directory_remove_invalid(847,30179
list_single_server_status(893,31697
running_long_enough_to_decide_unreachable(919,32354
#define REACHABLE_TIMEOUT 928,32663
#define HIBERNATION_PUBLICATION_SKEW 933,32888
dirserv_set_router_is_running(939,33058
list_server_status_v1(1008,35757
format_versions_list(1059,37741
router_is_active(1080,38370
directory_fetches_from_authorities(1114,39499
directory_fetches_dir_info_early(1142,40458
directory_fetches_dir_info_later(1154,40907
directory_caches_unknown_auth_certs(1165,41240
directory_caches_dir_info(1180,41818
directory_permits_begindir_requests(1196,42411
directory_too_idle_to_fetch_descriptors(1206,42709
static strmap_t *cached_consensuses cached_consensuses1218,43150
cached_dir_decref(1223,43301
new_cached_dir(1234,43547
clear_cached_dir(1250,44018
free_cached_dir_(1259,44220
dirserv_set_cached_consensus_networkstatus(1273,44535
dirserv_get_consensus(1297,45616
#define UPTIME_TO_GUARANTEE_STABLE 1309,46053
#define MTBF_TO_GUARANTEE_STABLE 1312,46247
#define TIME_KNOWN_TO_GUARANTEE_FAMILIAR 1317,46477
#define WFU_TO_GUARANTEE_GUARD 1320,46613
static uint32_t stable_uptime 1327,46852
static double stable_mtbf 1329,46980
static int enough_mtbf_info 1332,47116
static double guard_wfu 1335,47252
static long guard_tk 1338,47381
static uint32_t fast_bandwidth_kb 1340,47471
static uint32_t guard_bandwidth_including_exits_kb 1343,47593
static uint32_t guard_bandwidth_excluding_exits_kb 1346,47734
real_uptime(1351,47947
dirserv_thinks_router_is_unreliable(1365,48396
dirserv_thinks_router_is_hs_dir(1407,49861
#define ABSOLUTE_MIN_BW_VALUE_TO_CONSIDER_KB 1436,50947
router_counts_toward_thresholds(1444,51323
dirserv_compute_performance_thresholds(1472,52476
#define ABSOLUTE_MIN_VALUE_FOR_FAST_FLAG 1564,56128
dirserv_compute_bridge_flag_thresholds(1647,59185
typedef struct mbw_cache_entry_s 1655,59417
  long mbw_kb;1656,59452
  time_t as_of;1657,59467
} mbw_cache_entry_t;1658,59483
static digestmap_t *mbw_cache mbw_cache1662,59601
dirserv_cache_measured_bw(1667,59744
dirserv_clear_measured_bw_cache(1697,60556
dirserv_expire_measured_bw_cache(1708,60805
dirserv_get_measured_bw_cache_size(1730,61387
dirserv_query_measured_bw_cache_kb(1740,61714
dirserv_has_measured_bw(1761,62207
dirserv_get_bandwidth_for_router_kb(1770,62473
dirserv_count_measured_bws(1803,63546
dirserv_get_credible_bandwidth_kb(1822,64250
dirserv_get_flag_thresholds_line(1851,65162
version_from_platform(1881,66225
routerstatus_format_entry(1912,67431
#define V_LINE_OVERHEAD 1973,69709
compare_routerinfo_by_ip_and_bw_(2082,73487
get_possible_sybil_list(2140,75548
routers_make_ed_keys_unique(2175,76776
set_routerstatus_from_routerinfo(2222,78407
dirserv_set_routerstatus_testing(2294,81212
clear_status_flags_on_sybil(2331,82430
guardfraction_line_apply(2352,83256
guardfraction_file_parse_guard_line(2384,84236
guardfraction_file_parse_inputs_line(2449,86206
#define MAX_GUARDFRACTION_FILE_AGE 2496,87532
#define GUARDFRACTION_DATE_STR 2499,87647
#define GUARDFRACTION_INPUTS 2500,87691
#define GUARDFRACTION_GUARD 2501,87731
#define GUARDFRACTION_VERSION 2502,87772
dirserv_read_guardfraction_file_from_str(2524,88739
dirserv_read_guardfraction_file(2639,92569
measured_bw_line_parse(2661,93285
measured_bw_line_apply(2743,95618
dirserv_read_measured_bandwidths(2769,96310
dirserv_generate_networkstatus_vote_obj(2837,98311
dirserv_get_routerdesc_spool(3120,108792
dirserv_get_routerdescs(3199,111857
dirserv_orconn_tls_done(3268,114563
dirserv_should_launch_reachability_test(3331,116913
dirserv_single_reachability_test(3356,117744
dirserv_test_reachability(3408,119605
spooled_resource_new(3443,121001
spooled_resource_new_from_cache_entry(3478,122088
spooled_resource_free(3499,122741
#define DIRSERV_CACHED_DIR_CHUNK_SIZE 3517,123142
estimate_compression_ratio(3522,123280
spooled_resource_estimate_size(3537,123704
  SRFS_ERR 3582,125182
  SRFS_MORE 3583,125199
  SRFS_DONE3584,125216
} spooled_resource_flush_status_t;3585,125228
spooled_resource_flush_some(3593,125546
spooled_resource_lookup_cached_dir(3671,128200
spooled_resource_lookup_body(3690,128925
lookup_cached_dir_by_fp(3763,131431
dirserv_spool_remove_missing_and_guess_size(3783,132259
dirserv_spool_sort_comparison_(3827,133557
dirserv_spool_sort(3836,133823
get_signed_descriptor_by_fp(3848,134221
#define DIRSERV_BUFFER_MIN 3870,134882
connection_dirserv_flushed_some(3881,135203
dir_conn_clear_spool(3926,136569
validate_recommended_package_line(3958,137311
#define WORD(3962,137391
dirserv_free_all(4014,138657

dirvote.c,4179
#define DIRVOTE_PRIVATE6,206
typedef struct pending_consensus_t 67,2522
  char *body;body70,2677
  networkstatus_t *consensus;consensus72,2743
} pending_consensus_t;73,2773
format_line_if_present(101,3841
format_protocols_lines_for_vote(115,4225
format_networkstatus_vote(154,5753
get_voter(355,12658
voter_get_sig_by_algorithm(367,13014
typedef struct dir_src_ent_t 381,13487
  networkstatus_t *v;v382,13518
  const char *digest;digest383,13540
  int is_legacy;384,13562
} dir_src_ent_t;385,13579
compare_votes_by_authority_id_(390,13724
compare_dir_src_ents_by_authority_id_(401,14116
get_frequent_members(416,14671
#define get_most_frequent_member(436,15198
compare_vote_rs(443,15446
#define CMP_FIELD(459,15992
compare_vote_rs_(485,17069
compare_orports_(493,17251
compute_routerstatus_consensus(512,17800
cmp_int_strings_(609,21527
compute_consensus_method(628,22068
consensus_method_is_supported(663,23171
make_consensus_method_list(679,23658
compute_consensus_versions_list(703,24402
dirvote_get_intermediate_param_value(720,24902
#define MIN_VOTES_FOR_PARAM 750,25881
dirvote_compute_params(756,26078
#define RANGE_CHECK(838,28603
#define CHECK_EQ(844,28869
 BW_WEIGHTS_NO_ERROR 848,28982
 BW_WEIGHTS_RANGE_ERROR 849,29008
 BW_WEIGHTS_SUMG_ERROR 850,29037
 BW_WEIGHTS_SUME_ERROR 851,29065
 BW_WEIGHTS_SUMD_ERROR 852,29093
 BW_WEIGHTS_BALANCE_MID_ERROR 853,29121
 BW_WEIGHTS_BALANCE_EG_ERROR 854,29156
} bw_weights_error_t;855,29189
networkstatus_check_weights(861,29307
networkstatus_compute_bw_weights_v10(930,31355
update_total_bandwidth_weights(1170,40387
get_nth_protocol_set_vote(1254,43058
compute_nth_protocol_set(1272,43604
networkstatus_compute_consensus(1334,45708
compute_consensus_package_lines(2312,84245
networkstatus_add_detached_signatures(2390,86958
networkstatus_format_signatures(2521,91673
networkstatus_get_detached_signatures(2582,93968
get_detached_signatures_from_pending_consensuses(2671,96945
ns_detached_signatures_free(2688,97441
authority_cert_dup(2712,98037
dirvote_get_preferred_voting_intervals(2737,98823
dirvote_get_start_of_next_interval(2755,99504
get_next_valid_after_time(2792,100460
static voting_schedule_t voting_schedule;2806,100852
dirvote_recalculate_timing(2811,100987
get_voting_schedule(2832,101677
voting_schedule_free(2887,103543
dirvote_act(2896,103778
typedef struct pending_vote_t 2952,106220
  cached_dir_t *vote_body;vote_body2953,106252
  networkstatus_t *vote;vote2954,106279
} pending_vote_t;2955,106304
static smartlist_t *pending_vote_list pending_vote_list2959,106443
static smartlist_t *previous_vote_list previous_vote_list2962,106629
static pending_consensus_t pending_consensuses[pending_consensuses2965,106710
static char *pending_consensus_signatures pending_consensus_signatures2969,106863
static smartlist_t *pending_consensus_signature_list pending_consensus_signature_list2973,107047
dirvote_perform_vote(2978,107219
dirvote_fetch_missing_votes(3026,108674
dirvote_fetch_missing_signatures(3066,110102
dirvote_clear_pending_consensuses(3089,110755
dirvote_clear_votes(3103,111098
list_v3_auth_ids(3145,112451
dirvote_add_vote(3167,113334
write_v3_votes_to_disk(3332,119054
dirvote_compute_consensuses(3359,120050
dirvote_add_signatures_to_pending_consensus(3527,125587
dirvote_add_signatures_to_all_pending_consensuses(3598,127890
dirvote_add_signatures(3661,129860
dirvote_publish_consensus(3685,130836
dirvote_free_all(3712,131645
MOCK_IMPL(3735,132298
MOCK_IMPL(3744,132594
dirvote_get_vote(3759,133296
dirvote_create_microdescriptor(3805,134843
dirvote_format_microdesc_vote_line(3901,138276
static const struct consensus_method_range_t 3930,139193
  int low;3931,139240
  int high;3932,139251
} microdesc_consensus_methods[microdesc_consensus_methods3933,139263
typedef struct microdesc_vote_line_t 3945,139786
  int low;3946,139825
  int high;3947,139836
  microdesc_t *md;md3948,139848
  struct microdesc_vote_line_t *next;next3949,139867
} microdesc_vote_line_t;3950,139905
dirvote_format_all_microdesc_vote_lines(3956,140174
vote_routerstatus_find_microdesc_hash(4016,142098

dns.c,2699
#define DNS_PRIVATE50,2444
#define RESOLVE_MAX_TIMEOUT 71,2918
static struct evdns_base *the_evdns_base the_evdns_base74,3019
static int nameservers_configured 77,3132
static int nameserver_config_failed 79,3251
static char *resolv_conf_fname resolv_conf_fname82,3426
static time_t resolv_conf_mtime 85,3612
#define assert_cache_ok(102,4355
#define assert_cache_ok(104,4406
static HT_HEAD(109,4583
cached_resolve_hash(130,5332
HT_PROTOTYPE(135,5458
evdns_log_cb(149,5888
dns_randfn_(204,8145
dns_init(211,8268
dns_reset(225,8568
has_dns_init_failed(253,9247
dns_clip_ttl(262,9484
free_cached_resolve_(276,9905
compare_cached_resolves_by_expiry_(295,10459
static smartlist_t *cached_resolve_pqueue cached_resolve_pqueue308,10779
cached_resolve_add_answer(311,10842
cached_resolve_have_all_answers(363,12723
set_expiry(373,13084
dns_free_all(387,13571
purge_expired_resolves(412,14305
#define RESOLVED_TYPE_AUTO 492,17395
MOCK_IMPL(502,17749
MOCK_IMPL(569,19794
dns_resolve(618,21510
MOCK_IMPL(699,24470
MOCK_IMPL(852,30194
assert_connection_edge_not_dns_pending(950,33448
assert_all_pending_dns_resolves_ok(977,34205
connection_dns_remove(996,34717
MOCK_IMPL(1050,36554
is_test_address(1124,39001
dns_found_answer(1141,39823
inform_pending_connections(1194,41502
make_pending_resolve_cached(1278,44663
evdns_err_is_transient(1334,46667
configure_nameservers(1354,47254
#define SET(1439,50134
#undef SET1471,51425
evdns_callback(1497,52161
launch_one_resolve(1611,56291
MOCK_IMPL(1662,58130
static int n_wildcard_requests 1724,59985
static strmap_t *dns_wildcard_response_count dns_wildcard_response_count1730,60313
static smartlist_t *dns_wildcard_list dns_wildcard_list1735,60529
static int dns_wildcard_one_notice_given 1738,60692
static int dns_wildcard_notice_given 1741,60822
static smartlist_t *dns_wildcarded_test_address_list dns_wildcarded_test_address_list1745,60985
static int dns_wildcarded_test_address_notice_given 1747,61115
static int dns_is_completely_invalid 1749,61233
wildcard_increment_answer(1754,61415
add_wildcarded_test_address(1786,62601
evdns_wildcard_check_callback(1820,63948
launch_wildcard_check(1862,65539
launch_test_addresses(1896,66907
#define N_WILDCARD_CHECKS 1929,68000
dns_launch_wildcard_checks(1936,68318
dns_launch_correctness_checks(1967,69523
dns_seems_to_be_broken(1989,70252
dns_seems_to_be_broken_for_ipv6(1996,70394
dns_reset_correctness_checks(2003,70555
answer_is_wildcarded(2029,71431
assert_resolve_ok(2036,71625
dns_cache_entry_count(2060,72323
dump_dns_mem_usage(2067,72473
assert_cache_ok_(2085,73112
dns_get_cache_entry(2120,74141
dns_insert_cache_entry(2126,74245

dnsserv.c,232
evdns_server_callback(41,1428
dnsserv_launch_request(202,7411
dnsserv_reject_request(277,10296
evdns_get_orig_address(290,10736
dnsserv_resolved(327,11787
dnsserv_configure_listener(379,13665
dnsserv_close_listener(395,14148

entrynodes.c,5165
#define ENTRYNODES_PRIVATE113,5058
static smartlist_t *guard_contexts guard_contexts141,5686
static guard_selection_t *curr_guard_context curr_guard_context143,5783
static int entry_guards_dirty 147,5951
should_apply_guardfraction(170,7283
guard_has_descriptor(190,7966
guard_selection_infer_type(203,8280
guard_selection_new(221,8722
get_guard_selection_by_name(244,9379
create_initial_guard_context(271,10131
get_guard_selection_info(291,10893
entry_guard_describe(303,11122
entry_guard_get_rsa_id_digest(315,11469
entry_guard_get_pathbias_state(322,11640
HANDLE_IMPL(327,11719
get_max_sample_threshold(360,12599
get_max_sample_size_absolute(372,12931
get_min_filtered_sample_size(382,13245
get_remove_unlisted_guards_after_days(392,13557
get_guard_lifetime(404,13981
get_guard_confirmed_min_lifetime(419,14448
get_n_primary_guards(433,14893
get_n_primary_guards_to_use(452,15413
get_internet_likely_down_interval(477,16199
get_nonprimary_guard_connect_timeout(489,16640
get_nonprimary_guard_idle_timeout(501,17060
get_meaningful_restriction_threshold(513,17472
get_extreme_restriction_threshold(526,17967
mark_guard_maybe_reachable(537,18348
mark_primary_guards_maybe_reachable(556,18865
mark_all_guards_maybe_reachable(571,19317
choose_guard_selection(588,19757
update_guard_selection_choice(694,23511
node_is_possible_guard(733,24743
get_sampled_guard_with_id(750,25189
get_sampled_guard_for_bridge(765,25678
get_bridge_info_for_guard(783,26293
have_sampled_guard_with_id(802,26940
entry_guard_add_to_sample(813,27295
entry_guard_add_to_sample_impl(836,28204
entry_guard_add_bridge_to_sample(882,29829
get_sampled_guard_by_bridge_addr(902,30457
entry_guard_learned_bridge_identity(920,30975
num_reachable_filtered_guards(969,32731
get_max_sample_size(986,33361
get_eligible_guards(1016,34523
select_and_add_guard_item_for_sample(1074,36759
live_consensus_is_missing(1098,37557
entry_guards_expand_sample(1115,38077
remove_guard_from_confirmed_and_primary_lists(1180,40234
MOCK_IMPL(1208,41176
sampled_guards_update_from_consensus(1225,41713
node_passes_guard_filter(1354,46900
bridge_passes_guard_filter(1379,47604
entry_guard_passes_filter(1406,48412
guard_in_node_family(1434,49233
entry_guard_obeys_restriction(1468,50521
entry_guard_set_filtered_flags(1488,51147
entry_guards_update_filtered_sets(1518,52164
sample_reachable_filtered_entry_guards(1539,52883
compare_guards_by_confirmed_idx(1606,55489
entry_guards_update_confirmed(1623,55930
make_guard_confirmed(1653,56856
entry_guards_update_primary(1683,57814
get_retry_schedule(1792,61659
    time_t maximum;1807,61996
    time_t maximum; int primary_delay;1807,61996
    time_t maximum; int primary_delay; int nonprimary_delay;1807,61996
entry_guard_consider_retry(1832,62713
entry_guards_note_internet_connectivity(1863,63759
select_entry_guard_for_circuit(1877,64264
entry_guards_note_guard_failure(1978,68362
entry_guards_note_guard_success(2005,69198
entry_guard_has_higher_priority(2071,71264
entry_guard_restriction_free(2109,72199
circuit_guard_state_free(2118,72340
circuit_guard_state_new(2130,72693
entry_guard_pick_for_circuit(2155,73566
entry_guard_succeeded(2200,75060
entry_guard_cancel(2227,75902
entry_guard_failed(2248,76562
entry_guard_chan_failed(2268,77082
entry_guards_all_primary_guards_are_down(2294,77804
circ_state_has_higher_priority(2315,78518
entry_guards_upgrade_waiting_circuits(2352,79804
entry_guard_state_should_expire(2512,85750
entry_guards_update_all(2527,86262
entry_guard_encode_for_state(2541,86612
  #define PB_FIELD(2599,88706
#undef PB_FIELD2613,89267
entry_guard_parse_from_state(2631,89744
#define FIELD(2664,90697
#undef FIELD2684,91217
#define HANDLE_TIME(2756,93148
  #undef HANDLE_TIME2782,94124
#define PB_FIELD(2817,95144
#undef PB_FIELD2838,96279
entry_guards_update_guards_in_state(2884,97316
entry_guards_load_guards_from_state(2912,98233
entry_guard_get_by_id_digest_for_guard_selection(2968,99826
entry_guard_find_node(2977,100183
entry_guard_get_by_id_digest(2987,100478
get_guard_state_for_bridge_desc_fetch(2996,100816
entry_guard_free(3021,101561
entry_list_is_constrained(3038,101974
num_bridges_usable(3052,102297
pathbias_check_use_success_count(3076,102974
pathbias_check_close_success_count(3099,103809
entry_guards_parse_state(3126,104848
#define SLOW_GUARD_STATE_FLUSH_TIME 3143,105271
#define FAST_GUARD_STATE_FLUSH_TIME 3146,105429
entry_guards_changed_for_guard_selection(3153,105686
entry_guards_changed(3177,106341
entry_guards_update_state(3188,106706
getinfo_helper_format_single_entry_guard(3207,107126
getinfo_helper_entry_guards(3264,108833
guard_get_guardfraction_bandwidth(3310,110385
guards_update_all(3334,111264
guards_choose_guard(3351,111623
remove_all_entry_guards_for_guard_selection(3378,112663
remove_all_entry_guards(3407,113504
guards_choose_dirguard(3414,113701
guards_retry_optimistic(3432,114233
guard_selection_get_err_str_if_dir_info_missing(3449,114798
entry_guards_get_err_str_if_dir_info_missing(3495,116386
guard_selection_free(3506,116843
entry_guards_free_all(3528,117372

ext_orport.c,1760
#define EXT_ORPORT_PRIVATE19,720
ext_or_cmd_new(33,1073
ext_or_cmd_free(43,1297
connection_fetch_ext_or_cmd_from_buf(53,1584
connection_write_ext_or_command(63,1940
connection_ext_or_transition(84,2569
#define EXT_OR_PORT_AUTH_COOKIE_LEN 95,2921
#define EXT_OR_PORT_AUTH_COOKIE_HEADER_LEN 97,3008
#define EXT_OR_PORT_AUTH_COOKIE_HEADER 99,3088
#define EXT_OR_PORT_AUTH_HASH_LEN 101,3211
#define EXT_OR_PORT_AUTH_NONCE_LEN 103,3305
#define EXT_OR_PORT_AUTH_SERVER_TO_CLIENT_CONST 105,3382
#define EXT_OR_PORT_AUTH_CLIENT_TO_SERVER_CONST 107,3483
#define EXT_OR_AUTHTYPE_SAFECOOKIE 111,3630
STATIC int ext_or_auth_cookie_is_set 115,3759
STATIC uint8_t *ext_or_auth_cookie ext_or_auth_cookie119,4010
get_ext_or_auth_cookie_file_name(124,4183
init_ext_or_cookie_authentication(139,4663
connection_ext_or_auth_neg_auth_type(167,5630
handle_client_auth_nonce(189,6139
connection_ext_or_auth_handle_client_nonce(298,10432
#define connection_ext_or_auth_send_result_success(340,11874
#define connection_ext_or_auth_send_result_fail(342,11974
connection_ext_or_auth_send_result(348,12211
connection_ext_or_auth_handle_client_hash(364,12754
connection_ext_or_auth_process_inbuf(393,13731
#define EXT_OR_CMD_TB_DONE 426,14807
#define EXT_OR_CMD_TB_USERADDR 427,14841
#define EXT_OR_CMD_TB_TRANSPORT 428,14879
#define EXT_OR_CMD_BT_OKAY 431,14973
#define EXT_OR_CMD_BT_DENY 432,15007
#define EXT_OR_CMD_BT_CONTROL 433,15041
connection_ext_or_handle_cmd_useraddr(443,15372
connection_ext_or_handle_cmd_transport(505,17098
#define EXT_OR_CONN_STATE_IS_AUTHENTICATING(532,17869
connection_ext_or_process_inbuf(537,18024
connection_ext_or_finished_flushing(621,20712
connection_ext_or_start_auth(633,21059
ext_orport_free_all(654,21644

fp_pair.c,588
struct fp_pair_map_entry_s 25,777
  HT_ENTRY(26,806
struct fp_pair_map_s 31,878
  HT_HEAD(32,901
fp_pair_map_entry_hash(49,1345
HT_PROTOTYPE(59,1554
fp_pair_map_set(83,2221
fp_pair_map_set_by_digests(114,2998
fp_pair_map_get(133,3423
fp_pair_map_get_by_digests(154,3878
fp_pair_map_remove(175,4404
fp_pair_map_free(199,4933
fp_pair_map_isempty(221,5460
fp_pair_map_size(232,5612
fp_pair_map_iter_init(243,5791
fp_pair_map_iter_next(255,6021
fp_pair_map_iter_next_rmv(268,6330
fp_pair_map_iter_get(287,6686
fp_pair_map_iter_done(301,7024
fp_pair_map_assert_ok(311,7194

geoip.c,3750
#define GEOIP_PRIVATE30,1263
typedef struct geoip_ipv4_entry_t 42,1539
  uint32_t ip_low;43,1575
  uint32_t ip_high;44,1644
  intptr_t country;45,1715
} geoip_ipv4_entry_t;46,1773
typedef struct geoip_ipv6_entry_t 49,1871
  struct in6_addr ip_low;50,1907
  struct in6_addr ip_high;51,1983
  intptr_t country;52,2061
} geoip_ipv6_entry_t;53,2119
typedef struct geoip_country_t 56,2197
  char countrycode[countrycode57,2230
  uint32_t n_v3_ns_requests;58,2253
} geoip_country_t;59,2282
static smartlist_t *geoip_countries geoip_countries62,2335
static strmap_t *country_idxplus1_by_lc_code country_idxplus1_by_lc_code66,2551
static smartlist_t *geoip_ipv4_entries geoip_ipv4_entries69,2711
static char geoip_digest[geoip_digest72,2863
static char geoip6_digest[geoip6_digest73,2901
MOCK_IMPL(78,3088
geoip_add_entry(95,3521
geoip_parse_entry(141,5105
geoip_ipv4_compare_entries_(210,7039
geoip_ipv4_compare_key_to_entry_(224,7415
geoip_ipv6_compare_entries_(240,7872
geoip_ipv6_compare_key_to_entry_(250,8229
should_record_bridge_info(268,8804
init_geoip_countries(277,9061
geoip_load_file(310,10271
geoip_get_country_by_ipv4(384,12835
geoip_get_country_by_ipv6(400,13416
MOCK_IMPL(416,13994
MOCK_IMPL(429,14388
geoip_get_country_name(440,14664
MOCK_IMPL(450,14954
geoip_db_digest(466,15448
typedef struct clientmap_entry_t 478,15892
  HT_ENTRY(479,15927
} clientmap_entry_t;491,16407
#define MAX_LAST_SEEN_IN_MINUTES 496,16562
static HT_HEAD(499,16661
clientmap_entries_eq(515,17149
HT_PROTOTYPE(524,17396
client_history_clear(542,17912
geoip_note_client_seen(561,18481
remove_old_client_helper_(618,20555
geoip_remove_old_clients(631,20873
static uint32_t ns_v3_responses[ns_v3_responses640,21136
geoip_note_ns_response(645,21321
#define MIN_IPS_TO_NOTE_COUNTRY 661,21867
#define MIN_IPS_TO_NOTE_ANYTHING 664,22005
#define IP_GRANULARITY 667,22141
typedef struct c_hist_t 670,22229
  char country[country671,22255
  unsigned total;672,22307
} c_hist_t;673,22374
c_hist_compare_(679,22555
#define DIRREQ_TIMEOUT 693,22976
typedef struct dirreq_map_entry_t 700,23312
  HT_ENTRY(701,23348
} dirreq_map_entry_t;714,24158
static HT_HEAD(719,24345
dirreq_map_ent_hash(731,24648
HT_PROTOTYPE(738,24788
dirreq_map_get_(769,26115
geoip_start_dirreq(781,26501
geoip_change_dirreq_state(802,27340
geoip_get_transport_history(829,28175
geoip_get_dirreq_history(930,32177
#define DIR_REQ_GRANULARITY 961,33096
#define MIN_DIR_REQ_RESPONSES 976,33732
geoip_get_client_history(1037,36630
geoip_get_request_history(1132,39687
static time_t start_of_dirreq_stats_interval;1169,40865
geoip_dirreq_stats_init(1173,40960
geoip_reset_dirreq_stats(1180,41086
geoip_dirreq_stats_term(1213,42079
geoip_format_dirreq_stats(1222,42360
#define RESPONSE_GRANULARITY 1239,42868
#undef RESPONSE_GRANULARITY1244,43084
geoip_dirreq_stats_write(1285,44762
static time_t start_of_bridge_stats_interval;1316,45663
geoip_bridge_stats_init(1320,45747
geoip_bridge_stats_term(1328,45941
validate_bridge_stats(1338,46226
static char *bridge_stats_extrainfo bridge_stats_extrainfo1396,48094
geoip_format_bridge_stats(1402,48319
format_bridge_stats_controller(1438,49471
format_client_stats_heartbeat(1461,50220
geoip_bridge_stats_write(1493,51069
load_bridge_stats(1536,52412
geoip_get_bridge_stats_extrainfo(1556,52944
geoip_get_bridge_stats_controller(1565,53216
static time_t start_of_entry_stats_interval;1572,53396
geoip_entry_stats_init(1576,53478
geoip_reset_entry_stats(1583,53601
geoip_entry_stats_term(1592,53818
geoip_format_entry_stats(1601,54096
geoip_entry_stats_write(1628,54958
getinfo_helper_geoip(1658,55819
clear_geoip_db(1697,57055
geoip_free_all(1723,57804

hibernate.c,2213
#define HIBERNATE_PRIVATE30,959
static hibernate_state_t hibernate_state 45,1311
static time_t hibernate_end_time 48,1472
static time_t shutdown_time 51,1612
  UNIT_MONTH=55,1697
  UNIT_MONTH=1, UNIT_WEEK=55,1697
  UNIT_MONTH=1, UNIT_WEEK=2, UNIT_DAY=55,1697
} time_unit_t;56,1738
static uint64_t n_bytes_read_in_interval 93,3183
static uint64_t n_bytes_written_in_interval 95,3296
static uint32_t n_seconds_active_in_interval 97,3405
static int n_seconds_to_hit_soft_limit 100,3544
static time_t soft_limit_hit_at 102,3641
static uint64_t n_bytes_at_soft_limit 104,3748
static time_t interval_start_time 106,3839
static time_t interval_end_time 108,3925
static time_t interval_wakeup_time 110,4027
static uint64_t expected_bandwidth_usage 113,4176
static time_unit_t cfg_unit 115,4272
static int cfg_start_day 120,4414
hibernate_state_to_string(137,5010
accounting_parse_options(162,5783
MOCK_IMPL(276,8836
accounting_get_interval_length(287,9055
MOCK_IMPL(293,9228
accounting_add_bytes(303,9482
edge_of_accounting_period_containing(316,9990
start_of_accounting_period_containing(378,11787
start_of_accounting_period_after(386,12020
length_of_accounting_period_containing(394,12222
configure_accounting(402,12433
get_accounting_bytes(450,14398
update_expected_bandwidth(466,15007
#define MIN_TIME_FOR_MEASUREMENT 479,15548
reset_accounting(516,17215
time_to_record_bandwidth_usage(532,17760
#define NOTE_INTERVAL 535,17832
#define NOTE_BYTES 537,17890
accounting_run_housekeeping(557,18594
accounting_set_wakeup_time(572,19026
#define ROUND_UP(673,22375
accounting_record_bandwidth_usage(677,22523
#undef ROUND_UP696,23275
read_bandwidth_usage(701,23421
hibernate_hard_limit_reached(769,25774
hibernate_soft_limit_reached(780,26074
#define SOFT_LIM_PCT 783,26169
#define SOFT_LIM_BYTES 784,26196
#define SOFT_LIM_MINUTES 785,26235
hibernate_begin(812,27311
hibernate_end(856,28870
hibernate_begin_shutdown(873,29518
MOCK_IMPL(879,29663
hibernate_go_dormant(888,29856
hibernate_end_time_elapsed(938,31684
consider_hibernation(971,32787
getinfo_helper_accounting(1043,35461
on_hibernate_state_change(1109,38340
hibernate_set_state_for_testing_(1123,38759

hs_cache.c,1915
#define HS_CACHE_PRIVATE10,200
static digest256map_t *hs_cache_v3_dir;hs_cache_v3_dir29,679
remove_v3_desc_as_dir(33,780
store_v3_desc_as_dir(41,974
lookup_v3_desc_as_dir(49,1207
cache_dir_desc_free(57,1376
cache_dir_desc_free_(70,1693
cache_dir_desc_new(80,2030
cache_get_dir_entry_size(108,2771
cache_store_v3_as_dir(119,3227
cache_lookup_v3_as_dir(170,5311
cache_clean_v3_as_dir(204,6206
hs_cache_store_as_dir(253,7820
hs_cache_lookup_as_dir(290,8895
hs_cache_clean_as_dir(311,9368
static digest256map_t *hs_cache_v3_client;hs_cache_v3_client327,9878
static digest256map_t *hs_cache_client_intro_state;hs_cache_client_intro_state332,10123
cache_get_client_entry_size(336,10246
remove_v3_desc_as_client(344,10478
store_v3_desc_as_client(354,10821
lookup_v3_desc_as_client(364,11220
cache_client_desc_new(391,11912
cache_client_desc_free(422,13005
cache_client_desc_free_(436,13389
cache_intro_state_new(444,13615
cache_intro_state_free(453,13825
cache_intro_state_free_(460,13968
cache_client_intro_state_new(468,14170
cache_client_intro_state_free(477,14402
cache_client_intro_state_free_(488,14665
cache_client_intro_state_lookup(498,15003
cache_client_intro_state_note(530,15894
cache_client_intro_state_add(555,16646
cache_client_intro_state_clean(587,17751
cache_client_intro_state_is_empty(603,18222
cache_store_as_client(612,18582
cached_client_descriptor_has_expired(647,19744
cache_clean_v3_as_client(670,20572
hs_cache_lookup_as_client(711,21994
hs_cache_store_as_client(729,22415
hs_cache_clean_as_client(759,23118
hs_cache_purge_as_client(770,23471
hs_cache_client_intro_state_note(788,24186
hs_cache_client_intro_state_find(810,24963
hs_cache_client_intro_state_clean(820,25289
hs_cache_client_intro_state_purge(840,25951
hs_cache_handle_oom(859,26650
hs_cache_get_max_descriptor_size(910,28413
hs_cache_init(919,28710
hs_cache_free_all(934,29090

hs_cell.c,842
compute_introduce_mac(33,940
get_introduce2_key_material(73,2507
decrypt_introduce2(107,3760
parse_introduce2_encrypted(142,4971
build_legacy_establish_intro(193,7043
parse_introduce2_cell(221,8107
introduce1_set_encrypted_onion_key(252,9015
introduce1_set_encrypted_link_spec(269,9803
introduce1_set_encrypted_padding(289,10678
introduce1_encrypt_and_encode(312,11684
introduce1_set_encrypted(397,15206
introduce1_set_auth_key(437,16415
introduce1_set_legacy_id(452,17065
hs_cell_build_establish_intro(482,18098
hs_cell_parse_intro_established(603,22833
hs_cell_parse_introduce2(626,23652
hs_cell_build_rendezvous1(779,29878
hs_cell_build_introduce1(814,31251
hs_cell_build_establish_rendezvous(857,32529
hs_cell_parse_introduce_ack(871,32976
hs_cell_parse_rendezvous2(906,33975
hs_cell_introduce1_data_clear(936,34843

hs_circuit.c,1087
#define HS_CIRCUIT_PRIVATE8,125
circuit_purpose_is_correct_for_rend(37,831
create_rend_cpath(67,1831
create_rend_cpath_legacy(100,2854
finalize_rend_circuit(147,4353
register_intro_circ(188,5840
count_opened_desc_intro_point_circuits(209,6489
create_rp_circuit_identifier(241,7699
create_intro_circuit_identifier(281,9406
send_establish_intro(302,10149
get_service_anonymity_string(348,11736
launch_rendezvous_point_circuit(363,12259
can_relaunch_service_rendezvous_point(468,16604
retry_service_rendezvous_point(509,18138
get_lspecs_from_extend_info(562,20326
setup_introduce1_data(610,22116
hs_circ_service_get_intro_circ(647,23334
hs_circ_retry_service_rendezvous_point(682,24510
hs_circ_launch_intro_point(712,25535
hs_circ_service_intro_has_opened(762,27292
hs_circ_service_rp_has_opened(826,30025
hs_circ_handle_intro_established(892,32704
hs_circ_handle_introduce2(937,34348
hs_circuit_setup_e2e_rend_circ(1009,37142
hs_circuit_setup_e2e_rend_circ_legacy_client(1036,38076
hs_circ_send_introduce1(1065,39073
hs_circ_send_establish_rendezvous(1133,41635

hs_circuitmap.c,1366
#define HS_CIRCUITMAP_PRIVATE14,443
static struct hs_circuitmap_ht *the_hs_circuitmap the_hs_circuitmap26,848
hs_circuits_have_same_token(31,1041
hs_circuit_hash_token(63,1935
HT_PROTOTYPE(72,2182
hs_token_new(96,2993
hs_token_free(111,3366
get_circuit_with_token(123,3591
hs_circuitmap_register_impl(136,4037
hs_circuitmap_register_circuit(170,5150
hs_circuitmap_get_circuit_impl(190,5904
hs_circuitmap_get_origin_circuit(222,6983
hs_circuitmap_get_or_circuit(246,7859
hs_circuitmap_get_intro_circ_v3_relay_side(273,8697
hs_circuitmap_get_intro_circ_v2_relay_side(284,9203
hs_circuitmap_get_rend_circ_relay_side(294,9643
hs_circuitmap_register_rend_circ_relay_side(306,10047
hs_circuitmap_register_intro_circ_v2_relay_side(316,10449
hs_circuitmap_register_intro_circ_v3_relay_side(327,10866
hs_circuitmap_get_intro_circ_v3_service_side(341,11441
hs_circuitmap_get_intro_circ_v2_service_side(366,12419
hs_circuitmap_get_rend_circ_service_side(390,13315
hs_circuitmap_get_rend_circ_client_side(427,14756
hs_circuitmap_register_intro_circ_v2_service_side(463,15959
hs_circuitmap_register_intro_circ_v3_service_side(474,16386
hs_circuitmap_register_rend_circ_service_side(485,16834
hs_circuitmap_register_rend_circ_client_side(496,17261
hs_circuitmap_remove_circuit(513,17861
hs_circuitmap_init(539,18473
hs_circuitmap_free_all(549,18741

hs_client.c,1695
#define HS_CLIENT_PRIVATE9,201
fetch_status_to_string(39,899
fetch_status_should_close_socks(64,1709
cancel_descriptor_fetches(90,2452
flag_all_conn_wait_desc(116,3503
purge_hid_serv_request(143,4342
directory_request_is_pending(166,5287
close_all_socks_conns_waiting_for_desc(196,6257
retry_all_socks_conn_waiting_for_desc(239,7982
note_connection_attempt_succeeded(288,10028
directory_launch_v3_desc_fetch(311,11179
pick_hsdir_v3(363,13192
MOCK_IMPL(403,14616
intro_circ_is_ok(424,15319
find_desc_intro_point_by_ident(451,16157
find_desc_intro_point_by_legacy_id(475,16909
send_introduce1(513,18283
setup_intro_circ_auth_key(611,22175
client_intro_circ_has_opened(645,23220
client_rendezvous_circ_has_opened(662,23807
desc_intro_point_to_extend_info(699,25142
intro_point_is_usable(732,26477
client_get_random_intro(772,27828
close_or_reextend_intro_circ(881,32240
handle_introduce_ack_success(933,34101
handle_introduce_ack_bad(979,35906
handle_introduce_ack(1002,36912
handle_rendezvous2(1042,38190
can_client_refetch_desc(1105,40443
hs_client_note_connection_attempt_succeeded(1174,42839
hs_client_decode_descriptor(1198,43697
hs_client_any_intro_points_usable(1247,45396
hs_client_refetch_hsdesc(1270,46052
hs_client_send_introduce1(1301,47196
hs_client_circuit_has_opened(1313,47721
hs_client_receive_rendezvous_acked(1343,48588
hs_client_desc_has_arrived(1386,50238
hs_client_get_random_intro_from_edge(1451,52810
hs_client_receive_introduce_ack(1463,53286
hs_client_receive_rendezvous2(1492,54314
hs_client_reextend_intro_circuit(1530,55852
hs_client_free_all(1573,57332
hs_client_purge_state(1582,57574
hs_client_dir_info_changed(1602,58192

hs_common.c,2597
#define HS_COMMON_PRIVATE12,374
static const char *str_ed25519_basepoint str_ed25519_basepoint39,985
add_unix_port(52,1492
set_unix_port(66,1872
set_unix_port(82,2234
add_unix_port(90,2365
compare_digest_to_fetch_hsdir_index(102,2631
compare_digest_to_store_first_hsdir_index(112,2948
compare_digest_to_store_second_hsdir_index(123,3319
compare_node_fetch_hsdir_index(133,3664
compare_node_store_first_hsdir_index(144,3996
compare_node_store_second_hsdir_index(155,4346
hs_path_from_filename(167,4781
hs_check_service_private_dir(188,5495
get_time_period_length(214,6148
hs_get_time_period_num(240,7337
hs_get_next_time_period_num(275,8647
hs_get_previous_time_period_num(284,8919
hs_get_start_time_of_next_time_period(293,9182
rend_data_alloc(309,9869
rend_data_free(332,10294
rend_data_dup(357,10894
compute_desc_id(390,11709
rend_data_service_create(432,12964
rend_data_client_create(464,14215
rend_data_get_address(499,15247
rend_data_get_desc_id(517,15782
rend_data_get_pk_digest(539,16438
compute_disaster_srv(561,17045
static uint8_t cached_disaster_srv[cached_disaster_srv598,18377
static uint64_t cached_time_period_nums[cached_time_period_nums599,18431
get_disaster_srv(605,18697
get_first_cached_disaster_srv(632,19558
get_second_cached_disaster_srv(639,19716
build_blinded_key_param(657,20298
build_hs_checksum(706,22268
build_hs_address(733,23273
hs_parse_address_impl(756,24178
hs_get_subcredential(786,25097
hs_set_conn_addr_port(826,26809
hs_parse_address(881,28651
hs_address_is_valid(916,29776
hs_build_address(961,31307
hs_link_specifier_dup(984,32036
hs_build_blinded_pubkey(1005,32906
hs_build_blinded_keypair(1029,33834
MOCK_IMPL(1064,35534
hs_service_requires_uptime_circ(1094,36327
hs_build_hs_index(1115,37065
hs_build_hsdir_index(1156,38602
hs_get_current_srv(1195,40123
hs_get_previous_srv(1213,40714
hs_get_hsdir_n_replicas(1230,41205
hs_get_hsdir_spread_fetch(1240,41528
hs_get_hsdir_spread_store(1250,41859
node_has_hsdir_index(1260,42240
hs_get_responsible_hsdirs(1303,43823
hs_hsdir_requery_period(1409,48233
static strmap_t *last_hid_serv_requests_ last_hid_serv_requests_1434,49212
get_last_hid_serv_requests(1439,49369
hs_lookup_last_hid_serv_request(1452,49906
hs_clean_last_hid_serv_requests(1486,51114
hs_purge_hid_serv_from_last_hid_serv_requests(1515,52065
hs_purge_last_hid_serv_requests(1556,53636
hs_pick_hsdir(1583,54732
hs_get_extend_info_from_lspecs(1649,57230
hs_init(1741,60320
hs_free_all(1751,60517
hs_dec_rdv_stream_counter(1762,60783
hs_inc_rdv_stream_counter(1779,61258

hs_config.c,355
#define HS_CONFIG_PRIVATE26,1008
stage_services(43,1658
service_is_duplicate_in_list(74,2991
helper_parse_uint64(122,4784
config_has_invalid_options(152,5752
    const char **list;list173,6453
config_validate_service(213,7780
config_service_v3(239,8642
config_generic_service(300,10654
config_service(457,16178
hs_config_service_all(527,18745

hs_descriptor.c,3496
#define HS_DESCRIPTOR_PRIVATE56,2925
#define str_hs_desc 69,3283
#define str_desc_cert 70,3319
#define str_rev_counter 71,3371
#define str_superencrypted 72,3414
#define str_encrypted 73,3458
#define str_signature 74,3492
#define str_lifetime 75,3526
#define str_create2_formats 77,3639
#define str_intro_auth_required 78,3685
#define str_single_onion 79,3739
#define str_intro_point 80,3787
#define str_ip_onion_key 81,3832
#define str_ip_auth_key 82,3869
#define str_ip_enc_key 83,3904
#define str_ip_enc_key_cert 84,3937
#define str_ip_legacy_key 85,3980
#define str_ip_legacy_key_cert 86,4019
#define str_intro_point_start 87,4068
#define str_enc_const_superencryption 90,4214
#define str_enc_const_encryption 91,4280
#define str_desc_sig_prefix 93,4395
#define str_desc_auth_type 94,4461
#define str_desc_auth_key 95,4505
#define str_desc_auth_client 96,4557
#define str_encrypted 97,4600
  hs_desc_auth_type_t type;101,4695
  const char *identifier;identifier102,4723
} intro_auth_types[intro_auth_types103,4749
static token_rule_t hs_desc_v3_token_table[hs_desc_v3_token_table110,4888
static token_rule_t hs_desc_superencrypted_v3_token_table[hs_desc_superencrypted_v3_token_table121,5362
static token_rule_t hs_desc_encrypted_v3_token_table[hs_desc_encrypted_v3_token_table130,5740
static token_rule_t hs_desc_intro_point_v3_token_table[hs_desc_intro_point_v3_token_table138,6088
desc_plaintext_data_free_contents(151,6691
desc_encrypted_data_free_contents(167,7028
build_mac(189,7680
build_secret_input(221,8950
build_kdf_key(246,9939
build_secret_key_iv_mac(285,11353
encode_link_specifiers(320,12571
encode_legacy_key(367,14141
encode_enc_key(404,15371
encode_onion_key(432,16123
encode_intro_point(452,16647
compute_padded_plaintext_length(522,18514
build_plaintext_padding(543,19413
build_encrypted(566,20130
encrypt_descriptor_data(612,21965
get_fake_auth_client_str(676,24478
#define FILL_WITH_FAKE_DATA_AND_BASE64(687,24873
#undef FILL_WITH_FAKE_DATA_AND_BASE64708,25724
#define CLIENT_AUTH_ENTRIES_BLOCK_SIZE 714,25872
get_fake_auth_client_lines(720,26104
get_inner_encrypted_layer_plaintext(751,27264
get_outer_encrypted_layer_plaintext(808,29384
encrypt_desc_data_and_base64(869,31611
encode_superencrypted_data(898,32863
desc_encode_v3(955,34475
decode_link_specifiers(1067,38352
decode_auth_type(1151,41059
decode_create2_list(1178,41886
cert_is_valid(1215,42968
cert_parse_and_validate(1251,44224
encrypted_data_length_is_valid(1285,45005
MOCK_IMPL(1306,45864
superencrypted_auth_data_is_valid(1407,49308
decode_superencrypted(1448,50564
desc_decrypt_all(1506,52471
decode_intro_legacy_key(1566,54611
set_intro_point_onion_key(1623,56858
decode_introduction_point(1668,58342
decode_intro_points(1795,62690
desc_sig_is_valid(1856,64862
desc_decode_plaintext_v3(1920,67144
desc_decode_encrypted_v3(2019,70732
hs_desc_decode_encrypted(2129,74235
hs_desc_decode_plaintext(2180,75961
hs_desc_decode_descriptor(2256,78595
MOCK_IMPL(2320,80228
hs_desc_plaintext_data_free(2361,81312
hs_desc_encrypted_data_free(2369,81492
hs_descriptor_free(2377,81663
hs_desc_plaintext_obj_size(2393,82146
hs_desc_encrypted_obj_size(2403,82446
hs_desc_obj_size(2423,83014
hs_desc_intro_point_new(2433,83328
hs_desc_intro_point_free(2442,83526
hs_desc_link_specifier_free(2461,84035
hs_desc_link_specifier_new(2472,84307
hs_descriptor_clear_intro_points(2524,85622
hs_desc_lspec_to_trunnel(2542,86112

hs_ident.c,288
hs_ident_circuit_new(15,380
hs_ident_circuit_free(28,840
hs_ident_circuit_dup(40,1121
hs_ident_dir_conn_dup(50,1429
hs_ident_dir_conn_free(59,1665
hs_ident_dir_conn_init(72,2015
hs_ident_edge_conn_new(87,2534
hs_ident_edge_conn_free(96,2795
hs_ident_intro_circ_is_valid(107,3041

hs_intropoint.c,611
#define HS_INTROPOINT_PRIVATE9,203
get_auth_key_from_cell(35,825
verify_establish_intro_cell(72,2065
MOCK_IMPL(146,4939
handle_verified_establish_intro_cell(184,6328
handle_establish_intro(211,7402
circuit_is_suitable_intro_point(271,9230
hs_intro_circuit_is_suitable_for_establish_intro(296,9903
hs_intro_received_establish_intro(304,10208
send_introduce_ack_cell(340,11447
validate_introduce1_parsed_cell(382,13214
handle_introduce1(431,15021
introduce1_cell_is_legacy(518,18533
circuit_is_suitable_for_introduce1(535,18969
hs_intro_received_introduce1(559,19670
hs_intropoint_clear(602,21148

hs_ntor.c,971
#define PROTOID 31,1329
#define PROTOID_LEN 32,1381
#define SERVER_STR 33,1423
#define SERVER_STR_LEN 34,1451
#define T_HSENC 37,1552
#define T_HSENC_LEN 38,1594
#define T_HSVERIFY 39,1636
#define T_HSMAC 40,1676
#define M_HSEXPAND 41,1710
#define M_HSEXPAND_LEN 42,1754
#define APPEND(48,2036
#define REND_SECRET_HS_INPUT_LEN 55,2319
#define REND_AUTH_INPUT_LEN 58,2527
get_rendezvous1_key_material(79,3560
#define INTRO_SECRET_HS_INPUT_LEN 146,6296
#define INFO_BLOB_LEN 149,6489
#define KDF_INPUT_LEN 151,6611
get_introduce1_key_material(169,7426
get_intro_secret_hs_input(225,9452
get_rend_secret_hs_input(265,11020
hs_ntor_client_get_introduce1_keys(316,13173
hs_ntor_client_get_rendezvous1_keys(377,15642
hs_ntor_service_get_introduce1_keys(449,18731
hs_ntor_service_get_rendezvous1_keys(510,21173
hs_ntor_client_rendezvous2_mac_is_good(568,23612
#define NTOR_KEY_EXPANSION_KDF_INPUT_LEN 580,24001
hs_ntor_circuit_key_expansion(589,24403

hs_service.c,4794
#define HS_SERVICE_PRIVATE9,195
#define FOR_EACH_SERVICE_BEGIN(46,1057
#define FOR_EACH_SERVICE_END 51,1334
#define FOR_EACH_DESCRIPTOR_BEGIN(56,1582
#define FOR_EACH_DESCRIPTOR_END 64,2084
static const char fname_keyfile_prefix[fname_keyfile_prefix67,2172
static const char fname_hostname[fname_hostname68,2229
static const char address_tld[address_tld69,2278
static smartlist_t *hs_service_staging_list;hs_service_staging_list75,2623
static int consider_republishing_hs_descriptors 80,2850
hs_service_ht_eq(88,3201
hs_service_ht_hash(100,3635
static struct hs_service_ht *hs_service_map;hs_service_map110,4042
HT_PROTOTYPE(113,4127
register_service(142,5434
remove_service(160,5992
set_service_default_config(184,6622
service_clear_config(203,7203
describe_intro_point(223,7788
get_intro_point_min_introduce2(252,8747
get_intro_point_max_introduce2(265,9254
get_intro_point_min_lifetime(277,9728
#define MIN_INTRO_POINT_LIFETIME_TESTING 279,9765
get_intro_point_max_lifetime(294,10328
#define MAX_INTRO_POINT_LIFETIME_TESTING 296,10365
get_intro_point_num_extra(311,10910
ht_free_service_(322,11338
service_free_all(334,11721
service_intro_point_free(355,12333
service_intro_point_free_(371,12804
service_intro_point_new(387,13492
service_intro_point_add(476,16436
service_intro_point_remove(491,16914
service_intro_point_find(509,17611
service_desc_find_by_intro(540,18656
get_objects_from_ident(566,19476
get_link_spec_by_type(597,20510
get_node_from_intro_point(619,21102
get_extend_info_from_intro_point(638,21750
count_desc_circuit_established(665,22589
close_directory_connections(682,23023
close_service_rp_circuits(716,24329
close_intro_circuits(746,25619
close_service_intro_circuits(764,26280
close_service_circuits(775,26549
move_ephemeral_services(793,27119
service_escaped_dir(823,28239
move_hs_state(832,28566
register_all_services(852,29308
write_address_to_file(919,32071
load_service_keys(962,33390
service_descriptor_free(1030,35898
service_descriptor_new(1050,36563
move_descriptors(1064,37068
remove_expired_failing_intro(1091,37772
setup_intro_point_exclude_list(1110,38419
remember_failing_intro_point(1129,39030
link_specifier_copy(1150,39721
setup_desc_intro_point(1164,40169
build_desc_intro_points(1248,43539
build_service_desc_encrypted(1277,44636
build_service_desc_plaintext(1307,45685
build_service_desc_keys(1353,47450
build_service_descriptor(1394,48986
build_descriptors_for_new_service(1443,50476
build_all_descriptors(1495,52815
pick_intro_point(1538,54797
pick_needed_intro_points(1602,57320
service_desc_clear_previous_hsdirs(1679,60554
service_desc_note_upload(1691,60869
service_desc_schedule_upload(1708,61372
update_service_descriptor(1728,61963
update_all_descriptors(1769,63744
intro_point_should_expire(1783,64264
cleanup_intro_points(1816,65249
set_rotation_time(1867,67616
should_rotate_descriptors(1894,68466
rotate_service_descriptors(1919,69018
rotate_all_descriptors(1940,69850
run_housekeeping_event(1973,71208
run_build_descriptor_event(2008,72764
launch_intro_point_circuits(2030,73568
get_max_intro_circ_per_period(2080,75579
#define MAX_INTRO_POINT_CIRCUIT_RETRIES_TESTING 2092,75997
can_service_launch_intro_circuit(2123,77268
run_build_circuit_event(2168,78873
upload_descriptor_to_hsdir(2199,79980
encode_desc_rev_counter_for_state(2280,83135
update_revision_counters_in_state(2306,84039
check_state_line_for_service_rev_counter(2342,85338
get_rev_counter_for_service(2405,87326
increment_descriptor_revision_counter(2437,88306
set_descriptor_revision_counter(2458,89207
upload_descriptor_to_all(2472,89754
service_desc_hsdirs_changed(2532,92386
should_service_upload_descriptor(2570,93689
run_upload_descriptor_event(2627,95442
service_intro_circ_has_opened(2675,97339
service_rendezvous_circ_has_opened(2732,99067
service_handle_intro_established(2775,100715
service_handle_introduce2(2832,102899
service_add_fnames_to_list(2880,104541
hs_service_get_num_services(2905,105317
hs_service_intro_circ_has_closed(2916,105561
hs_service_set_conn_addr_port(2970,107401
#define MAX_STREAM_WARN_INTERVAL 2999,108568
hs_service_lists_fnames_for_sandbox(3051,110774
hs_service_dir_info_changed(3076,111675
hs_service_receive_introduce2(3091,112287
hs_service_receive_intro_established(3121,113191
hs_service_circuit_has_opened(3157,114284
hs_service_load_all_keys(3186,115068
hs_service_stage_services(3224,116269
hs_service_new(3241,116918
hs_service_free(3259,117603
hs_service_run_scheduled_events(3288,118421
hs_service_init(3309,119170
hs_service_free_all(3326,119577
get_hs_service_map_size(3336,119766
get_hs_service_staging_list_size(3343,119906
get_hs_service_map(3349,120022
get_first_service(3355,120099

keypin.c,622
#define KEYPIN_PRIVATE11,237
static HT_HEAD(74,2470
keypin_ent_hash_rsa(87,2971
keypin_ents_eq_ed(95,3210
keypin_ent_hash_ed(102,3456
HT_PROTOTYPE(107,3573
keypin_check(142,5036
keypin_check_and_add_impl(152,5281
MOCK_IMPL(204,6982
keypin_add_or_replace_entry_in_map(219,7387
keypin_check_lone_rsa(269,9018
static int keypin_journal_fd 285,9425
keypin_open_journal(290,9568
keypin_close_journal(322,10280
#define JOURNAL_LINE_LEN 331,10485
keypin_journal_append_entry(336,10673
keypin_load_journal_impl(361,11489
keypin_load_journal(434,13249
keypin_parse_journal_line(454,13800
keypin_clear(473,14376

main.c,7288
#define MAIN_PRIVATE49,1975
#   define __INCLUDE_LEVEL__ 124,3713
int global_read_bucket;145,4570
int global_write_bucket;146,4646
int global_relayed_read_bucket;149,4804
int global_relayed_write_bucket;151,4916
static int stats_prev_global_read_bucket;154,5079
static int stats_prev_global_write_bucket;157,5255
static uint64_t stats_prev_n_read 160,5330
static uint64_t stats_prev_n_written 162,5403
static uint64_t stats_n_bytes_read 166,5591
static uint64_t stats_n_bytes_written 168,5699
time_t time_of_process_start 170,5786
long stats_n_seconds_working 172,5866
#define MAX_SIGNEWNYM_RATE 175,5952
static time_t time_of_last_signewnym 177,6035
static int signewnym_is_pending 179,6148
static unsigned newnym_epoch 181,6230
STATIC smartlist_t *connection_array connection_array184,6307
static smartlist_t *closeable_connection_lst closeable_connection_lst187,6470
static smartlist_t *active_linked_connection_lst active_linked_connection_lst190,6638
static int called_loop_once 194,6878
static int can_complete_circuits 202,7239
#define GREEDY_DESCRIPTOR_RETRY_INTERVAL 206,7397
#define LAZY_DESCRIPTOR_RETRY_INTERVAL 209,7558
int quiet_level 215,7800
have_completed_a_circuit(230,8307
note_that_we_completed_a_circuit(238,8519
note_that_we_maybe_cant_complete_circuits(246,8735
connection_add_impl(256,8993
connection_unregister_events(287,10069
connection_remove(309,10762
connection_unlink(352,12035
init_connection_lists(392,13594
add_connection_to_closeable_list(404,13910
connection_is_on_closeable_list(414,14233
connection_in_array(421,14413
MOCK_IMPL(429,14608
MOCK_IMPL(439,14836
MOCK_IMPL(446,14944
connection_watch_events(456,15168
connection_is_reading(471,15525
connection_check_event(483,15902
MOCK_IMPL(520,17231
MOCK_IMPL(542,17845
connection_is_writing(566,18515
MOCK_IMPL(575,18778
MOCK_IMPL(598,19436
connection_should_read_from_linked_conn(627,20433
tell_event_loop_to_finish(642,20883
connection_start_reading_from_linked_conn(655,21346
connection_stop_reading_from_linked_conn(676,22101
close_closeable_connections(694,22685
MOCK_IMPL(709,23110
conn_read_callback(728,23599
conn_write_callback(760,24528
conn_close_if_marked(804,26147
directory_all_unreachable_cb(920,31216
static struct event *directory_all_unreachable_cb_event directory_all_unreachable_cb_event942,31968
directory_all_unreachable(951,32371
directory_info_has_arrived(970,32918
run_connection_housekeeping(1011,34352
signewnym_impl(1137,39468
get_signewnym_epoch(1159,39999
static int periodic_events_initialized 1166,40174
#undef CALLBACK1169,40269
#define CALLBACK(1170,40285
#undef CALLBACK1202,41255
#define CALLBACK(1205,41351
static periodic_event_item_t periodic_events[periodic_events1207,41396
#undef CALLBACK1239,42416
static periodic_event_item_t *check_descriptor_event=check_descriptor_event1245,42721
static periodic_event_item_t *fetch_networkstatus_event=fetch_networkstatus_event1246,42780
static periodic_event_item_t *launch_descriptor_fetches_event=launch_descriptor_fetches_event1247,42842
static periodic_event_item_t *check_dns_honesty_event=check_dns_honesty_event1248,42910
reset_all_main_loop_timers(1256,43212
find_periodic_event(1268,43508
initialize_periodic_events_cb(1284,43954
initialize_periodic_events(1298,44309
#define NAMED_CALLBACK(1308,44535
teardown_periodic_events(1323,44995
reschedule_descriptor_update_check(1337,45314
reschedule_directory_downloads(1348,45563
#define LONGEST_TIMER_PERIOD 1357,45812
safe_timer_diff(1361,46010
run_scheduled_events(1384,46759
rotate_onion_key_callback(1499,50690
check_onion_keys_expiry_time_callback(1527,51643
check_ed_keys_callback(1549,52291
launch_descriptor_fetches_callback(1572,52943
rotate_x509_certificate_callback(1590,53445
add_entropy_callback(1624,54471
#define ENTROPY_INTERVAL 1635,54857
launch_reachability_tests_callback(1644,55050
downrate_stability_callback(1659,55498
save_stability_callback(1674,55989
#define SAVE_STABILITY_INTERVAL 1681,56220
check_authority_cert_callback(1690,56455
#define CHECK_V3_CERTIFICATE_INTERVAL 1697,56725
check_expired_networkstatus_callback(1706,56930
#define NS_EXPIRY_SLOP 1714,57361
#define CHECK_EXPIRED_NS_INTERVAL 1719,57526
write_stats_file_callback(1727,57688
#define CHECK_WRITE_STATS_INTERVAL 1731,57822
#define CHANNEL_CHECK_INTERVAL 1773,59521
check_canonical_channels_callback(1775,59571
reset_padding_counts_callback(1785,59780
record_bridge_stats_callback(1799,60117
clean_caches_callback(1829,61078
#define CLEAN_CACHES_INTERVAL 1837,61410
rend_cache_failure_clean_callback(1846,61588
retry_dns_callback(1861,62076
#define RETRY_DNS_INTERVAL 1864,62151
check_descriptor_callback(1873,62421
#define CHECK_DESCRIPTOR_INTERVAL 1878,62667
check_for_reachability_bw_callback(1904,63528
#define BANDWIDTH_RECHECK_INTERVAL 1932,64784
fetch_networkstatus_callback(1944,65109
retry_listeners_callback(1970,66145
expire_old_ciruits_serverside_callback(1985,66486
check_dns_honesty_callback(1998,66835
write_bridge_ns_callback(2024,67513
#define BRIDGE_STATUSFILE_INTERVAL 2029,67725
check_fw_helper_app_callback(2039,67938
#define PORT_FORWARDING_CHECK_INTERVAL 2049,68213
heartbeat_callback(2069,68859
#define CDM_CLEAN_CALLBACK_INTERVAL 2094,69427
clean_consdiffmgr_callback(2096,69478
hs_service_callback(2110,69772
static periodic_timer_t *second_timer second_timer2129,70248
static int n_libevent_errors 2131,70374
second_elapsed_callback(2135,70474
#define NUM_JUMPED_SECONDS_BEFORE_WARN 2207,73481
static periodic_timer_t *systemd_watchdog_timer systemd_watchdog_timer2220,73903
systemd_watchdog_callback(2224,74033
static periodic_timer_t *refill_timer refill_timer2233,74245
refill_callback(2238,74399
got_libevent_error(2286,75886
#define UPTIME_CUTOFF_FOR_NEW_BANDWIDTH_TEST 2296,76080
ip_address_changed(2302,76341
dns_servers_relaunch_checks(2336,77396
do_hup(2350,77778
do_main_loop(2434,80638
run_main_loop_once(2606,85975
run_main_loop_until_done(2681,88700
signal_callback(2693,88927
process_signal(2705,89175
MOCK_IMPL(2784,91239
dumpmemusage(2794,91387
dumpstats(2808,91860
exit_function(2916,96180
#define UNIX_ONLY 2926,96387
#define UNIX_ONLY 2928,96413
  int signal_value;2931,96456
  int try_to_register;2932,96476
  struct event *signal_event;signal_event2933,96499
} signal_handlers[signal_handlers2934,96529
handle_signals(2968,97462
activate_signal(3011,98895
tor_init(3025,99210
static tor_lockfile_t *lockfile lockfile3170,103809
try_locking(3178,104150
have_lockfile(3214,105094
release_lockfile(3221,105218
tor_free_all(3238,105804
tor_cleanup(3308,107429
do_list_fingerprint(3358,109067
do_hash_password(3389,109941
do_dump_config(3407,110516
init_addrinfo(3435,111139
sandbox_init_filter(3452,111542
#define OPEN(3461,111755
#define OPEN_DATADIR(3464,111864
#define OPEN_DATADIR2(3467,111980
#define OPEN_DATADIR_SUFFIX(3470,112117
#define OPEN_DATADIR2_SUFFIX(3475,112282
#define RENAME_SUFFIX(3524,114118
#define RENAME_SUFFIX2(3529,114285
#define STAT_DATADIR(3556,115470
#define STAT_DATADIR2(3559,115586
tor_main(3710,121328
#define HeapEnableTerminationOnCorruption 3716,121438
    typedef BOOL (WINAPI 3725,121855

microdesc.c,968
struct microdesc_cache_t 29,829
  HT_HEAD(32,944
microdesc_eq_(66,1998
HT_PROTOTYPE(71,2106
static microdesc_cache_t *the_microdesc_cache the_microdesc_cache124,3840
get_microdesc_cache(128,3994
get_microdesc_cache_noload(140,4316
microdescs_add_to_cache(170,5659
microdescs_add_list_to_cache(260,9331
microdesc_cache_clear(342,11624
microdesc_cache_reload(371,12518
#define TOLERATE_MICRODESC_AGE 416,13843
microdesc_cache_clean(425,14260
should_rebuild_md_cache(516,17672
microdesc_wipe_body(538,18356
microdesc_cache_rebuild(558,18896
microdesc_check_counts(697,23270
microdesc_free_(719,23856
microdesc_free_all(784,26080
microdesc_cache_lookup_by_digest256(797,26462
microdesc_list_missing_digest256(812,27056
update_microdesc_downloads(845,28421
update_microdescs_from_networkstatus(884,29588
we_use_microdescriptors_for_circuits(906,30266
we_fetch_microdescriptors(915,30551
we_fetch_router_descriptors(926,30857
MOCK_IMPL(936,31165

networkstatus.c,4779
#define NETWORKSTATUS_PRIVATE39,1886
STATIC networkstatus_t *current_ns_consensus current_ns_consensus72,2673
STATIC networkstatus_t *current_md_consensus current_md_consensus76,2824
typedef struct consensus_waiting_for_certs_t 80,3001
  networkstatus_t *consensus;consensus82,3079
  char *body;body84,3172
  time_t set_at;88,3414
  int dl_failed;91,3536
} consensus_waiting_for_certs_t;92,3553
       consensus_waiting_for_certs[consensus_waiting_for_certs98,3809
static time_t time_to_download_next_consensus[time_to_download_next_consensus103,4068
static download_status_t consensus_dl_status[consensus_dl_status105,4200
#define N_CONSENSUS_BOOTSTRAP_SCHEDULES 113,4536
#define CONSENSUS_BOOTSTRAP_SOURCE_AUTHORITY 114,4578
#define CONSENSUS_BOOTSTRAP_SOURCE_ANY_DIRSERVER 115,4625
              consensus_bootstrap_dl_status[consensus_bootstrap_dl_status124,5134
static int have_warned_about_old_version 135,5662
static int have_warned_about_new_version 138,5820
networkstatus_reset_warnings(150,6429
networkstatus_reset_download_failures(163,6799
networkstatus_read_cached_consensus_impl(182,7353
networkstatus_read_cached_consensus(208,8111
router_reload_consensus_networkstatus(218,8411
vote_routerstatus_free(257,9682
routerstatus_free(275,10089
document_signature_free(285,10248
document_signature_dup(293,10423
networkstatus_vote_free(303,10706
networkstatus_get_voter_by_id(381,13171
networkstatus_check_document_signature(397,13760
networkstatus_check_consensus_signature(450,16058
#define NETWORKSTATUS_ALLOW_SKEW 627,22508
compare_digest_to_routerstatus_entry(632,22696
compare_digest_to_vote_routerstatus_entry(642,23045
networkstatus_vote_find_mutable_entry(652,23399
networkstatus_vote_find_entry(661,23736
networkstatus_vote_find_entry_idx(671,24121
MOCK_IMPL(681,24525
router_get_consensus_status_by_descriptor_digest(705,25406
router_get_descriptor_digests_in_consensus(714,25797
MOCK_IMPL(736,26425
MOCK_IMPL(751,26787
router_get_mutable_consensus_status_by_id(766,27232
router_get_consensus_status_by_id(779,27726
#define AUTHORITY_NS_CACHE_INTERVAL 786,27938
#define NONAUTHORITY_NS_CACHE_INTERVAL 790,28085
we_want_to_fetch_flavor(798,28436
we_want_to_fetch_unknown_auth_certs(826,29428
#define DELAY_WHILE_FETCHING_CERTS 844,30025
#define MIN_DELAY_FOR_FETCH_CERT_STATUS_FAILURE 848,30207
check_consensus_waiting_for_certs(856,30592
update_consensus_networkstatus_downloads(887,31535
update_consensus_bootstrap_attempt_downloads(976,34928
update_consensus_bootstrap_multiple_downloads(1020,36839
networkstatus_consensus_download_failed(1066,38706
#define CONSENSUS_MIN_SECONDS_BEFORE_CACHING 1080,39239
update_consensus_networkstatus_fetch_time_impl(1085,39405
update_consensus_networkstatus_fetch_time(1179,43444
should_delay_dir_fetches(1197,44003
update_networkstatus_downloads(1235,44920
update_certificate_downloads(1247,45252
consensus_is_waiting_for_certs(1265,45833
MOCK_IMPL(1274,46104
MOCK_IMPL(1291,46606
MOCK_IMPL(1305,46981
MOCK_IMPL(1319,47326
MOCK_IMPL(1330,47642
MOCK_IMPL(1345,48013
networkstatus_is_live(1358,48332
networkstatus_consensus_reasonably_live(1369,48641
networkstatus_valid_until_is_reasonably_live(1382,49068
#define REASONABLY_LIVE_TIME 1385,49192
networkstatus_get_reasonably_live_consensus(1395,49599
MOCK_IMPL(1415,50447
networkstatus_consensus_can_use_multiple_directories(1441,51371
MOCK_IMPL(1451,51787
networkstatus_consensus_is_already_downloading(1469,52643
routerstatus_has_changed(1504,54162
notify_control_networkstatus_changed(1531,55289
notify_networkstatus_changed(1567,56486
networkstatus_copy_old_consensus_info(1577,56851
networkstatus_set_current_consensus_from_ns(1609,58156
any_client_port_set(1641,59138
handle_missing_protocol_warning_impl(1656,59571
handle_missing_protocol_warning(1682,60422
networkstatus_set_current_consensus(1716,61898
#define EARLY_CONSENSUS_NOTICE_SKEW 1995,72226
networkstatus_note_certs_arrived(2032,73464
routers_update_all_from_networkstatus(2058,74443
routers_update_status_from_consensus_networkstatus(2122,77266
signed_descs_update_status_from_consensus_networkstatus(2167,78996
networkstatus_getinfo_helper_single(2194,79866
networkstatus_getinfo_by_purpose(2207,80414
networkstatus_dump_bridge_status_to_file(2247,81829
get_net_param_from_list(2284,83233
MOCK_IMPL(2326,84728
networkstatus_get_overridable_param(2346,85390
networkstatus_get_weight_scale_param(2366,86158
networkstatus_get_bw_weight(2379,86745
networkstatus_get_flavor_name(2405,87595
networkstatus_parse_flavor_name(2421,87953
client_would_use_router(2435,88333
getinfo_helper_networkstatus(2460,89310
networkstatus_check_required_protocols(2543,92111
networkstatus_free_all(2588,93677

nodelist.c,3689
#define NODELIST_PRIVATE41,1809
  USABLE_DESCRIPTOR_ALL 74,2551
  USABLE_DESCRIPTOR_EXIT_ONLY 76,2624
} usable_descriptor_t;77,2658
typedef struct nodelist_t 93,3541
  smartlist_t *nodes;nodes95,3602
  HT_HEAD(97,3679
} nodelist_t;106,4126
node_id_hash(109,4168
node_id_eq(115,4293
HT_PROTOTYPE(120,4417
node_ed_id_eq(131,4776
HT_PROTOTYPE(136,4905
node_get_mutable_by_id(158,5630
node_get_mutable_by_ed25519_id(171,5991
MOCK_IMPL(186,6491
MOCK_IMPL(194,6718
node_get_or_create(207,7087
node_remove_from_ed25519_map(230,7714
node_add_to_ed25519_map(259,8411
node_set_hsdir_index(292,9351
nodelist_recompute_all_hsdir_indices(376,12432
node_addrs_changed(397,12933
nodelist_set_routerinfo(408,13242
nodelist_add_microdesc(462,14688
nodelist_set_consensus(503,15991
node_is_usable(579,18622
nodelist_remove_microdesc(587,18818
nodelist_remove_routerinfo(601,19199
nodelist_drop_node(616,19581
nodelist_find_nodes_with_microdesc(641,20268
node_free(659,20660
nodelist_purge(673,20957
nodelist_free_all(702,21682
nodelist_assert_ok(723,22223
MOCK_IMPL(800,25044
node_get_by_hex_id(812,25434
MOCK_IMPL(838,26194
node_get_ed25519_id(905,28392
node_ed25519_id_matches(943,29454
node_supports_ed25519_link_authentication(957,29953
node_supports_v3_hsdir(979,30619
node_supports_ed25519_hs_intro(1009,31497
node_supports_v3_rendezvous_point(1030,32047
node_get_rsa_id_digest(1051,32621
node_get_nickname(1059,32816
node_is_dir(1073,33099
node_has_descriptor(1093,33713
node_get_purpose(1101,33868
node_get_verbose_nickname(1113,34166
node_get_verbose_nickname_by_id(1133,34886
node_allows_single_hop_exits(1148,35366
node_exit_policy_rejects_all(1159,35665
node_exit_policy_is_exact(1177,36144
#define SL_ADD_NEW_IPV4_AP(1197,36832
#define SL_ADD_NEW_IPV6_AP(1214,37518
node_get_all_orports(1234,38252
#undef SL_ADD_NEW_IPV4_AP1266,39001
#undef SL_ADD_NEW_IPV6_AP1267,39027
node_get_addr(1272,39135
node_get_prim_addr_ipv4h(1282,39399
node_get_address_string(1299,39954
node_get_declared_uptime(1315,40372
node_get_platform(1325,40576
node_is_me(1338,40950
node_get_declared_family(1346,41164
node_has_ipv6_addr(1360,41535
node_has_ipv6_orport(1378,42046
node_has_ipv6_dirport(1387,42277
node_ipv6_or_preferred(1407,42881
#define RETURN_IPV4_AP(1424,43355
node_get_prim_orport(1437,43815
node_get_pref_orport(1460,44486
node_get_pref_ipv6_orport(1475,44875
node_ipv6_dir_preferred(1516,46480
node_get_prim_dirport(1539,47261
#undef RETURN_IPV4_AP1554,47662
node_get_pref_dirport(1559,47792
node_get_pref_ipv6_dirport(1574,48187
microdesc_has_curve25519_onion_key(1603,49355
node_has_curve25519_onion_key(1623,49725
node_set_country(1639,50141
nodelist_refresh_countries(1654,50483
addrs_in_same_network_family(1664,50795
node_nickname_matches(1675,51196
node_in_nickname_smartlist(1687,51614
nodes_in_same_family(1700,51925
nodelist_add_node_and_family(1746,53325
router_find_exact_exit_enclave(1814,55650
node_is_unreliable(1845,56641
router_exit_policy_all_nodes_reject(1860,57067
router_set_status(1881,57751
static int have_min_dir_info 1916,58918
static consensus_path_type_t have_consensus_path 1919,59008
static int need_to_update_have_min_dir_info 1924,59257
static char dir_info_status[dir_info_status1927,59391
MOCK_IMPL(1936,59877
MOCK_IMPL(1969,61253
router_dir_info_changed(1980,61573
get_dir_info_status_string(1991,61852
count_usable_descriptors(2008,62443
compute_frac_paths_available(2065,64823
count_loading_descriptors_progress(2247,71456
get_frac_paths_needed_for_circs(2274,72507
#define DFLT_PCT_USABLE_NEEDED 2277,72629
update_router_have_minimum_dir_info(2291,73159

ntmain.c,1230
#define GENSRV_SERVICENAME 30,868
#define GENSRV_DISPLAYNAME 31,902
#define GENSRV_DESCRIPTION 32,950
#define GENSRV_USERACCT 34,1036
#define NT_SERVICE_ERROR_TORINIT_FAILED 39,1315
static SERVICE_STATUS service_status;41,1383
static SERVICE_STATUS_HANDLE hStatus;42,1421
static char **backup_argv;backup_argv48,1719
static int backup_argc;49,1746
struct service_fns 65,2350
  int loaded;66,2371
  BOOL 73,2580
  BOOL 78,2766
  BOOL 81,2858
  SC_HANDLE 86,3054
  BOOL 101,3763
  SC_HANDLE 104,3849
  SC_HANDLE 109,4047
  BOOL 114,4242
  SERVICE_STATUS_HANDLE 118,4396
  BOOL 122,4578
  BOOL 125,4687
  BOOL 128,4811
  BOOL 133,5008
} service_fns 142,5415
nt_service_loadlibrary(150,5701
#define LOAD(168,6203
nt_service_is_stopping(206,7524
nt_service_set_state(226,8115
nt_service_control(234,8297
nt_service_body(259,9123
nt_service_main(304,10647
nt_service_open_scm(350,12102
nt_service_open(368,12597
nt_service_start(385,13124
nt_service_stop(424,14318
#define MAX_SERVICE_WAIT_TIME 427,14412
nt_service_command_line(471,15939
nt_service_install(524,17466
nt_service_remove(654,22265
nt_service_cmd_start(687,23158
nt_service_cmd_stop(709,23676
nt_service_parse_options(730,24114

onion.c,1612
typedef struct onion_queue_t 84,3334
  TOR_TAILQ_ENTRY(85,3365
} onion_queue_t;90,3502
#define ONIONQUEUE_WAIT_CUTOFF 93,3588
static TOR_TAILQ_HEAD(97,3727
static int ol_entries[ol_entries105,4076
have_room_for_onionskin(120,4635
onion_pending_add(183,7178
#define WARN_TOO_MANY_CIRC_CREATIONS_INTERVAL 204,7823
num_ntors_per_tap(252,9553
#define DEFAULT_NUM_NTORS_PER_TAP 254,9579
#define MIN_NUM_NTORS_PER_TAP 255,9616
#define MAX_NUM_NTORS_PER_TAP 256,9648
decide_next_handshake_type(268,10101
onion_next_task(308,11604
onion_num_pending(340,12738
onion_pending_remove(349,12967
onion_queue_entry_remove(366,13339
clear_pending_onions(392,14030
server_onion_keys_new(413,14744
server_onion_keys_free(426,15227
onion_handshake_state_release(442,15641
onion_skin_create(473,16612
onion_skin_server_handshake(532,18417
onion_skin_client_handshake(604,21154
check_create_cell(674,23554
create_cell_init(717,24566
parse_create2_payload(737,25297
#define NTOR_CREATE_MAGIC 763,26131
create_cell_parse(769,26404
check_created_cell(799,27379
created_cell_parse(823,27976
check_extend_cell(855,28965
extend_cell_from_extend1_cell_body(880,29762
create_cell_from_create2_cell_body(910,30974
extend_cell_from_extend2_cell_body(933,31743
extend_cell_parse(992,33693
check_extended_cell(1042,34931
extended_cell_parse(1062,35535
create_cell_format_impl(1105,37016
create_cell_format(1145,38115
create_cell_format_relayed(1151,38247
created_cell_format(1160,38541
should_include_ed25519_id_extend_cells(1188,39438
extend_cell_format(1205,40223
extended_cell_format(1299,43621

onion_fast.c,129
fast_handshake_state_free(35,1286
fast_onionskin_create(46,1561
fast_server_handshake(64,2303
fast_client_handshake(106,3843

onion_ntor.c,1143
#define ONION_NTOR_PRIVATE23,660
ntor_handshake_state_free(31,828
h_tweak(44,1249
typedef struct tweakset_t 53,1539
  const char *t_mac;t_mac54,1567
  const char *t_key;t_key55,1588
  const char *t_verify;t_verify56,1609
  const char *m_expand;m_expand57,1633
} tweakset_t;58,1657
static const tweakset_t proto1_tweaks 61,1721
#define PROTOID 62,1763
#define PROTOID_LEN 63,1806
#define APPEND(72,2058
onion_skin_ntor_create(86,2656
#define SERVER_STR 120,3784
#define SERVER_STR_LEN 121,3812
#define SECRET_INPUT_LEN 123,3838
#define AUTH_INPUT_LEN 126,4006
onion_skin_ntor_server_handshake(142,4804
    uint8_t secret_input[secret_input154,5391
    uint8_t auth_input[auth_input155,5435
    curve25519_public_key_t pubkey_X;156,5475
    curve25519_secret_key_t seckey_y;157,5513
    curve25519_public_key_t pubkey_Y;158,5551
    uint8_t verify[verify159,5589
onion_skin_ntor_client_handshake(247,9101
    curve25519_public_key_t pubkey_Y;258,9574
    uint8_t secret_input[secret_input259,9612
    uint8_t verify[verify260,9656
    uint8_t auth_input[auth_input261,9691
    uint8_t auth[auth262,9731

onion_tap.c,115
onion_skin_TAP_create(50,1850
onion_skin_TAP_server_handshake(102,3554
onion_skin_TAP_client_handshake(204,6918

parsecommon.c,656
#define MIN_ANNOTATION 13,275
#define MAX_ANNOTATION 14,308
#define ALLOC_ZERO(16,343
#define ALLOC(17,394
#define STRDUP(18,435
#define STRNDUP(19,480
#define RET_ERR(21,536
token_clear(32,1088
tokenize_string(44,1430
get_token_arguments(155,4921
#define MAX_ARGS 159,5104
#undef MAX_ARGS178,5578
token_check_object(187,5899
get_next_token(251,8027
#define MAX_UNPARSED_OBJECT_SIZE 256,8251
#define MAX_LINE_LENGTH 259,8414
#undef RET_ERR402,13496
#undef ALLOC403,13511
#undef ALLOC_ZERO404,13524
#undef STRDUP405,13542
#undef STRNDUP406,13556
find_by_keyword_(413,13720
find_opt_by_keyword(429,14256
find_all_by_keyword(440,14672

periodic.c,237
static const int MAX_INTERVAL 25,686
periodic_event_set_interval(30,835
periodic_event_dispatch(43,1216
periodic_event_reschedule(82,2452
periodic_event_setup(89,2621
periodic_event_launch(106,3183
periodic_event_destroy(119,3524

policies.c,4966
#define POLICIES_PRIVATE18,702
static smartlist_t *socks_policy socks_policy33,1032
static smartlist_t *dir_policy dir_policy35,1149
static smartlist_t *authdir_reject_policy authdir_reject_policy38,1295
static smartlist_t *authdir_invalid_policy authdir_invalid_policy41,1473
static smartlist_t *authdir_badexit_policy authdir_badexit_policy44,1648
static smartlist_t *reachable_or_addr_policy reachable_or_addr_policy48,1795
static smartlist_t *reachable_dir_addr_policy reachable_dir_addr_policy51,1951
typedef struct policy_summary_item_t 54,2047
    uint16_t prt_min;55,2086
    uint16_t prt_max;56,2153
    uint64_t reject_count;57,2221
    unsigned int accepted:accepted59,2349
} policy_summary_item_t;60,2421
static const char *private_nets[private_nets68,2835
policy_expand_private(89,3726
policy_expand_unspec(129,4859
parse_addr_policy(178,6621
parse_reachable_addresses(241,8581
firewall_is_fascist_impl(315,11875
firewall_is_fascist_or(330,12453
firewall_is_fascist_dir(341,12814
addr_policy_permits_tor_addr(350,13045
addr_policy_permits_address(373,13743
fascist_firewall_allows_address(396,14523
fascist_firewall_use_ipv6(435,15990
fascist_firewall_prefer_ipv6_impl(450,16614
fascist_firewall_prefer_ipv6_orport(474,17168
fascist_firewall_prefer_ipv6_dirport(496,17691
fascist_firewall_allows_address_addr(520,18418
fascist_firewall_allows_address_ap(545,19462
fascist_firewall_allows_address_ipv4h(562,20204
fascist_firewall_allows_base(581,21117
fascist_firewall_allows_ri_impl(611,22340
fascist_firewall_allows_rs_impl(628,22961
fascist_firewall_allows_rs(650,23919
fascist_firewall_allows_md_impl(674,24860
fascist_firewall_allows_node(696,25591
fascist_firewall_allows_dir_server(734,27041
fascist_firewall_choose_address_impl(757,27909
fascist_firewall_choose_address(795,29219
fascist_firewall_choose_address_base(829,30976
fascist_firewall_choose_address_ipv4h(875,32601
node_awaiting_ipv6(906,34292
fascist_firewall_choose_address_rs(928,35107
fascist_firewall_choose_address_node(970,36878
fascist_firewall_choose_address_dir_server(1021,38949
dir_policy_permits_address(1043,39839
socks_policy_permits_address(1052,40082
addr_is_in_cc_list(1060,40348
authdir_policy_permits_address(1079,40847
authdir_policy_valid_address(1090,41212
authdir_policy_badexit_address(1101,41571
#define REJECT(1108,41793
validate_addr_policies(1115,42075
#undef REJECT1183,44909
load_policy_from_option(1191,45092
policies_parse_from_options(1228,46202
single_addr_policy_eq(1254,47261
#define CMP_FIELD(1257,47342
#undef CMP_FIELD1271,47855
addr_policies_eq(1278,47968
typedef struct policy_map_ent_t 1296,48364
  HT_ENTRY(1297,48398
} policy_map_ent_t;1299,48458
static HT_HEAD(1302,48504
policy_hash(1313,48813
HT_PROTOTYPE(1334,49258
compare_known_tor_addr_to_addr_policy(1367,50363
compare_known_tor_addr_to_addr_policy_noport(1395,51457
compare_unknown_tor_addr_to_addr_policy(1438,53168
MOCK_IMPL(1488,55257
addr_policy_covers(1512,56143
addr_policy_intersects(1536,56971
append_exit_policy_string(1557,57617
addr_policy_append_reject_addr(1571,57987
tor_addr_is_public_for_reject(1594,58607
addr_policy_append_reject_addr_filter(1606,59067
addr_policy_append_reject_addr_list(1628,59777
addr_policy_append_reject_addr_list_filter(1642,60202
exit_policy_remove_redundancies(1657,60745
policies_parse_exit_policy_reject_private(1759,64366
policies_log_first_redundant_entry(1816,66566
#define DEFAULT_EXIT_POLICY 1875,68883
policies_parse_exit_policy_internal(1908,70411
policies_parse_exit_policy(1973,73145
policies_copy_addr_to_smartlist(1997,74282
policies_copy_ipv4h_to_smartlist(2013,74852
policies_copy_outbound_addresses_to_smartlist(2030,75451
policies_parse_exit_policy_from_options(2070,77091
policies_exit_policy_append_reject_star(2128,78954
policies_set_node_exitpolicy_to_reject_all(2136,79186
exit_policy_is_general_exit_helper(2144,79413
exit_policy_is_general_exit(2192,81088
policy_is_reject_star(2211,81681
policy_write_item(2235,82542
policy_summary_create(2311,84957
policy_summary_item_split(2335,85600
#define AT(2354,86166
#define IPV4_BITS 2356,86233
#define REJECT_CUTOFF_SCALE_IPV4 2358,86324
#define REJECT_CUTOFF_COUNT_IPV4 2361,86469
#define IPV6_BITS 2364,86602
#define REJECT_CUTOFF_SCALE_IPV6 2366,86715
#define REJECT_CUTOFF_COUNT_IPV6 2373,87075
policy_summary_split(2380,87347
policy_summary_accept(2411,88092
policy_summary_reject(2434,88933
policy_summary_add_item(2499,91194
policy_summarize(2540,92549
parse_short_policy(2652,95697
write_short_policy(2749,98564
short_policy_free(2775,99308
compare_tor_addr_to_short_policy(2785,99678
short_policy_is_reject_star(2833,101270
compare_tor_addr_to_node_policy(2850,101936
policy_dump_to_string(2888,103070
getinfo_helper_policies(2931,104389
addr_policy_list_free(3025,107518
addr_policy_free(3035,107737
policies_free_all(3056,108154

proto_cell.c,68
cell_command_is_var_length(16,484
fetch_var_cell_from_buf(48,1765

proto_control0.c,38
peek_buf_has_control0_command(14,443

proto_ext_or.c,77
#define EXT_OR_CMD_HEADER_SIZE 14,437
fetch_ext_or_command_from_buf(22,784

proto_http.c,168
#define PROTO_HTTP_PRIVATE7,243
peek_buf_has_http_command(14,404
fetch_from_buf_http(45,1583
buf_http_find_content_length(134,4470
#define CONTENT_LENGTH 144,4822

proto_socks.c,514
#define SOCKS_WARN_INTERVAL 28,1017
log_unsafe_socks_warning(34,1280
#define MAX_SOCKS_MESSAGE_LEN 58,2394
socks_request_new(62,2484
socks_request_free(69,2633
fetch_from_buf_socks(111,4027
socks_request_set_socks5_error(147,4936
static const char SOCKS_PROXY_IS_NOT_AN_HTTP_PROXY_MSG[SOCKS_PROXY_IS_NOT_AN_HTTP_PROXY_MSG158,5218
parse_socks(192,6682
      enum {socks4,socks4421,16000
      enum {socks4, socks4a}socks4a421,16000
fetch_from_buf_socks_client(572,21764
parse_socks_client(597,22322

protover.c,984
#define PROTOVER_PRIVATE24,1151
  protocol_type_t protover_type;36,1518
  const char *name;name37,1551
} PROTOCOL_NAMES[PROTOCOL_NAMES38,1571
#define N_PROTOCOL_NAMES 51,1876
protocol_type_to_str(58,2043
str_to_protocol_type(76,2484
proto_entry_free(96,2862
parse_version_range(113,3349
parse_single_entry(163,4496
parse_protocol_list(219,5683
protover_is_supported_here(255,6394
protocol_list_supports_protocol(266,6694
protover_get_supported_protocols(286,7325
static smartlist_t *supported_protocol_list supported_protocol_list304,7718
get_supported_protocol_list(309,7887
proto_entry_encode_into(323,8258
encode_protocol_list(346,9038
static const int MAX_PROTOCOLS_TO_EXPAND 368,9621
expand_protocol_list(380,10038
cmp_single_ent_by_version(412,11065
contract_protocol_list(442,11949
protover_compute_vote(549,15622
protover_all_supported(611,17981
protocol_list_contains(664,19262
protover_compute_for_old_tor(695,20188
protover_free_all(728,21375

reasons.c,616
stream_end_reason_to_control_string(26,901
stream_end_reason_to_string(62,2415
stream_end_reason_to_socks5_response(98,4060
#define E_CASE(165,6605
#define S_CASE(166,6645
#define E_CASE(168,6683
#define S_CASE(169,6708
errno_to_stream_end_reason(175,6889
orconn_end_reason_to_control_string(223,8374
tls_error_to_orconn_end_reason(259,9456
errno_to_orconn_end_reason(285,10216
circuit_end_reason_to_control_string(322,11203
socks4_response_code_to_string(387,13218
socks5_response_code_to_string(405,13674
bandwidth_weight_rule_to_string(433,14348
end_reason_to_http_connect_response_line(455,14904

relay.c,2945
#define RELAY_PRIVATE48,2258
#define CELL_QUEUE_HIGHWATER_SIZE 108,4539
#define CELL_QUEUE_LOWWATER_SIZE 111,4666
uint64_t stats_n_relay_cells_relayed 116,4829
uint64_t stats_n_relay_cells_delivered 120,4954
static tor_weak_rng_t stream_choice_rng 123,5065
relay_set_digest(129,5221
relay_digest_matches(150,5990
relay_crypt_one_payload(191,7383
circuit_update_channel_usage(207,7947
circuit_receive_relay_cell(285,11217
relay_crypt(423,16278
circuit_package_relay_cell(491,18626
relay_lookup_conn(564,21325
relay_header_pack(617,23055
relay_header_unpack(630,23438
relay_command_to_string(641,23802
MOCK_IMPL(686,25799
connection_edge_send_command(794,30250
#define MAX_RESOLVE_FAILURES 850,32204
edge_reason_is_retriable(855,32375
connection_ap_process_end_not_open(870,32893
adjust_exit_policy_from_exitpolicy_failure(1073,41612
remap_event_helper(1108,42849
connected_cell_parse(1123,43486
address_ttl_free(1161,44547
resolved_cell_parse(1175,44978
connection_ap_handshake_socks_got_resolved_cell(1272,47615
connection_edge_process_resolved_cell(1346,50218
connection_edge_process_relay_cell_not_open(1415,53001
connection_edge_process_relay_cell(1559,59079
#define EARLY_WARNING_INTERVAL 1759,66911
uint64_t stats_n_data_cells_packaged 1962,75062
uint64_t stats_n_data_bytes_packaged 1966,75317
uint64_t stats_n_data_cells_received 1968,75416
uint64_t stats_n_data_bytes_received 1972,75663
connection_edge_package_raw_inbuf(1985,76171
connection_edge_consider_sending_sendme(2124,80867
circuit_resume_edge_reading(2158,82067
stream_choice_seed_weak_rng(2175,82636
circuit_resume_edge_reading_helper(2185,82932
circuit_consider_stop_edge_reading(2341,88784
circuit_consider_sending_sendme(2380,90118
#define assert_cmux_ok_paranoid(2401,90945
#define assert_cmux_ok_paranoid(2404,91026
static size_t total_cells_allocated 2408,91164
packed_cell_free_unchecked(2412,91269
packed_cell_new(2420,91438
packed_cell_free(2428,91612
dump_cell_pool_usage(2438,91809
packed_cell_copy(2456,92360
cell_queue_append(2465,92569
cell_queue_append_packed_copy(2476,92906
cell_queue_init(2492,93385
cell_queue_clear(2500,93559
cell_queue_pop(2514,93947
packed_cell_mem_cost(2527,94252
cell_queues_get_total_allocation(2534,94343
#define MEMORY_PRESSURE_INTERVAL 2540,94521
static time_t last_time_under_memory_pressure 2543,94616
cell_queues_check_size(2548,94809
have_been_under_memory_pressure(2576,95822
update_circuit_on_cmux_(2587,96059
channel_unlink_all_circuits(2636,97311
set_streams_blocked_on_circ(2656,97922
packed_cell_get_command(2702,99144
packed_cell_get_circid(2713,99388
MOCK_IMPL(2726,99875
get_max_middle_cells(2869,104738
append_cell_to_circuit_queue(2878,104935
append_address_to_payload(3023,110754
decode_address_from_payload(3049,111534
circuit_clear_cell_queue(3077,112226
assert_circuit_mux_okay(3103,112899
circuit_queue_streams_are_blocked(3115,113150

rendcache.c,1528
#define RENDCACHE_PRIVATE9,172
STATIC strmap_t *rend_cache rend_cache20,428
static strmap_t *rend_cache_local_service rend_cache_local_service23,541
STATIC digestmap_t *rend_cache_v2_dir rend_cache_v2_dir27,685
STATIC strmap_t *rend_cache_failure rend_cache_failure54,2226
STATIC size_t rend_cache_total_allocation 57,2284
rend_cache_init(62,2386
rend_cache_entry_allocation(72,2646
rend_cache_get_total_allocation(83,2855
rend_cache_decrement_allocation(90,3015
rend_cache_increment_allocation(107,3444
rend_cache_failure_intro_entry_free(123,3875
rend_cache_failure_intro_entry_free_(132,4021
rend_cache_failure_intro_entry_new(140,4293
rend_cache_failure_entry_free(150,4579
rend_cache_failure_entry_free_(166,5002
rend_cache_failure_entry_new(174,5211
rend_cache_failure_remove(184,5475
rend_cache_entry_free(204,6000
rend_cache_entry_free_(220,6514
rend_cache_free_all(227,6646
rend_cache_failure_clean(248,7459
rend_cache_clean(272,8327
rend_cache_purge(303,9167
rend_cache_failure_purge(315,9470
cache_failure_intro_lookup(329,10008
cache_failure_intro_dup(361,10845
cache_failure_intro_add(373,11258
validate_intro_point_failure(400,12513
rend_cache_intro_failure_note(448,14545
rend_cache_clean_v2_descs_as_dir(469,15296
rend_cache_lookup_entry(505,16523
rend_cache_lookup_v2_desc_as_service(553,17755
rend_cache_lookup_v2_desc_as_dir(586,18439
rend_cache_store_v2_desc_as_dir(621,19626
rend_cache_store_v2_desc_as_service(730,23699
rend_cache_store_v2_desc_as_client(811,26616

rendclient.c,1279
rend_client_purge_state(41,1093
rend_client_introcirc_has_opened(52,1372
rend_client_send_establish_rendezvous(65,1758
rend_client_send_introduction(97,2892
rend_client_rendcirc_has_opened(314,11093
rend_client_close_other_intros(330,11480
rend_client_introduction_acked(353,12342
directory_get_from_hs_dir(429,15954
purge_v2_hidserv_req(527,20133
fetch_v2_desc_by_descid(544,20727
fetch_v2_desc_by_addr(578,21760
rend_client_fetch_v2_desc(643,24383
rend_client_refetch_v2_renddesc(677,25416
rend_client_cancel_descriptor_fetches(709,26684
rend_client_report_intro_point_failure(762,28957
rend_client_receive_rendezvous(860,32711
rend_client_desc_trynow(884,33468
rend_client_note_connection_attempt_ended(936,35640
rend_client_get_random_intro(978,37175
rend_client_get_random_intro_impl(1010,38340
rend_client_any_intro_points_usable(1079,40854
static strmap_t *auth_hid_servs auth_hid_servs1092,41231
rend_client_lookup_service_authorization(1098,41466
rend_service_authorization_free(1107,41734
rend_service_authorization_strmap_item_free(1114,41868
rend_service_authorization_free_all(1122,42047
rend_parse_service_authorization(1135,42433
rend_client_allow_non_anonymous_connection(1212,45090
rend_client_non_anonymous_mode_enabled(1227,45499

rendcommon.c,1170
#define RENDCOMMON_PRIVATE11,307
rend_cmp_service_ids(32,777
rend_service_descriptor_free(40,941
#define REND_DESC_COOKIE_LEN 60,1530
#define REND_REPLICA_LEN 64,1688
rend_get_descriptor_id_bytes(71,1947
get_secret_id_part_bytes(88,2682
get_time_period(107,3483
get_seconds_valid(121,4104
rend_compute_v2_desc_id(137,4736
rend_encode_v2_intro_points(178,6451
rend_encrypt_v2_intro_points_basic(263,9559
rend_encrypt_v2_intro_points_stealth(370,13747
rend_desc_v2_is_parsable(402,14796
rend_encoded_v2_service_descriptor_free(422,15563
rend_intro_point_free(433,15791
rend_encode_v2_descriptors(457,16637
rend_get_service_id(689,25781
rend_valid_v2_service_id(702,26141
rend_valid_descriptor_id(716,26479
rend_valid_client_name(734,26845
rend_process_relay_cell(750,27232
hid_serv_get_responsible_directories(820,29558
#define REND_DESC_COOKIE_LEN_EXT 852,30691
#define REND_DESC_COOKIE_LEN_EXT_BASE64 855,30896
rend_auth_encode_cookie(866,31342
rend_auth_decode_cookie(902,32830
rend_allow_non_anonymous_connection(968,35398
rend_non_anonymous_mode_enabled(981,35963
assert_circ_anonymity_ok(997,36500
rend_circuit_pk_digest_eq(1014,37067

rendmid.c,146
rend_mid_establish_intro_legacy(25,609
rend_mid_introduce_legacy(136,4472
rend_mid_establish_rendezvous(218,7605
rend_mid_rendezvous(281,9569

rendservice.c,4192
#define RENDSERVICE_PRIVATE10,256
static const char *private_key_fname private_key_fname89,3116
static const char *hostname_fname hostname_fname90,3170
static const char *client_keys_fname client_keys_fname91,3218
static const char *sos_poison_fname sos_poison_fname92,3272
static smartlist_t *rend_service_list rend_service_list95,3405
static smartlist_t *rend_service_staging_list rend_service_staging_list99,3638
rend_get_service_list(103,3791
rend_get_service_list_mutable(117,4330
rend_service_is_ephemeral(136,4771
rend_service_escaped_dir(144,4961
rend_num_services(151,5174
rend_authorized_client_free(160,5369
rend_authorized_client_strmap_item_free(175,5794
rend_service_free(183,5978
rend_service_free_staging_list(221,7167
rend_service_free_all(234,7552
rend_service_init(247,7868
rend_validate_service(260,8242
rend_add_service(305,9719
rend_service_port_config_new(357,11375
rend_service_parse_port_config(379,12135
rend_service_port_config_free(473,15129
copy_service_on_prunning(483,15516
rend_service_prune_list_impl_(507,16563
rend_service_prune_list(618,21465
service_config_shadow_copy(641,22353
rend_config_service(672,23826
rend_service_add_ephemeral(853,31538
rend_service_del_ephemeral(921,33880
#define INTRO_CIRC_RETRY_PERIOD_SLOP 970,35765
rend_log_intro_limit(976,36026
rend_service_update_descriptor(1011,37389
rend_service_path(1086,40281
rend_service_sos_poison_path(1097,40666
service_is_single_onion_poisoned(1105,40893
rend_service_private_key_exists(1137,41678
rend_service_verify_single_onion_poison(1158,42700
poison_new_single_onion_hidden_service_dir_impl(1201,44145
rend_service_poison_new_single_onion_dir(1273,46412
rend_service_load_all_keys(1311,47481
rend_service_add_filenames_to_list(1334,48066
rend_services_add_filenames_to_lists(1349,48622
rend_service_derive_key_digests(1366,49167
rend_service_check_private_dir(1390,50010
rend_service_load_keys(1454,52426
rend_service_load_auth_keys(1513,53974
rend_service_get_by_pk_digest(1697,60497
rend_service_get_by_service_id(1709,60855
rend_check_authorization(1723,61302
rend_service_use_direct_connection(1770,63001
rend_service_use_direct_connection_node(1783,63609
rend_service_receive_introduction(1800,64102
find_rp_for_intro(2135,75484
rend_service_free_intro(2224,77935
rend_service_begin_parse_intro(2293,80076
rend_service_parse_intro_for_v0_or_v1(2356,81646
rend_service_parse_intro_for_v2(2429,83762
rend_service_parse_intro_for_v3(2531,86749
rend_service_decrypt_intro(2669,90977
rend_service_parse_intro_plaintext(2792,94256
rend_service_validate_intro_late(2898,97317
rend_service_relaunch_rendezvous(2933,98293
rend_service_launch_establish_intro(2980,100051
count_established_intro_points(3067,103872
count_intro_point_circuits(3082,104361
rend_service_encode_establish_intro_cell(3108,105334
rend_service_intro_has_opened(3157,106757
rend_service_intro_established(3284,111509
rend_service_rendezvous_has_opened(3345,113740
find_intro_circuit(3474,118282
find_expiring_intro_point(3504,119300
find_intro_point(3522,119918
directory_post_to_hs_dir(3555,121010
upload_service_descriptor(3669,126099
intro_point_accepted_intro_count(3785,130933
intro_point_should_expire_now(3794,131198
remove_invalid_intro_points(3841,132861
rend_service_desc_has_uploaded(3928,136658
rend_max_intro_circs_per_period(3959,137648
rend_consider_services_intro_points(3981,138606
#define MIN_REND_INITIAL_POST_DELAY 4152,146339
#define MIN_REND_INITIAL_POST_DELAY_TESTING 4153,146380
rend_consider_services_upload(4164,146800
static int consider_republishing_rend_descriptors 4208,148741
rend_hsdir_routers_changed(4214,148985
rend_consider_descriptor_republication(4223,149215
rend_service_dump_stats(4249,149938
rend_service_set_connection_addr_port(4284,151175
#define MAX_STREAM_WARN_INTERVAL 4307,152201
rend_service_non_anonymous_mode_consistent(4342,153453
rend_service_allow_non_anonymous_connection(4355,153995
rend_service_reveal_startup_time(4369,154610
rend_service_non_anonymous_mode_enabled(4381,155025
set_rend_service_list(4390,155258
set_rend_rend_service_staging_list(4396,155352

rephist.c,10392
uint64_t rephist_total_alloc=96,3646
uint32_t rephist_total_num=98,3737
#define STABILITY_EPSILON 102,3909
#define STABILITY_ALPHA 105,4064
#define STABILITY_INTERVAL 107,4171
typedef struct link_history_t 114,4534
  time_t since;116,4613
  time_t changed;118,4691
  unsigned long n_extend_ok;120,4772
  unsigned long n_extend_fail;122,4861
} link_history_t;123,4892
typedef struct or_history_t 126,4936
  time_t since;128,5011
  time_t changed;130,5088
  unsigned long n_conn_ok;132,5159
  unsigned long n_conn_fail;134,5241
  unsigned long uptime;137,5354
  unsigned long downtime;140,5472
  time_t up_since;142,5559
  time_t down_since;144,5647
  tor_addr_t last_reached_addr;148,5756
  uint16_t last_reached_port;151,5867
  unsigned long weighted_run_length;156,6007
  time_t start_of_run;159,6152
  double total_run_weights;161,6232
  time_t start_of_downtime;163,6304
  unsigned long weighted_uptime;164,6332
  unsigned long total_weighted_time;165,6365
  digestmap_t *link_history_map;link_history_map169,6504
} or_history_t;170,6537
typedef struct padding_counts_t 175,6639
  uint64_t read_cell_count;177,6740
  uint64_t write_cell_count;179,6831
  uint64_t read_pad_cell_count;181,6921
  uint64_t write_pad_cell_count;183,7010
  uint64_t enabled_read_cell_count;185,7104
  uint64_t enabled_write_cell_count;187,7201
  uint64_t enabled_read_pad_cell_count;189,7311
  uint64_t enabled_write_pad_cell_count;191,7424
  uint64_t read_drop_cell_count;193,7524
  uint64_t write_drop_cell_count;195,7612
  uint64_t maximum_chanpad_timers;197,7715
  char first_published_at[first_published_at199,7822
} padding_counts_t;200,7865
static padding_counts_t padding_current;204,8014
static padding_counts_t padding_published;208,8161
static time_t stability_last_downrated 212,8316
static time_t started_tracking_stability 215,8369
static digestmap_t *history_map history_map218,8472
get_or_history(223,8638
get_link_history(248,9313
free_link_history_(269,9924
free_or_history(277,10100
update_or_history(290,10446
rep_hist_init(305,10840
mark_or_down(316,11133
mark_or_up(330,11460
rep_hist_note_connect_failed(345,11786
rep_hist_note_connect_succeeded(360,12122
rep_hist_note_disconnect(375,12461
rep_hist_note_connection_died(389,12786
rep_hist_note_router_reachable(408,13287
rep_hist_note_router_unreachable(481,16206
#define SUBTRACT_CLAMPED(500,16827
rep_hist_make_router_pessimal(535,18128
rep_hist_downrate_old_runs(550,18534
get_stability(595,19973
get_total_weighted_time(617,20643
get_weighted_fractional_uptime(631,21039
rep_hist_get_uptime(658,21836
rep_hist_get_stability(671,22194
rep_hist_get_weighted_fractional_uptime(683,22506
rep_hist_get_weighted_time_known(699,22988
rep_hist_have_measured_enough_stability(711,23271
rep_hist_note_extend_succeeded(723,23653
rep_hist_note_extend_failed(739,24105
rep_hist_dump_stats(754,24485
rep_history_clean(841,27461
rep_hist_record_mtbf_data(888,29163
#define PUT(917,29958
#define PRINTF(918,30023
#undef PUT980,32139
#undef PRINTF981,32150
find_next_with(993,32458
static int n_bogus_times 1006,32795
parse_possibly_bad_iso_time(1010,32954
correct_time(1031,33540
rep_hist_load_mtbf_data(1051,34045
#define NUM_SECS_ROLLING_MEASURE 1240,40034
#define NUM_SECS_BW_SUM_INTERVAL 1242,40150
#define NUM_SECS_BW_SUM_IS_VALID 1244,40262
#define NUM_TOTALS 1246,40374
typedef struct bw_array_t 1251,40540
  uint64_t obs[obs1254,40723
  int cur_obs_idx;1255,40765
  time_t cur_obs_time;1256,40817
  uint64_t total_obs;1257,40885
  uint64_t max_total;1259,40993
  uint64_t total_in_period;1261,41113
  time_t next_period;1265,41270
  int next_max_idx;1268,41393
  int num_maxes_set;1270,41475
  uint64_t maxima[maxima1274,41622
  uint64_t totals[totals1277,41743
} bw_array_t;1278,41774
commit_max(1282,41854
advance_obs(1302,42479
add_obs(1328,43118
bw_array_new(1349,43872
bw_array_free(1363,44197
static bw_array_t *read_array read_array1374,44389
static bw_array_t *write_array write_array1376,44497
static bw_array_t *dir_read_array dir_read_array1379,44636
static bw_array_t *dir_write_array dir_write_array1382,44779
bw_arrays_init(1387,44928
rep_hist_note_bytes_written(1408,45487
rep_hist_note_bytes_read(1425,46128
rep_hist_note_dir_bytes_written(1435,46440
rep_hist_note_dir_bytes_read(1444,46690
find_largest_max(1454,47006
rep_hist_bandwidth_assess(1473,47439
rep_hist_fill_bandwidth_history(1491,47958
rep_hist_get_bandwidth_lines(1540,49425
#define MAX_HIST_VALUE_LEN 1552,49756
rep_hist_update_bwhist_state_section(1597,51003
rep_hist_update_state(1657,53217
#define UPDATE(1659,53260
#undef UPDATE1675,53914
rep_hist_load_bwhist_state_section(1681,54082
rep_hist_load_state(1757,56813
#define LOAD(1765,57023
#undef LOAD1779,57680
typedef struct predicted_port_t 1794,58107
  uint16_t port;1796,58175
  time_t time;1798,58235
} predicted_port_t;1799,58250
static smartlist_t *predicted_ports_list=predicted_ports_list1802,58331
static int prediction_timeout=1804,58426
static time_t last_prediction_add_time=1806,58530
predicted_ports_prediction_time_remaining(1812,58642
add_predicted_port(1843,59735
predicted_ports_alloc(1871,60561
predicted_ports_init(1877,60641
predicted_ports_free(1886,60839
rep_hist_note_used_port(1900,61310
rep_hist_get_predicted_ports(1927,62098
rep_hist_remove_predicted_ports(1955,62931
rep_hist_note_used_resolve(1977,63804
static time_t predicted_internal_time 1983,63942
static time_t predicted_internal_uptime_time 1985,64051
static time_t predicted_internal_capacity_time 1987,64169
rep_hist_note_used_internal(1991,64293
rep_hist_get_predicted_internal(2014,65019
any_predicted_circuits(2038,65810
rep_hist_circbuilding_dormant(2049,66144
#define EXIT_STATS_ROUND_UP_BYTES 2071,66671
#define EXIT_STATS_ROUND_UP_STREAMS 2073,66770
#define EXIT_STATS_NUM_PORTS 2075,66835
#define EXIT_STATS_TOP_N_PORTS 2077,66926
static uint64_t *exit_bytes_read exit_bytes_read2084,67280
static uint64_t *exit_bytes_written exit_bytes_written2086,67383
static uint32_t *exit_streams exit_streams2088,67490
static time_t start_of_exit_stats_interval;2091,67602
rep_hist_exit_stats_init(2095,67687
rep_hist_reset_exit_stats(2105,68036
rep_hist_exit_stats_term(2116,68447
compare_int_(2128,68784
rep_hist_format_exit_stats(2137,69078
rep_hist_exit_stats_write(2292,75162
rep_hist_note_exit_bytes(2322,75983
rep_hist_note_exit_stream_opened(2336,76492
static time_t start_of_buffer_stats_interval;2348,76830
rep_hist_buffer_stats_init(2352,76914
typedef struct circ_buffer_stats_t 2359,77115
  double mean_num_cells_in_queue;2361,77208
  double mean_time_cells_in_queue;2363,77291
  uint32_t processed_cells;2365,77380
  uint16_t port;2370,77479
  uint8_t is_exit_data;2372,77558
} circ_buffer_stats_t;2374,77583
static smartlist_t *circuits_for_buffer_stats circuits_for_buffer_stats2377,77643
rep_hist_add_buffer_stats(2383,77847
rep_hist_buffer_stats_add_circ(2405,78725
buffer_stats_compare_entries_(2461,80571
rep_hist_buffer_stats_term(2475,80951
rep_hist_reset_buffer_stats(2483,81128
rep_hist_format_buffer_stats(2497,81658
#define SHARES 2500,81702
#undef SHARES2593,85546
rep_hist_format_moneTor_stats(2597,85570
#define SHARES 2600,85615
#undef SHARES2696,88684
rep_hist_buffer_stats_write(2705,89003
static digestmap_t *served_descs served_descs2748,90446
static unsigned long total_descriptor_downloads;2752,90576
static time_t start_of_served_descs_stats_interval;2755,90702
rep_hist_desc_stats_init(2759,90796
rep_hist_reset_desc_stats(2773,91247
rep_hist_desc_stats_term(2782,91467
rep_hist_format_desc_stats(2795,91924
rep_hist_desc_stats_write(2849,93594
rep_hist_note_desc_served(2880,94588
static time_t start_of_conn_stats_interval;2898,95064
rep_hist_conn_stats_init(2902,95150
#define BIDI_THRESHOLD 2909,95335
#define BIDI_FACTOR 2914,95520
#define BIDI_INTERVAL 2918,95641
static time_t bidi_next_interval 2921,95719
static uint32_t below_threshold 2925,95878
static uint32_t mostly_read 2929,96047
static uint32_t mostly_written 2933,96212
static uint32_t both_read_and_written 2938,96423
typedef struct bidi_map_entry_t 2942,96606
  HT_ENTRY(2943,96640
} bidi_map_entry_t;2947,96811
static HT_HEAD(2951,96961
bidi_map_ent_hash(2962,97206
HT_PROTOTYPE(2967,97296
rep_hist_reset_conn_stats(2987,97856
rep_hist_conn_stats_term(3000,98167
rep_hist_note_or_conn_bytes(3010,98488
rep_hist_format_conn_stats(3063,100350
rep_hist_conn_stats_write(3088,101191
STATIC int onion_handshakes_requested[onion_handshakes_requested3117,102005
STATIC int onion_handshakes_assigned[onion_handshakes_assigned3118,102078
rep_hist_note_circuit_handshake_requested(3123,102234
rep_hist_note_circuit_handshake_assigned(3132,102465
rep_hist_log_circuit_handshake_stats(3140,102682
static time_t start_of_hs_stats_interval;3157,103438
typedef struct hs_stats_t 3161,103573
  uint64_t rp_relay_cells_seen;3163,103666
  digestmap_t *onions_seen_this_period;onions_seen_this_period3167,103823
} hs_stats_t;3168,103863
static hs_stats_t *hs_stats hs_stats3171,103921
hs_stats_new(3175,104042
hs_stats_free(3185,104264
rep_hist_hs_stats_init(3197,104500
rep_hist_reset_hs_stats(3209,104750
rep_hist_hs_stats_term(3226,105159
rep_hist_seen_new_rp_cell(3233,105273
rep_hist_stored_maybe_new_hs(3246,105565
#define REND_CELLS_DELTA_F 3274,106549
#define REND_CELLS_EPSILON 3278,106771
#define REND_CELLS_BIN_SIZE 3281,106933
#define ONIONS_SEEN_DELTA_F 3285,107191
#define ONIONS_SEEN_EPSILON 3289,107424
#define ONIONS_SEEN_BIN_SIZE 3292,107600
rep_hist_format_hs_stats(3297,107776
rep_hist_hs_stats_write(3343,109872
static uint64_t link_proto_count[link_proto_count3372,110527
rep_hist_note_negotiated_link_proto(3378,110731
rep_hist_padding_count_timers(3394,111132
rep_hist_padding_count_write(3408,111503
rep_hist_padding_count_read(3436,112242
rep_hist_reset_padding_counts(3461,112857
#define MIN_CELL_COUNTS_TO_PUBLISH 3472,113156
#define ROUND_CELL_COUNTS_TO 3473,113193
rep_hist_prep_published_padding_counts(3475,113233
#define ROUND_AND_SET_COUNT(3486,113648
#undef ROUND_AND_SET_COUNT3498,114428
rep_hist_get_padding_count_lines(3506,114598
rep_hist_log_link_protocol_counts(3552,116589
rep_hist_free_all(3577,117641

replaycache.c,291
#define REPLAYCACHE_PRIVATE22,730
replaycache_free(31,862
replaycache_new(49,1285
replaycache_add_and_test_internal(79,1872
replaycache_scrub_if_needed_internal(143,3590
replaycache_add_and_test(191,5117
replaycache_add_test_and_elapsed(201,5400
replaycache_scrub_if_needed(212,5692

router.c,6054
#define ROUTER_PRIVATE7,243
static tor_mutex_t *key_lock=key_lock67,2017
static time_t onionkey_set_at=68,2052
static crypto_pk_t *onionkey=onionkey70,2203
static crypto_pk_t *lastonionkey=lastonionkey73,2386
static curve25519_keypair_t curve25519_onion_key;75,2501
static curve25519_keypair_t last_curve25519_onion_key;78,2689
static crypto_pk_t *server_identitykey=server_identitykey81,2850
static char server_identitykey_digest[server_identitykey_digest83,2932
static crypto_pk_t *client_identitykey=client_identitykey87,3138
static crypto_pk_t *authority_signing_key authority_signing_key89,3260
static authority_cert_t *authority_key_certificate authority_key_certificate92,3401
static crypto_pk_t *legacy_signing_key legacy_signing_key96,3596
static authority_cert_t *legacy_key_certificate legacy_key_certificate99,3782
set_onion_key(110,4235
get_onion_key(127,4682
dup_onion_keys(137,4891
expire_old_onion_keys(159,5452
get_current_curve25519_keypair(199,6592
construct_ntor_key_map(206,6822
ntor_key_map_free_helper(228,7571
ntor_key_map_free(236,7770
get_onion_key_set_at(248,8081
set_server_identity_key(256,8201
assert_identity_keys_ok(270,8661
get_server_identity_key(290,9317
server_identity_key_is_set(301,9574
set_client_identity_key(309,9741
get_tlsclient_identity_key(319,9988
client_identity_key_is_set(328,10183
MOCK_IMPL(335,10367
get_my_v3_authority_signing_key(344,10586
get_my_v3_legacy_cert(353,10847
get_my_v3_legacy_signing_key(361,11059
rotate_onion_key(374,11495
log_new_relay_greeting(445,13973
init_key_from_file(468,14777
init_curve25519_keypair_from_file(546,17455
load_authority_keyset(618,20124
init_v3_authority_keys(675,21778
v3_authority_check_key_expiry(692,22262
get_onion_key_rotation_days_(741,23783
get_onion_key_lifetime(755,24306
get_onion_key_grace_period(765,24583
router_initialize_tls_context(779,25136
router_write_fingerprint(817,26583
init_keys_common(870,28226
init_keys_client(888,28669
init_keys(914,29287
static int can_reach_or_port 1181,39067
static int can_reach_dir_port 1183,39159
router_reset_reachability(1187,39266
router_reachability_checks_disabled(1198,39512
check_whether_orport_reachable(1213,40039
check_whether_dirport_reachable(1230,40669
#define MIN_BW_TO_ADVERTISE_DIRSERVER 1241,41086
router_has_bandwidth_to_be_dirserver(1246,41236
router_should_be_directory_server(1266,41927
dir_server_mode(1330,44400
decide_to_advertise_dir_impl(1348,44940
decide_to_advertise_dirport(1379,46085
decide_to_advertise_begindir(1389,46471
extend_info_from_router(1401,46988
consider_testing_reachability(1434,48104
#define SELF_EXCLUDED_WARN_INTERVAL 1448,48592
router_orport_found_reachable(1498,50764
router_dirport_found_reachable(1525,51822
router_perform_bandwidth_test(1555,53039
net_is_disabled(1586,54223
authdir_mode(1595,54407
authdir_mode_v3(1603,54589
authdir_mode_handles_descs(1612,54882
authdir_mode_publishes_statuses(1627,55334
authdir_mode_tests_reachability(1637,55613
authdir_mode_bridge(1645,55809
MOCK_IMPL(1652,55989
MOCK_IMPL(1661,56186
should_refuse_unknown_exits(1672,56539
static int server_is_advertised=1682,56837
MOCK_IMPL(1686,56938
set_server_advertised(1697,57124
proxy_mode(1704,57256
decide_if_publishable_server(1731,58156
consider_publishable_server(1764,59204
router_get_active_listener_port_by_type_af(1786,59732
router_get_advertised_or_port(1807,60471
router_get_advertised_or_port_by_af(1815,60691
router_get_advertised_dir_port(1837,61536
static routerinfo_t *desc_routerinfo desc_routerinfo1857,62010
static extrainfo_t *desc_extrainfo desc_extrainfo1859,62075
static const char *desc_gen_reason desc_gen_reason1862,62250
static time_t desc_clean_since 1865,62383
static const char *desc_dirty_reason desc_dirty_reason1867,62464
static int desc_needs_upload 1869,62575
router_upload_dir_desc_to_dirservers(1876,62800
router_compare_to_my_exit_policy(1922,64216
MOCK_IMPL(1956,65497
router_digest_is_me(1968,65811
router_get_my_id_digest(1976,66007
router_extrainfo_digest_is_me(1984,66188
router_is_me(1997,66482
MOCK_IMPL(2004,66720
router_get_my_descriptor(2018,67061
router_get_my_extrainfo(2035,67627
router_get_descriptor_gen_reason(2047,67937
static smartlist_t *warned_nonexistent_family warned_nonexistent_family2054,68130
MOCK_IMPL(2066,68608
router_check_descriptor_address_port_consistency(2095,69550
router_check_descriptor_address_consistency(2160,72807
router_build_fresh_descriptor(2176,73574
router_rebuild_descriptor(2417,83091
#define FORCE_REGENERATE_DESCRIPTOR_INTERVAL 2457,84215
#define FAST_RETRY_DESCRIPTOR_INTERVAL 2461,84414
mark_my_descriptor_dirty_if_too_old(2466,84564
mark_my_descriptor_dirty(2503,85949
#define MAX_BANDWIDTH_CHANGE_FREQ 2516,86475
check_descriptor_bandwidth_changed(2521,86653
log_addr_has_changed(2545,87398
check_descriptor_ipaddress_changed(2573,88471
static tor_addr_t last_guessed_ip 2614,89476
router_new_address_suggestion(2621,89761
router_guess_address_from_dir_headers(2683,92086
get_platform_str(2697,92458
#define DEBUG_ROUTER_DUMP_ROUTER_TO_STRING2707,92756
router_dump_router_to_string(2714,93017
router_dump_exit_policy_to_string(3093,105940
router_get_prim_orport(3109,106475
router_has_addr(3119,106770
router_has_orport(3127,106944
load_stats_file(3144,107695
extrainfo_dump_to_string(3194,109211
is_legal_nickname(3409,117294
is_legal_nickname_or_hexdigest(3421,117579
is_legal_hexdigest(3435,117980
format_node_description(3465,118873
router_get_description(3506,119937
node_get_description(3524,120498
routerstatus_get_description(3556,121329
extend_info_get_description(3574,121896
router_describe(3592,122467
node_describe(3604,122802
routerstatus_describe(3616,123137
extend_info_describe(3628,123491
router_get_verbose_nickname(3642,123993
router_reset_warnings(3654,124414
router_purpose_to_string(3666,124807
router_purpose_from_string(3681,125142
router_free_all(3695,125495
router_get_all_orports(3722,126451

routerkeys.c,1941
#define ENC_KEY_HEADER 24,661
#define ENC_KEY_TAG 25,704
do_getpass(29,762
read_encrypted_secret_key(96,2198
write_encrypted_secret_key(169,4126
write_secret_key(213,5326
ed_key_init_from_file(287,8214
ed_key_new(624,19915
static ed25519_keypair_t *master_identity_key master_identity_key662,20944
static ed25519_keypair_t *master_signing_key master_signing_key663,20998
static ed25519_keypair_t *current_auth_key current_auth_key664,21051
static tor_cert_t *signing_key_cert signing_key_cert665,21102
static tor_cert_t *link_cert_cert link_cert_cert666,21146
static tor_cert_t *auth_key_cert auth_key_cert667,21188
static uint8_t *rsa_ed_crosscert rsa_ed_crosscert669,21230
static size_t rsa_ed_crosscert_len 670,21271
static time_t rsa_ed_crosscert_expiration 671,21311
load_ed_keys(681,21629
#define FAIL(697,22189
#define SET_KEY(701,22353
#define SET_CERT(706,22567
#define HAPPENS_SOON(711,22781
#define EXPIRES_SOON(713,22861
generate_ed_link_cert(998,34010
#undef FAIL1038,35222
#undef SET_KEY1039,35234
#undef SET_CERT1040,35249
should_make_new_ed_keys(1054,35630
#undef EXPIRES_SOON1081,36408
#undef HAPPENS_SOON1082,36428
init_mock_ed_keys(1088,36560
#define MAKEKEY(1092,36643
#define MAKECERT(1101,37029
#undef MAKEKEY1135,38398
#undef MAKECERT1136,38413
print_cert_expiration(1147,38712
log_ed_cert_expiration(1158,39031
log_master_signing_key_cert_expiration(1181,39815
log_cert_expiration(1226,41140
get_master_identity_key(1242,41551
router_ed25519_id_is_me(1251,41743
get_master_identity_keypair(1261,42073
get_master_signing_keypair(1268,42205
get_master_signing_key_cert(1274,42299
get_current_auth_keypair(1280,42391
get_current_link_cert_cert(1286,42473
get_current_auth_key_cert(1292,42555
get_master_rsa_crosscert(1298,42621
make_ntor_onion_key_crosscert(1309,42973
make_tap_onion_key_crosscert(1332,43698
MOCK_IMPL(1359,44584
routerkeys_free_all(1395,45715

routerlist.c,7676
#define ROUTERLIST_PRIVATE93,4142
DECLARE_TYPED_DIGESTMAP_FNS(132,5033
#define SDMAP_FOREACH(136,5312
#define RIMAP_FOREACH(139,5492
#define EIMAP_FOREACH(141,5614
#define DSMAP_FOREACH(143,5735
typedef struct cert_list_t cert_list_t;148,5927
static smartlist_t *trusted_dir_servers trusted_dir_servers182,7816
static smartlist_t *fallback_dir_servers fallback_dir_servers185,7976
struct cert_list_t 190,8126
  struct digest_ds_map_t *dl_status_map;dl_status_map196,8384
  download_status_t dl_status_by_id;198,8496
  smartlist_t *certs;certs199,8533
static digestmap_t *trusted_dir_certs trusted_dir_certs202,8613
static int trusted_dir_servers_certs_changed 206,8812
static routerlist_t *routerlist routerlist209,8924
static smartlist_t *warned_nicknames warned_nicknames213,9074
static time_t last_descriptor_download_attempted 218,9298
get_n_authorities(223,9458
download_status_cert_init(240,10053
download_status_reset_by_sk_in_cl(255,10553
download_status_is_ready_by_sk_in_cl(285,11352
get_cert_list(323,12494
MOCK_IMPL(343,13077
MOCK_IMPL(374,13981
MOCK_IMPL(394,14473
MOCK_IMPL(428,15375
cert_list_free(447,15850
cert_list_free_(461,16187
trusted_dirs_reload_certs(469,16378
already_have_cert(490,16881
trusted_dirs_load_certs_from_string(518,17999
trusted_dirs_flush_certs_to_disk(645,22916
compare_certs_by_pubdates(676,23843
trusted_dirs_remove_old_certs(694,24497
#define DEAD_CERT_LIFETIME 697,24562
#define SUPERSEDED_CERT_LIFETIME 698,24602
#undef DEAD_CERT_LIFETIME737,26065
#undef OLD_CERT_LIFETIME738,26091
authority_cert_get_newest_by_id(747,26364
authority_cert_get_by_sk_digest(767,26937
authority_cert_get_by_digests(794,27783
authority_cert_get_all(810,28246
authority_cert_dl_failed(827,28831
static const char *BAD_SIGNING_KEYS[BAD_SIGNING_KEYS872,30325
authority_cert_is_blacklisted(890,31320
authority_cert_dl_looks_uncertain(909,31893
#define N_AUTH_CERT_DL_FAILURES_TO_BUG_USER 911,31952
authority_certs_fetch_resource_impl(927,32557
authority_certs_fetch_missing(999,35563
router_should_rebuild_store(1314,47373
desc_get_store(1326,47740
signed_desc_append_to_journal(1338,48071
compare_signed_descriptors_by_age_(1363,48886
#define RRS_FORCE 1369,49063
#define RRS_DONT_REMOVE_OLD 1370,49083
router_rebuild_store(1379,49486
router_reload_router_list_impl(1533,54284
router_reload_router_list(1600,56447
router_get_trusted_dir_servers(1615,56861
router_get_fallback_dir_servers(1624,57025
router_pick_directory_server(1649,57889
router_get_trusteddirserver_by_digest(1684,59037
router_get_fallback_dirserver_by_digest(1705,59674
router_digest_is_fallback_dir(1729,60314
MOCK_IMPL(1738,60589
router_pick_trusteddirserver(1758,61069
router_pick_fallback_dirserver(1767,61332
router_pick_dirserver_generic(1776,61605
router_is_already_dir_fetching(1806,62751
router_is_already_dir_fetching_(1837,63680
#define LOG_FALSE_POSITIVES_DURING_BOOTSTRAP 1856,64411
router_picked_poor_directory_log(1861,64544
#undef LOG_FALSE_POSITIVES_DURING_BOOTSTRAP1899,66331
#define DIR_503_TIMEOUT 1902,66456
#define RETRY_ALTERNATE_IP_VERSION(1911,66854
#define RETRY_WITHOUT_EXCLUDE(1929,68080
#define SKIP_MISSING_TRUSTED_EXTRAINFO(1947,69104
router_skip_or_reachability(1960,69796
router_skip_dir_reachability(1972,70255
router_pick_directory_server_impl(1988,70973
dirserver_choose_by_weight(2116,75930
router_pick_trusteddirserver_impl(2144,76789
mark_all_dirservers_up(2261,80841
routers_have_same_or_addrs(2283,81468
router_reset_status_download_failures(2293,81804
routerlist_add_node_and_family(2305,82121
router_add_running_nodes_to_smartlist(2323,82691
routerlist_find_my_routerinfo(2360,84288
router_get_advertised_bandwidth(2376,84615
#define DEFAULT_MAX_BELIEVABLE_BANDWIDTH 2385,84909
router_get_advertised_bandwidth_capped(2390,85110
scale_array_elements_to_u64(2405,85722
choose_array_element_by_weight(2434,86611
#define BRIDGE_MIN_BELIEVABLE_BANDWIDTH 2460,87264
#define BRIDGE_MAX_BELIEVABLE_BANDWIDTH 2461,87327
bridge_get_advertised_bandwidth_bounded(2468,87610
kb_to_bytes(2483,88119
smartlist_choose_node_by_bandwidth_weights(2503,88956
compute_weighted_bandwidths(2531,90017
frac_nodes_with_descriptors(2727,97562
node_sl_choose_by_bandwidth(2764,98498
router_choose_random_node(2791,99880
hex_digest_nickname_decode(2900,103976
hex_digest_nickname_matches(2936,105183
router_digest_is_trusted_dir_type(2964,105968
hexdigest_to_digest(2982,106515
router_get_mutable_by_digest(2995,106872
router_get_by_id_digest(3009,107227
router_get_by_descriptor_digest(3017,107475
MOCK_IMPL(3029,107811
MOCK_IMPL(3042,108190
signed_descriptor_get_body_impl(3064,108934
signed_descriptor_get_body(3113,110591
signed_descriptor_get_annotations(3121,110863
router_get_routerlist(3128,111054
routerinfo_free(3153,111900
extrainfo_free(3183,112760
signed_descriptor_free(3197,113138
signed_descriptor_reset(3212,113528
signed_descriptor_move(3223,113836
signed_descriptor_from_routerinfo(3239,114330
extrainfo_free_(3251,114684
routerlist_free(3258,114796
dump_routerlist_mem_usage(3292,115855
routerlist_find_elt_(3315,116794
routerlist_insert(3337,117433
MOCK_IMPL(3381,119035
#define should_cache_old_descriptors(3461,121748
routerlist_insert_old(3468,122043
routerlist_remove(3503,123386
routerlist_remove_old(3562,125602
routerlist_replace(3615,127520
routerlist_reparse_old(3718,131277
routerlist_free_all(3743,131939
routerlist_reset_warnings(3765,132581
MOCK_IMPL(3777,132968
router_add_to_routerlist(3804,134207
router_add_extrainfo_to_routerlist(3980,141359
compare_old_routers_by_identity_(4001,142069
struct duration_idx_t 4013,142568
  int duration;4014,142592
  int idx;4015,142608
  int old;4016,142619
compare_duration_idx_(4021,142714
routerlist_remove_old_cached_routers_with_id(4037,143423
routerlist_remove_old_routers(4122,146268
routerlist_descriptors_added(4248,150920
router_load_single_router(4275,151799
router_load_routers_from_string(4342,154082
router_load_extrainfo_from_string(4441,157922
signed_desc_digest_is_recognized(4514,161146
update_all_descriptor_downloads(4532,161731
routerlist_retry_directory_downloads(4544,162078
router_exit_policy_rejects_all(4559,162427
dir_server_new(4569,162856
trusted_dir_server_new(4651,165416
fallback_dir_server_new(4696,166933
dir_server_add(4709,167419
authority_cert_free(4725,167793
dir_server_free(4739,168066
clear_dir_servers(4752,168286
list_pending_downloads(4776,169089
list_pending_descriptor_downloads(4819,170549
list_pending_microdesc_downloads(4830,170891
list_pending_fpsk_downloads(4839,171183
MOCK_IMPL(4875,172324
max_dl_per_request(4945,174246
#define MIN_DL_PER_REQUEST 4974,175349
#define MIN_REQUESTS 4977,175520
#define MAX_DL_TO_DELAY 4980,175683
launch_descriptor_downloads(4989,176041
update_consensus_router_descriptor_downloads(5082,179380
#define DUMMY_DOWNLOAD_INTERVAL 5210,184464
launch_dummy_descriptor_download_as_needed(5215,184612
update_router_descriptor_downloads(5241,185883
update_extrainfo_downloads(5255,186282
router_reset_descriptor_download_failures(5365,190322
#define ROUTER_MAX_COSMETIC_TIME_DIFFERENCE 5386,190948
#define ROUTER_ALLOW_UPTIME_DRIFT 5389,191077
router_differences_are_cosmetic(5395,191270
routerinfo_incompatible_with_extrainfo(5488,194778
routerinfo_has_curve25519_onion_key(5584,198135
routerstatus_version_supports_extend2_cells(5608,198715
routerlist_assert_ok(5625,199110
esc_router_info(5713,202794
compare_routerinfo_by_id_digest_(5735,203341
routers_sort_by_identity(5745,203703
refresh_all_country_info(5754,203988

routerparse.c,4455
#define ROUTERPARSE_PRIVATE56,2582
#undef log80,3087
static token_rule_t routerdesc_token_table[routerdesc_token_table86,3252
static token_rule_t extrainfo_token_table[extrainfo_token_table130,5893
static token_rule_t rtrstatus_token_table[rtrstatus_token_table170,8332
#define CERTIFICATE_MEMBERS 185,9187
static token_rule_t dir_key_certificate_table[dir_key_certificate_table198,10116
static token_rule_t desc_token_table[desc_token_table205,10352
static token_rule_t ipo_token_table[ipo_token_table220,11056
static token_rule_t client_keys_token_table[client_keys_token_table231,11540
static token_rule_t networkstatus_token_table[networkstatus_token_table239,11855
static token_rule_t networkstatus_consensus_token_table[networkstatus_consensus_token_table281,14220
static token_rule_t networkstatus_vote_footer_token_table[networkstatus_vote_footer_token_table319,16056
static token_rule_t networkstatus_detached_signature_token_table[networkstatus_detached_signature_token_table327,16440
static token_rule_t microdesc_token_table[microdesc_token_table339,17101
#undef T351,17766
#define CST_NO_CHECK_OBJTYPE 374,18975
#undef DEBUG_AREA_ALLOC382,19327
#define DUMP_AREA(385,19376
#define DUMP_AREA(392,19768
STATIC smartlist_t *descs_dumped descs_dumped398,19953
STATIC uint64_t len_descs_dumped 400,20051
static int have_dump_desc_dir 402,20124
static int problem_with_dump_desc_dir 403,20159
#define DESC_DUMP_DATADIR_SUBDIR 405,20203
#define DESC_DUMP_BASE_FILENAME 406,20256
dump_desc_init(410,20391
dump_desc_create_dir(469,22127
dump_desc_fifo_add_and_clean(502,23120
dump_desc_fifo_bump_hash(573,25420
dump_desc_fifo_cleanup(611,26329
MOCK_IMPL(631,26929
dump_desc_compare_fifo_entries(761,30895
dump_desc_populate_fifo_from_directory(798,32107
MOCK_IMPL(867,34215
router_get_dir_hash(974,38356
router_get_router_hash(985,38719
router_get_networkstatus_v3_signed_boundaries(998,39264
router_get_networkstatus_v3_sha3_as_signed(1013,39987
router_get_networkstatus_v3_hashes(1030,40498
router_get_extrainfo_hash(1041,40942
router_get_dirobj_signature(1054,41512
#define BEGIN_END_OVERHEAD_LEN 1064,41812
router_append_dirobj_signature(1111,43215
tor_version_is_obsolete(1147,44541
MOCK_IMPL(1211,46361
check_signature_token(1225,46861
find_start_of_next_router_or_extrainfo(1275,48599
router_parse_list_from_string(1322,50290
#undef COUNT_DISTINCT_DIGESTS1410,53172
static digestmap_t *verified_digests verified_digests1413,53233
dump_distinct_digest_count(1421,53545
find_single_ipv6_orport(1438,54207
router_parse_entry_from_string(1492,56250
extrainfo_parse_entry_from_string(2053,76235
authority_cert_parse_from_string(2268,83585
#define MAX_CERT_SIZE 2272,83789
find_start_of_next_routerstatus(2455,89797
routerstatus_parse_guardfraction(2482,90505
routerstatus_parse_entry_from_string(2548,92794
compare_vote_routerstatus_entries(2856,103406
networkstatus_verify_bw_weights(2865,103705
extract_shared_random_commits(3259,119583
extract_one_srv(3315,121712
extract_shared_random_srvs(3351,122546
networkstatus_parse_vote_from_string(3387,123913
detached_get_digests(4032,146200
detached_get_signatures(4046,146691
networkstatus_parse_detached_signatures(4060,147139
MOCK_IMPL(4273,154079
router_add_exit_policy(4364,157348
router_parse_addr_policy(4403,158888
router_parse_addr_policy_private(4449,160361
assert_addr_policy_ok(4488,161423
find_all_exitpolicy(4502,161803
router_get_hash_impl_helper(4520,162438
router_get_hash_impl(4567,163952
MOCK_IMPL(4583,164590
router_get_hashes_impl(4605,165143
find_start_of_next_microdesc(4625,165783
#define CHECK_LENGTH(4632,165940
#define NEXT_LINE(4637,166060
#undef CHECK_LENGTH4670,167000
#undef NEXT_LINE4671,167020
microdescs_parse_from_string(4686,167648
tor_version_parse_platform(4858,172937
tor_version_as_new_as(4902,174181
tor_version_parse(4937,175366
#define NUMBER(4955,175741
#define DOT(4967,176280
#undef NUMBER5039,178022
#undef DOT5040,178036
tor_version_compare(5046,178135
#define CMP(5057,178498
#undef CMP5081,179253
tor_version_same_series(5087,179353
compare_tor_version_str_ptr_(5100,179759
sort_version_list(5122,180426
rend_parse_v2_service_descriptor(5144,181356
rend_decrypt_introduction_points(5337,188815
rend_parse_introduction_points(5448,193349
rend_parse_client_keys(5584,198288
routerparse_init(5680,201607
routerparse_free_all(5694,201974

routerset.c,704
#define ROUTERSET_PRIVATE28,1087
routerset_new(41,1334
routerset_get_countryname(55,1769
routerset_refresh_countries(71,2097
routerset_parse(104,3178
routerset_union(163,5652
routerset_is_list(177,6012
routerset_needs_geoip(186,6247
routerset_is_empty(193,6412
routerset_len(201,6605
routerset_contains(217,7068
routerset_add_unknown_ccs(247,8036
routerset_contains_extendinfo(283,8970
routerset_contains_router(296,9408
routerset_contains_routerstatus(312,9948
routerset_contains_node(328,10472
routerset_contains_bridge(340,10824
routerset_get_all_nodes(354,11372
routerset_subtract_nodes(388,12586
routerset_to_string(404,13038
routerset_equal(414,13298
routerset_free(440,13968

scheduler.c,839
#define SCHEDULER_PRIVATE_8,164
#define SCHEDULER_KIST_PRIVATE9,191
#define TOR_CHANNEL_INTERNAL_13,284
STATIC const scheduler_t *the_scheduler;the_scheduler157,6219
STATIC smartlist_t *channels_pending channels_pending166,6519
STATIC struct event *run_sched_ev run_sched_ev172,6711
get_scheduler_type_string(182,7109
scheduler_evt_callback(204,7587
select_scheduler(231,8459
set_scheduler(300,10937
get_channels_pending(346,12526
MOCK_IMPL(352,12650
scheduler_conf_changed(402,14157
scheduler_notify_networkstatus_changed(417,14490
scheduler_free_all(435,15120
MOCK_IMPL(460,15718
MOCK_IMPL(502,17189
scheduler_ev_add(550,18935
scheduler_ev_active(563,19334
scheduler_init(575,19668
MOCK_IMPL(599,20489
scheduler_channel_wants_writes(631,21366
scheduler_bug_occurred(677,23084
scheduler_touch_channel(716,24416

scheduler_kist.c,1506
#define SCHEDULER_KIST_PRIVATE4,93
#define TOR_CHANNEL_INTERNAL_13,260
#define SCHEDULER_PRIVATE_16,335
#define TLS_PER_CELL_OVERHEAD 19,386
socket_table_ent_hash(35,925
socket_table_ent_eq(41,1048
typedef HT_HEAD(socket_table_s, socket_table_ent_s)46,1160
static socket_table_t socket_table 48,1229
HT_PROTOTYPE(50,1285
typedef struct outbuf_table_ent_s 60,1785
  HT_ENTRY(61,1821
} outbuf_table_ent_t;63,1877
outbuf_table_ent_hash(66,1916
outbuf_table_ent_eq(72,2039
HT_PROTOTYPE(77,2189
each_channel_write_to_kernel(127,4466
free_outbuf_info_by_ent(136,4746
free_socket_info_by_ent(147,5100
free_all_socket_info(158,5490
socket_table_search(165,5672
free_socket_info_by_chan(175,5937
MOCK_IMPL(189,6433
init_socket_info(312,11618
outbuf_table_add(329,12128
outbuf_table_remove(344,12544
set_scheduler_run_interval(357,12869
socket_can_write(370,13368
update_socket_info(390,14135
update_socket_written(402,14510
MOCK_IMPL(425,15421
MOCK_IMPL(436,15841
have_work(446,16208
kist_free_all(457,16459
kist_on_channel_free(464,16583
kist_scheduler_on_new_consensus(471,16755
kist_scheduler_on_new_options(482,17026
kist_scheduler_init(492,17298
kist_scheduler_schedule(516,18315
kist_scheduler_run(549,19374
static scheduler_t kist_scheduler 715,26387
get_kist_scheduler(729,26865
kist_scheduler_run_interval(744,27385
scheduler_kist_set_lite_mode(766,28230
scheduler_kist_set_full_mode(776,28494
scheduler_can_use_kist(788,28780
scheduler_can_use_kist(807,29352

scheduler_vanilla.c,266
#define TOR_CHANNEL_INTERNAL_8,156
#define SCHEDULER_PRIVATE_10,207
#define MAX_FLUSH_CELLS 18,518
have_work(26,822
vanilla_scheduler_schedule(38,1091
vanilla_scheduler_run(49,1270
static scheduler_t vanilla_scheduler 181,6261
get_vanilla_scheduler(193,6540

shared_random.c,1670
#define SHARED_RANDOM_PRIVATE88,4164
static const char previous_srv_str[previous_srv_str103,4515
static const char current_srv_str[current_srv_str104,4584
static const char commit_ns_str[commit_ns_str105,4651
static const char sr_flag_ns_str[sr_flag_ns_str106,4709
static int32_t num_srv_agreements_from_vote;112,5026
srv_dup(116,5149
commit_new(134,5682
commit_log(150,6155
verify_commit_and_reveal(166,6857
commit_has_reveal_value(217,8537
commit_decode(229,8909
reveal_decode(282,10700
reveal_encode(335,12535
commit_encode(363,13391
sr_cleanup(385,13994
get_srv_element_from_commit(395,14314
generate_srv(414,14839
compare_reveal_(454,16150
get_vote_line_from_commit(464,16500
srv_to_control_string(504,17757
srv_to_ns_string(519,18256
get_ns_str_from_sr_values(537,18913
commitments_are_the_same(569,19717
commit_is_authoritative(585,20211
should_keep_commit(602,20864
save_commit_during_reveal_phase(718,24988
save_commit_to_state(740,25750
should_keep_srv(763,26298
compare_srvs_(792,27242
smartlist_get_most_frequent_srv(801,27553
compare_srv_(808,27761
get_majority_srv_from_votes(821,28275
sr_srv_encode(880,29853
sr_commit_free(900,30412
sr_generate_our_commit(913,30808
sr_compute_srv(969,32560
sr_parse_srv(1047,35385
sr_parse_commit(1095,36742
sr_handle_received_commits(1165,38785
sr_get_string_for_vote(1202,40051
sr_get_string_for_consensus(1268,42301
sr_act_post_consensus(1304,43434
sr_init(1348,45312
sr_save_and_cleanup(1355,45442
sr_get_current_for_control(1365,45722
sr_get_previous_for_control(1381,46220
sr_get_current(1396,46672
sr_get_previous(1419,47315
set_num_srv_agreements(1445,48011

shared_random_state.c,2787
#define SHARED_RANDOM_STATE_PRIVATE11,258
static const char default_fname[default_fname23,542
static const char *phase_str[phase_str26,640
static sr_state_t *sr_state sr_state31,909
static sr_disk_state_t *sr_disk_state sr_disk_state36,1138
static const char dstate_commit_key[dstate_commit_key39,1213
static const char dstate_prev_srv_key[dstate_prev_srv_key40,1263
static const char dstate_cur_srv_key[dstate_cur_srv_key41,1332
#define VAR(48,1619
#define V(52,1910
#define SR_DISK_STATE_MAGIC 55,2036
#define SHARED_RANDOM_N_ROUNDS 57,2116
#define SHARED_RANDOM_N_PHASES 59,2195
static config_var_t state_vars[state_vars66,2440
static config_var_t state_extra_var 82,3070
static const config_format_t state_format 89,3301
get_phase_str(102,3592
get_voting_interval(121,3950
get_start_time_of_current_round(142,4688
sr_state_get_start_time_of_current_protocol_run(168,5719
sr_state_get_phase_duration(187,6498
sr_state_get_protocol_run_duration(194,6687
get_state_valid_until_time(203,7030
get_sr_protocol_phase(234,8127
commit_add_to_state(256,8934
commit_free_(279,9770
state_free(286,9886
state_new(302,10356
state_set(319,10887
disk_state_free(330,11066
disk_state_new(340,11274
disk_state_set(357,11758
disk_state_validate(369,12066
disk_state_validate_cb(403,12975
disk_state_parse_commits(422,13622
disk_state_parse_srv(476,15264
disk_state_parse_sr_values(511,16140
disk_state_parse(562,17598
disk_state_put_commit_line(596,18723
disk_state_put_srv_line(623,19656
disk_state_reset(640,20180
disk_state_update(658,20713
disk_state_load_from_disk(704,22386
disk_state_load_from_disk_impl(718,22632
disk_state_save_to_disk(781,24270
reset_state_for_new_protocol_run(825,25587
new_protocol_run(845,26150
is_phase_transition(879,27388
state_query_get_commit(887,27618
state_query_get_(896,27880
state_query_put_(928,28576
state_query_del_all_(960,29503
state_query_del_(986,30222
state_query(1018,31211
state_del_current_srv(1051,32116
state_del_previous_srv(1059,32339
state_rotate_srv(1067,32592
sr_state_set_valid_after(1079,32941
sr_state_get_phase(1087,33174
sr_state_get_previous_srv(1096,33403
sr_state_set_previous_srv(1107,33705
sr_state_get_current_srv(1115,33936
sr_state_set_current_srv(1126,34236
sr_state_clean_srvs(1134,34422
sr_state_get_commits(1143,34665
sr_state_update(1155,34964
sr_state_get_commit(1217,37205
sr_state_add_commit(1231,37581
sr_state_delete_commits(1245,37950
sr_state_copy_reveal_info(1254,38252
sr_state_set_fresh_srv(1274,39050
sr_state_unset_fresh_srv(1282,39260
sr_state_srv_is_fresh(1289,39385
sr_state_free(1296,39506
sr_state_save(1307,39719
sr_state_is_initialized(1316,39977
sr_state_init(1330,40403
set_sr_phase(1386,42056
get_sr_state(1394,42204

statefile.c,1132
#define STATEFILE_PRIVATE31,1330
static config_abbrev_t state_abbrevs_[state_abbrevs_46,1683
#define VAR(62,2368
#define V(66,2647
static config_var_t state_vars_[state_vars_70,2832
#undef VAR127,5459
#undef V128,5470
#define OR_STATE_MAGIC 137,5762
static config_var_t state_extra_var 141,5939
static const config_format_t state_format 147,6155
static or_state_t *global_state global_state159,6398
MOCK_IMPL(162,6495
or_state_loaded(171,6669
state_transport_line_is_valid(179,6838
validate_transports_in_state(222,7796
or_state_validate_cb(240,8193
or_state_validate(258,8764
or_state_set(271,9033
or_state_save_broken(299,9699
or_state_new(335,10837
or_state_load(348,11157
static int last_state_file_write_failed 448,14085
did_last_state_file_write_fail(452,14208
#define STATE_WRITE_RETRY_INTERVAL 458,14367
#define STATE_RELAY_CHECKPOINT_INTERVAL 463,14603
or_state_save(467,14739
get_transport_in_state_by_name(528,16704
get_transport_bindaddr(566,17742
get_stored_bindaddr_for_server_transport(592,18453
save_transport_to_state(625,19587
or_state_free(684,21794
or_state_free_all(693,21901

status.c,231
#define STATUS_PRIVATE15,539
count_circuits(36,986
secs_to_uptime(44,1170
bytes_to_usage(71,1863
log_heartbeat(92,2538
#define FULLNESS_PCT_THRESHOLD 134,4020
#define TLS_OVERHEAD_THRESHOLD 135,4054
log_accounting(168,4846

torcert.c,660
tor_cert_sign_impl(42,1475
tor_cert_create(127,4076
tor_cert_free(140,4533
tor_cert_parse(155,4843
tor_cert_get_checkable_sig(207,6455
tor_cert_checksig(240,7486
tor_cert_dup(272,8344
tor_cert_eq(282,8618
tor_cert_opt_eq(293,8938
#define RSA_ED_CROSSCERT_PREFIX 302,9135
tor_make_rsa_ed25519_crosscert(309,9499
MOCK_IMPL(368,11667
#define ERR(378,12043
or_handshake_certs_new(449,14657
or_handshake_certs_free(456,14800
#undef ERR474,15213
#define ERR(475,15224
or_handshake_certs_rsa_ok(484,15639
or_handshake_certs_ed25519_ok(519,17070
#define ADDCERT(528,17357
or_handshake_certs_check_both(626,20924
tor_cert_encode_ed22519(669,22428

tor_main.c,66
const char tor_git_revision[tor_git_revision12,429
main(32,879

transports.c,2368
#define PT_PRIVATE92,4226
#define parse_server_method_error(112,4783
#define parse_client_method_error(113,4845
#define PROTO_ENV_ERROR 116,4946
#define PROTO_NEG_SUCCESS 117,4982
#define PROTO_NEG_FAIL 118,5018
#define PROTO_CMETHOD 119,5068
#define PROTO_SMETHOD 120,5100
#define PROTO_CMETHOD_ERROR 121,5132
#define PROTO_SMETHOD_ERROR 122,5176
#define PROTO_CMETHODS_DONE 123,5220
#define PROTO_SMETHODS_DONE 124,5264
#define PROTO_PROXY_DONE 125,5308
#define PROTO_PROXY_ERROR 126,5346
#define PROTO_VERSION_ONE 130,5477
static smartlist_t *transport_list transport_list133,5560
transport_new(139,5802
transport_free(157,6277
mark_transport_list(170,6589
sweep_transport_list(181,6923
clear_transport_list(196,7317
transport_copy(206,7587
transport_get_by_name(226,8181
transport_resolve_conflicts(247,8759
transport_add(306,11425
MOCK_IMPL(327,11978
static smartlist_t *managed_proxy_list managed_proxy_list355,12825
static int unconfigured_proxies_n 357,12917
static int check_if_restarts_needed 359,13020
pt_proxies_configuration_pending(364,13170
assert_unconfigured_count_ok(372,13423
managed_proxy_has_argv(391,13904
get_managed_proxy_by_argv_and_type(413,14349
add_transport_to_proxy(429,14758
proxy_needs_restart(440,15163
proxy_prepare_for_restart(483,16435
launch_managed_proxy(518,17501
pt_configure_remaining_proxies(556,18658
configure_proxy(613,20500
register_server_proxy(672,22390
register_client_proxy(687,22971
register_proxy(716,23911
managed_proxy_destroy(726,24117
get_pt_proxy_uri(758,25061
handle_finished_proxy(795,26435
proxy_configuration_finished(831,27657
handle_methods_done(840,27961
handle_proxy_line(857,28518
parse_env_error(974,31949
parse_version(990,32541
parse_method_error(1012,33293
parse_smethod_line(1031,33951
parse_cmethod_line(1123,36474
parse_proxy_error(1213,38732
get_transport_options_for_server_proxy(1230,39431
get_bindaddr_for_server_proxy(1275,41091
create_managed_proxy_environment(1302,41846
managed_proxy_create(1427,45993
MOCK_IMPL(1461,47096
free_execve_args(1508,48814
pt_prepare_proxy_list_for_config_read(1523,49246
get_transport_proxy_ports(1556,50253
pt_get_extra_info_descriptor_string(1586,51149
pt_stringify_socks_args(1653,53428
pt_get_socks_args_for_proxy_addrport(1689,54503
sweep_proxy_list(1705,54959
pt_free_all(1721,55401
